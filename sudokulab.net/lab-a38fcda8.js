import{a as e,r as t,p as i,e as o,d as s,c as n,S as r,A as a,B as l,b as c,C as u,D as d,f as p,I as h,g as f,m,K as g,h as v,i as b,L as y,j as k,k as w,O as x,P as C,Q as S,R as _,l as E,T as z,X as $,n as T,M as O,o as I,q as A,s as M,t as L,W as P,u as N,G as R,v as j,w as D,x as U,y as F,z as H,E as B,F as W,H as V,J as G,N as q,U as K,V as Y,Y as Z,Z as J,_ as X,$ as Q,a0 as ee,a1 as te,a2 as ie,a3 as oe,a4 as se,a5 as ne,a6 as re,a7 as ae,a8 as le,a9 as ce,aa as ue,ab as de,ac as pe,ad as he,ae as fe,af as me,ag as ge,ah as ve,ai as be,aj as ye,ak as ke,al as we,am as xe,an as Ce,ao as Se,ap as _e,aq as Ee,ar as ze,as as $e,at as Te,au as Oe,av as Ie,aw as Ae,ax as Me,ay as Le,az as Pe,aA as Ne,aB as Re,aC as je,aD as De,aE as Ue,aF as Fe,aG as He,aH as Be,aI as We,aJ as Ve,aK as Ge,aL as qe,aM as Ke}from"./chunks/worker-b57f6349.chunk.js";
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Ye;const Ze=window,Je=Ze.trustedTypes,Xe=Je?Je.createPolicy("lit-html",{createHTML:e=>e}):void 0,Qe=`lit$${(Math.random()+"").slice(9)}$`,et="?"+Qe,tt=`<${et}>`,it=document,ot=(e="")=>it.createComment(e),st=e=>null===e||"object"!=typeof e&&"function"!=typeof e,nt=Array.isArray,rt=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,at=/-->/g,lt=/>/g,ct=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),ut=/'/g,dt=/"/g,pt=/^(?:script|style|textarea|title)$/i,ht=e=>(t,...i)=>({_$litType$:e,strings:t,values:i}),ft=ht(1),mt=ht(2),gt=Symbol.for("lit-noChange"),vt=Symbol.for("lit-nothing"),bt=new WeakMap,yt=(e,t,i)=>{var o,s;const n=null!==(o=null==i?void 0:i.renderBefore)&&void 0!==o?o:t;let r=n._$litPart$;if(void 0===r){const e=null!==(s=null==i?void 0:i.renderBefore)&&void 0!==s?s:null;n._$litPart$=r=new St(t.insertBefore(ot(),e),e,void 0,null!=i?i:{})}return r._$AI(e),r},kt=it.createTreeWalker(it,129,null,!1);class wt{constructor({strings:e,_$litType$:t},i){let o;this.parts=[];let s=0,n=0;const r=e.length-1,a=this.parts,[l,c]=((e,t)=>{const i=e.length-1,o=[];let s,n=2===t?"<svg>":"",r=rt;for(let t=0;t<i;t++){const i=e[t];let a,l,c=-1,u=0;for(;u<i.length&&(r.lastIndex=u,l=r.exec(i),null!==l);)u=r.lastIndex,r===rt?"!--"===l[1]?r=at:void 0!==l[1]?r=lt:void 0!==l[2]?(pt.test(l[2])&&(s=RegExp("</"+l[2],"g")),r=ct):void 0!==l[3]&&(r=ct):r===ct?">"===l[0]?(r=null!=s?s:rt,c=-1):void 0===l[1]?c=-2:(c=r.lastIndex-l[2].length,a=l[1],r=void 0===l[3]?ct:'"'===l[3]?dt:ut):r===dt||r===ut?r=ct:r===at||r===lt?r=rt:(r=ct,s=void 0);const d=r===ct&&e[t+1].startsWith("/>")?" ":"";n+=r===rt?i+tt:c>=0?(o.push(a),i.slice(0,c)+"$lit$"+i.slice(c)+Qe+d):i+Qe+(-2===c?(o.push(void 0),t):d)}const a=n+(e[i]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==Xe?Xe.createHTML(a):a,o]})(e,t);if(this.el=wt.createElement(l,i),kt.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(o=kt.nextNode())&&a.length<r;){if(1===o.nodeType){if(o.hasAttributes()){const e=[];for(const t of o.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(Qe)){const i=c[n++];if(e.push(t),void 0!==i){const e=o.getAttribute(i.toLowerCase()+"$lit$").split(Qe),t=/([.?@])?(.*)/.exec(i);a.push({type:1,index:s,name:t[2],strings:e,ctor:"."===t[1]?Et:"?"===t[1]?$t:"@"===t[1]?Tt:_t})}else a.push({type:6,index:s})}for(const t of e)o.removeAttribute(t)}if(pt.test(o.tagName)){const e=o.textContent.split(Qe),t=e.length-1;if(t>0){o.textContent=Je?Je.emptyScript:"";for(let i=0;i<t;i++)o.append(e[i],ot()),kt.nextNode(),a.push({type:2,index:++s});o.append(e[t],ot())}}}else if(8===o.nodeType)if(o.data===et)a.push({type:2,index:s});else{let e=-1;for(;-1!==(e=o.data.indexOf(Qe,e+1));)a.push({type:7,index:s}),e+=Qe.length-1}s++}}static createElement(e,t){const i=it.createElement("template");return i.innerHTML=e,i}}function xt(e,t,i=e,o){var s,n,r,a;if(t===gt)return t;let l=void 0!==o?null===(s=i._$Cl)||void 0===s?void 0:s[o]:i._$Cu;const c=st(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(n=null==l?void 0:l._$AO)||void 0===n||n.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,i,o)),void 0!==o?(null!==(r=(a=i)._$Cl)&&void 0!==r?r:a._$Cl=[])[o]=l:i._$Cu=l),void 0!==l&&(t=xt(e,l._$AS(e,t.values),l,o)),t}class Ct{constructor(e,t){this.v=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(e){var t;const{el:{content:i},parts:o}=this._$AD,s=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:it).importNode(i,!0);kt.currentNode=s;let n=kt.nextNode(),r=0,a=0,l=o[0];for(;void 0!==l;){if(r===l.index){let t;2===l.type?t=new St(n,n.nextSibling,this,e):1===l.type?t=new l.ctor(n,l.name,l.strings,this,e):6===l.type&&(t=new Ot(n,this,e)),this.v.push(t),l=o[++a]}r!==(null==l?void 0:l.index)&&(n=kt.nextNode(),r++)}return s}m(e){let t=0;for(const i of this.v)void 0!==i&&(void 0!==i.strings?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class St{constructor(e,t,i,o){var s;this.type=2,this._$AH=vt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=o,this._$C_=null===(s=null==o?void 0:o.isConnected)||void 0===s||s}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$C_}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=xt(this,e,t),st(e)?e===vt||null==e||""===e?(this._$AH!==vt&&this._$AR(),this._$AH=vt):e!==this._$AH&&e!==gt&&this.$(e):void 0!==e._$litType$?this.T(e):void 0!==e.nodeType?this.k(e):(e=>nt(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.O(e):this.$(e)}S(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}k(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}$(e){this._$AH!==vt&&st(this._$AH)?this._$AA.nextSibling.data=e:this.k(it.createTextNode(e)),this._$AH=e}T(e){var t;const{values:i,_$litType$:o}=e,s="number"==typeof o?this._$AC(e):(void 0===o.el&&(o.el=wt.createElement(o.h,this.options)),o);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===s)this._$AH.m(i);else{const e=new Ct(s,this),t=e.p(this.options);e.m(i),this.k(t),this._$AH=e}}_$AC(e){let t=bt.get(e.strings);return void 0===t&&bt.set(e.strings,t=new wt(e)),t}O(e){nt(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,o=0;for(const s of e)o===t.length?t.push(i=new St(this.S(ot()),this.S(ot()),this,this.options)):i=t[o],i._$AI(s),o++;o<t.length&&(this._$AR(i&&i._$AB.nextSibling,o),t.length=o)}_$AR(e=this._$AA.nextSibling,t){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$C_=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class _t{constructor(e,t,i,o,s){this.type=1,this._$AH=vt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=o,this.options=s,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=vt}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,i,o){const s=this.strings;let n=!1;if(void 0===s)e=xt(this,e,t,0),n=!st(e)||e!==this._$AH&&e!==gt,n&&(this._$AH=e);else{const o=e;let r,a;for(e=s[0],r=0;r<s.length-1;r++)a=xt(this,o[i+r],t,r),a===gt&&(a=this._$AH[r]),n||(n=!st(a)||a!==this._$AH[r]),a===vt?e=vt:e!==vt&&(e+=(null!=a?a:"")+s[r+1]),this._$AH[r]=a}n&&!o&&this.P(e)}P(e){e===vt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class Et extends _t{constructor(){super(...arguments),this.type=3}P(e){this.element[this.name]=e===vt?void 0:e}}const zt=Je?Je.emptyScript:"";class $t extends _t{constructor(){super(...arguments),this.type=4}P(e){e&&e!==vt?this.element.setAttribute(this.name,zt):this.element.removeAttribute(this.name)}}class Tt extends _t{constructor(e,t,i,o,s){super(e,t,i,o,s),this.type=5}_$AI(e,t=this){var i;if((e=null!==(i=xt(this,e,t,0))&&void 0!==i?i:vt)===gt)return;const o=this._$AH,s=e===vt&&o!==vt||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,n=e!==vt&&(o===vt||s);s&&this.element.removeEventListener(this.name,this,o),n&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,i;"function"==typeof this._$AH?this._$AH.call(null!==(i=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==i?i:this.element,e):this._$AH.handleEvent(e)}}class Ot{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){xt(this,e)}}const It=Ze.litHtmlPolyfillSupport;null==It||It(wt,St),(null!==(Ye=Ze.litHtmlVersions)&&void 0!==Ye?Ye:Ze.litHtmlVersions=[]).push("2.3.0");
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const At=window,Mt=At.ShadowRoot&&(void 0===At.ShadyCSS||At.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Lt=Symbol(),Pt=new WeakMap;class Nt{constructor(e,t,i){if(this._$cssResult$=!0,i!==Lt)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Mt&&void 0===e){const i=void 0!==t&&1===t.length;i&&(e=Pt.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&Pt.set(t,e))}return e}toString(){return this.cssText}}const Rt=(e,...t)=>{const i=1===e.length?e[0]:t.reduce(((t,i,o)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+e[o+1]),e[0]);return new Nt(i,e,Lt)},jt=Mt?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return(e=>new Nt("string"==typeof e?e:e+"",void 0,Lt))(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var Dt;const Ut=window,Ft=Ut.trustedTypes,Ht=Ft?Ft.emptyScript:"",Bt=Ut.reactiveElementPolyfillSupport,Wt={toAttribute(e,t){switch(t){case Boolean:e=e?Ht:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let i=e;switch(t){case Boolean:i=null!==e;break;case Number:i=null===e?null:Number(e);break;case Object:case Array:try{i=JSON.parse(e)}catch(e){i=null}}return i}},Vt=(e,t)=>t!==e&&(t==t||e==e),Gt={attribute:!0,type:String,converter:Wt,reflect:!1,hasChanged:Vt};class qt extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;null!==(t=this.h)&&void 0!==t||(this.h=[]),this.h.push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,i)=>{const o=this._$Ep(i,t);void 0!==o&&(this._$Ev.set(o,i),e.push(o))})),e}static createProperty(e,t=Gt){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const i="symbol"==typeof e?Symbol():"__"+e,o=this.getPropertyDescriptor(e,i,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}}static getPropertyDescriptor(e,t,i){return{get(){return this[t]},set(o){const s=this[e];this[t]=o,this.requestUpdate(e,s,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||Gt}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const i of t)this.createProperty(i,e[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const e of i)t.unshift(jt(e))}else void 0!==e&&t.push(jt(e));return t}static _$Ep(e,t){const i=t.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,i;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(i=e.hostConnected)||void 0===i||i.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{Mt?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const i=document.createElement("style"),o=At.litNonce;void 0!==o&&i.setAttribute("nonce",o),i.textContent=t.cssText,e.appendChild(i)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EO(e,t,i=Gt){var o;const s=this.constructor._$Ep(e,i);if(void 0!==s&&!0===i.reflect){const n=(void 0!==(null===(o=i.converter)||void 0===o?void 0:o.toAttribute)?i.converter:Wt).toAttribute(t,i.type);this._$El=e,null==n?this.removeAttribute(s):this.setAttribute(s,n),this._$El=null}}_$AK(e,t){var i;const o=this.constructor,s=o._$Ev.get(e);if(void 0!==s&&this._$El!==s){const e=o.getPropertyOptions(s),n="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(i=e.converter)||void 0===i?void 0:i.fromAttribute)?e.converter:Wt;this._$El=s,this[s]=n.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,i){let o=!0;void 0!==e&&(((i=i||this.constructor.getPropertyOptions(e)).hasChanged||Vt)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===i.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,i))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(i)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(i)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var Kt,Yt;qt.finalized=!0,qt.elementProperties=new Map,qt.elementStyles=[],qt.shadowRootOptions={mode:"open"},null==Bt||Bt({ReactiveElement:qt}),(null!==(Dt=Ut.reactiveElementVersions)&&void 0!==Dt?Dt:Ut.reactiveElementVersions=[]).push("1.4.0");class Zt extends qt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const i=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=i.firstChild),i}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=yt(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return gt}}Zt.finalized=!0,Zt._$litElement$=!0,null===(Kt=globalThis.litElementHydrateSupport)||void 0===Kt||Kt.call(globalThis,{LitElement:Zt});const Jt=globalThis.litElementPolyfillSupport;null==Jt||Jt({LitElement:Zt}),(null!==(Yt=globalThis.litElementVersions)&&void 0!==Yt?Yt:globalThis.litElementVersions=[]).push("3.2.2");
/**
@license
Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
const Xt=e=>t=>class extends t{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._storeUnsubscribe=e.subscribe((()=>this.stateChanged(e.getState()))),this.stateChanged(e.getState())}disconnectedCallback(){this._storeUnsubscribe(),super.disconnectedCallback&&super.disconnectedCallback()}stateChanged(e){}},Qt=["values","corners","centers","colors"],ei=(t=(()=>({size:9,givens:e(81,(e=>0)),constraints:{row:{},column:{},box:{}}}))())=>({type:"SET_PUZZLE",puzzle:t}),ti=e=>({type:"UPDATE_PUZZLE",puzzle:e}),ii=(e,t)=>({type:"SET_CELL_VALUES",positions:e,value:t}),oi=e=>({type:"CLEAR_CELL_VALUES",positions:e}),si=(e,t)=>({type:"SET_CELL_GIVENS",positions:e,value:t}),ni=e=>({type:"CLEAR_CELL_GIVENS",positions:e}),ri=(e,t,i)=>({type:"START_CELL_SELECTION",position:e,accumulate:t,peers:i}),ai=(e,t,i)=>({type:"SELECT_CELL",position:e,accumulate:t,peers:i}),li=(e,t)=>({type:"TENTATIVELY_SELECT_CELLS",positions:e,accumulate:t}),ci=(e,t,i)=>({type:"SELECT_SIMILAR_CELLS",position:e,criterion:t,accumulate:i}),ui=(e,t,i,o)=>({type:"TOGGLE_CORNER_MARKS",positions:e,mark:t,autoCandidates:i,puzzle:o}),di=(e,t,i)=>({type:"CLEAR_CORNER_MARKS",positions:e,autoCandidates:t,puzzle:i}),pi=(e,t)=>({type:"TOGGLE_CENTER_MARKS",positions:e,mark:t}),hi=e=>({type:"CLEAR_CENTER_MARKS",positions:e}),fi=e=>({type:"SET_MODE",mode:e}),mi=e=>({type:"SET_KEY_MODE",keyMode:e}),gi=(e,t)=>({type:"SET_CELL_COLORS",positions:e,newColor:t}),vi=e=>({type:"CLEAR_CELL_COLORS",positions:e}),bi=(e,t)=>({type:"REPORT_STEPS",steps:t}),yi=(e,t,i)=>({type:"UPDATE_FEATURE_POSITIONS",position:e,point:t,modifiers:i}),ki=(e,t)=>({type:"UPDATE_FEATURE_ITEM",item:e,defaultStyle:t}),wi=(e,t)=>({type:"SELECT_FEATURE_ITEM",featureName:e,index:t}),xi=(e,t)=>({type:"HIGHLIGHT_FEATURE_ITEM",featureName:e,index:t}),Ci=(e,{stats:t})=>({type:"REPORT_SOLUTION_COUNT",stats:t}),Si=e=>({type:"UPDATE_SOLUTION_INDEX",index:e}),_i=e=>({type:"ADD_RECENT_COLOR",color:e}),Ei=(e,t)=>({type:"SWAP_FEATURE_ORDER",featureName1:e,featureName2:t}),zi=e=>({type:"UPDATE_SETTINGS",settings:e}),$i=e=>({type:"SET_SHOWING_SOLUTION_TYPE",showingSolutionType:e}),Ti=e=>({type:"ADD_CELL_SET_VALUE",positions:e}),Oi=e=>({type:"DELETE_CELL_SET_VALUE",positions:e});function Ii(e,t){return e===t}function Ai(e,t,i){if(null===t||null===i||t.length!==i.length)return!1;for(var o=t.length,s=0;s<o;s++)if(!e(t[s],i[s]))return!1;return!0}function Mi(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var i=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+i+"]")}return t}var Li=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return function(){for(var t=arguments.length,o=Array(t),s=0;s<t;s++)o[s]=arguments[s];var n=0,r=o.pop(),a=Mi(o),l=e.apply(void 0,[function(){return n++,r.apply(null,arguments)}].concat(i)),c=e((function(){for(var e=[],t=a.length,i=0;i<t;i++)e.push(a[i].apply(null,arguments));return l.apply(null,e)}));return c.resultFunc=r,c.dependencies=a,c.recomputations=function(){return n},c.resetRecomputations=function(){return n=0},c}}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ii,i=null,o=null;return function(){return Ai(t,i,arguments)||(o=e.apply(null,arguments)),i=arguments,o}}));const Pi=(e=>{const t=Li([e],(e=>e.values)),i=Li([e],(e=>e.cornerMarks)),o=Li([e],(e=>e.centerMarks)),s=Li([e],(e=>e.userCandidates)),n=Li([e],(e=>e.cellColors)),r=Li([e],(e=>e.latestEditPosition)),a=Li([e],(e=>e.iteration)),l=Li([e],(e=>e.heatmapShowing)),c=Li([e],(e=>e.logicalSolveRequestIteration)),u=Li([t],(e=>e.filter((e=>0!==e)).length));return{grid:e,values:t,cornerMarks:i,centerMarks:o,userCandidates:s,cellColors:n,latestEditPosition:r,gridIteration:a,heatmapShowing:l,logicalSolveRequestIteration:c,filledCellCount:u}})((e=>e.game.present.grid)),Ni=e=>null!=e?e:vt,Ri=e=>100*e,ji=e=>e/Ri(1),Di=(e,t,{index:i,style:o,stroke:s,strokeWidth:n,strokeLinecap:r,strokeLinejoin:a,fill:l,opacity:c}={})=>mt`<g class="${e}" index="${Ni(i)}" style="${Ni(o)}" stroke="${Ni(s)}" stroke-width="${Ni(n)}" stroke-linecap="${Ni(r)}" stroke-linejoin="${Ni(a)}" fill="${Ni(l)}" opacity="${Ni(c)}"> ${t}</g>`,Ui=([e,t],i,{transform:o,textAnchor:s,textLength:n,lengthAdjust:r,dominantBaseline:a,filter:l,fontSize:c,stroke:u,fill:d,dy:p,cls:h,letterSpacing:f}={})=>mt`<text x="${e}" y="${t}" letter-spacing="${Ni(f)}" transform="${Ni(o)}" text-anchor="${Ni(s)}" textLength="${Ni(n)}" lengthAdjust="${Ni(r)}" dominant-baseline="${Ni(a)}" filter="${Ni(l)}" font-size="${Ni(c)}" stroke="${Ni(u)}" fill="${Ni(d)}" dy="${Ni(p)}" class="${Ni(h)}" text-rendering="optimizeLegibility">${i}</text>`,Fi=(e,{filter:t,mask:i,stroke:o,fill:s,strokeWidth:n,strokeLinecap:r,strokeLinejoin:a,markerStart:l,markerMid:c,markerEnd:u,fillOpacity:d,strokeDasharray:p,transform:h,transformOrigin:f}={})=>mt`<path d="${e}" fill="${Ni(s)}" fill-opacity="${Ni(d)}" stroke="${Ni(o)}" stroke-width="${Ni(n)}" stroke-linecap="${Ni(r)}" stroke-linejoin="${Ni(a)}" stroke-dasharray="${Ni(p)}" marker-start="${Ni(l)}" marker-mid="${Ni(c)}" marker-end="${Ni(u)}" filter="${Ni(t)}" mask="${Ni(i)}" transform="${Ni(h)}" transform-origin="${Ni(f)}"></path>`,Hi=([e,t],i,o,{rotation:s,fill:n,cls:r,stroke:a,strokeWidth:l}={})=>{i<0&&(e+=i,i*=-1),o<0&&(t+=o,o*=-1);const c=s?`rotate(${s} ${e+i/2} ${t+o/2})`:void 0;return mt`<rect x="${e}" y="${t}" width="${i}" height="${o}" class="${Ni(r)}" fill="${Ni(n)}" transform="${Ni(c)}" stroke="${Ni(a)}" stroke-width="${Ni(l)}"></rect>`},Bi=([e,t],i,{stroke:o,strokeWidth:s,strokeDasharray:n,fill:r}={})=>mt`<circle cx="${e}" cy="${t}" r="${i}" stroke="${Ni(o)}" stroke-width="${Ni(s)}" stroke-dasharray="${Ni(n)}" fill="${Ni(r)}"></circle>`,Wi=(e,t)=>mt`<mask id="${e}">${t}</mask>`,Vi=e=>mt`<style>${e}</style>`,Gi=(e,t)=>{const i=document.createElement("div");yt(e,i);const o=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="${t}">${i.innerHTML.replace(/<![^>]+>/g,"")}</svg>`;return`data:image/svg+xml;utf8,${encodeURIComponent(o)}`};
/*!
 * iro.js v5.3.2
 * 2016-2020 James Daniel
 * Licensed under MPL 2.0
 * github.com/jaames/iro.js
 */var qi,Ki,Yi,Zi,Ji,Xi={},Qi=[],eo=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function to(e,t){for(var i in t)e[i]=t[i];return e}function io(e){var t=e.parentNode;t&&t.removeChild(e)}function oo(e,t,i){var o,s,n,r,a=arguments;if(t=to({},t),arguments.length>3)for(i=[i],o=3;o<arguments.length;o++)i.push(a[o]);if(null!=i&&(t.children=i),null!=e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===t[s]&&(t[s]=e.defaultProps[s]);return r=t.key,null!=(n=t.ref)&&delete t.ref,null!=r&&delete t.key,so(e,t,r,n)}function so(e,t,i,o){var s={type:e,props:t,key:i,ref:o,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return qi.vnode&&qi.vnode(s),s}function no(e){return e.children}function ro(e,t){this.props=e,this.context=t}function ao(e,t){if(null==t)return e.__p?ao(e.__p,e.__p.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?ao(e):null}function lo(e){var t,i;if(null!=(e=e.__p)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return lo(e)}}function co(e){(!e.__d&&(e.__d=!0)&&1===Ki.push(e)||Zi!==qi.debounceRendering)&&(Zi=qi.debounceRendering,(qi.debounceRendering||Yi)(uo))}function uo(){var e,t,i,o,s,n,r,a;for(Ki.sort((function(e,t){return t.__v.__b-e.__v.__b}));e=Ki.pop();)e.__d&&(i=void 0,o=void 0,n=(s=(t=e).__v).__e,r=t.__P,a=t.u,t.u=!1,r&&(i=[],o=vo(r,s,to({},s),t.__n,void 0!==r.ownerSVGElement,null,i,a,null==n?ao(s):n),bo(i,s),o!=n&&lo(s)))}function po(e,t,i,o,s,n,r,a,l){var c,u,d,p,h,f,m,g=i&&i.__k||Qi,v=g.length;if(a==Xi&&(a=null!=n?n[0]:v?ao(i,0):null),c=0,t.__k=ho(t.__k,(function(i){if(null!=i){if(i.__p=t,i.__b=t.__b+1,null===(d=g[c])||d&&i.key==d.key&&i.type===d.type)g[c]=void 0;else for(u=0;u<v;u++){if((d=g[u])&&i.key==d.key&&i.type===d.type){g[u]=void 0;break}d=null}if(p=vo(e,i,d=d||Xi,o,s,n,r,null,a,l),(u=i.ref)&&d.ref!=u&&(m||(m=[])).push(u,i.__c||p,i),null!=p){if(null==f&&(f=p),null!=i.l)p=i.l,i.l=null;else if(n==d||p!=a||null==p.parentNode){e:if(null==a||a.parentNode!==e)e.appendChild(p);else{for(h=a,u=0;(h=h.nextSibling)&&u<v;u+=2)if(h==p)break e;e.insertBefore(p,a)}"option"==t.type&&(e.value="")}a=p.nextSibling,"function"==typeof t.type&&(t.l=p)}}return c++,i})),t.__e=f,null!=n&&"function"!=typeof t.type)for(c=n.length;c--;)null!=n[c]&&io(n[c]);for(c=v;c--;)null!=g[c]&&ko(g[c],g[c]);if(m)for(c=0;c<m.length;c++)yo(m[c],m[++c],m[++c])}function ho(e,t,i){if(null==i&&(i=[]),null==e||"boolean"==typeof e)t&&i.push(t(null));else if(Array.isArray(e))for(var o=0;o<e.length;o++)ho(e[o],t,i);else i.push(t?t(function(e){if(null==e||"boolean"==typeof e)return null;if("string"==typeof e||"number"==typeof e)return so(null,e,null,null);if(null!=e.__e||null!=e.__c){var t=so(e.type,e.props,e.key,null);return t.__e=e.__e,t}return e}(e)):e);return i}function fo(e,t,i){"-"===t[0]?e.setProperty(t,i):e[t]="number"==typeof i&&!1===eo.test(t)?i+"px":null==i?"":i}function mo(e,t,i,o,s){var n,r,a,l,c;if("key"===(t=s?"className"===t?"class":t:"class"===t?"className":t)||"children"===t);else if("style"===t)if(n=e.style,"string"==typeof i)n.cssText=i;else{if("string"==typeof o&&(n.cssText="",o=null),o)for(r in o)i&&r in i||fo(n,r,"");if(i)for(a in i)o&&i[a]===o[a]||fo(n,a,i[a])}else"o"===t[0]&&"n"===t[1]?(l=t!==(t=t.replace(/Capture$/,"")),c=t.toLowerCase(),t=(c in e?c:t).slice(2),i?(o||e.addEventListener(t,go,l),(e.t||(e.t={}))[t]=i):e.removeEventListener(t,go,l)):"list"!==t&&"tagName"!==t&&"form"!==t&&!s&&t in e?e[t]=null==i?"":i:"function"!=typeof i&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/^xlink:?/,""))?null==i||!1===i?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),i):null==i||!1===i?e.removeAttribute(t):e.setAttribute(t,i))}function go(e){return this.t[e.type](qi.event?qi.event(e):e)}function vo(e,t,i,o,s,n,r,a,l,c){var u,d,p,h,f,m,g,v,b,y,k=t.type;if(void 0!==t.constructor)return null;(u=qi.__b)&&u(t);try{e:if("function"==typeof k){if(v=t.props,b=(u=k.contextType)&&o[u.__c],y=u?b?b.props.value:u.__p:o,i.__c?g=(d=t.__c=i.__c).__p=d.__E:("prototype"in k&&k.prototype.render?t.__c=d=new k(v,y):(t.__c=d=new ro(v,y),d.constructor=k,d.render=wo),b&&b.sub(d),d.props=v,d.state||(d.state={}),d.context=y,d.__n=o,p=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=k.getDerivedStateFromProps&&to(d.__s==d.state?d.__s=to({},d.__s):d.__s,k.getDerivedStateFromProps(v,d.__s)),p)null==k.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&r.push(d);else{if(null==k.getDerivedStateFromProps&&null==a&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(v,y),!a&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(v,d.__s,y)){for(d.props=v,d.state=d.__s,d.__d=!1,d.__v=t,t.__e=null!=l?l!==i.__e?l:i.__e:null,t.__k=i.__k,u=0;u<t.__k.length;u++)t.__k[u]&&(t.__k[u].__p=t);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(v,d.__s,y)}for(h=d.props,f=d.state,d.context=y,d.props=v,d.state=d.__s,(u=qi.__r)&&u(t),d.__d=!1,d.__v=t,d.__P=e,u=d.render(d.props,d.state,d.context),t.__k=ho(null!=u&&u.type==no&&null==u.key?u.props.children:u),null!=d.getChildContext&&(o=to(to({},o),d.getChildContext())),p||null==d.getSnapshotBeforeUpdate||(m=d.getSnapshotBeforeUpdate(h,f)),po(e,t,i,o,s,n,r,l,c),d.base=t.__e;u=d.__h.pop();)d.__s&&(d.state=d.__s),u.call(d);p||null==h||null==d.componentDidUpdate||d.componentDidUpdate(h,f,m),g&&(d.__E=d.__p=null)}else t.__e=function(e,t,i,o,s,n,r,a){var l,c,u,d,p=i.props,h=t.props;if(s="svg"===t.type||s,null==e&&null!=n)for(l=0;l<n.length;l++)if(null!=(c=n[l])&&(null===t.type?3===c.nodeType:c.localName===t.type)){e=c,n[l]=null;break}if(null==e){if(null===t.type)return document.createTextNode(h);e=s?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type),n=null}return null===t.type?p!==h&&(null!=n&&(n[n.indexOf(e)]=null),e.data=h):t!==i&&(null!=n&&(n=Qi.slice.call(e.childNodes)),u=(p=i.props||Xi).dangerouslySetInnerHTML,d=h.dangerouslySetInnerHTML,a||(d||u)&&(d&&u&&d.__html==u.__html||(e.innerHTML=d&&d.__html||"")),function(e,t,i,o,s){var n;for(n in i)n in t||mo(e,n,null,i[n],o);for(n in t)s&&"function"!=typeof t[n]||"value"===n||"checked"===n||i[n]===t[n]||mo(e,n,t[n],i[n],o)}(e,h,p,s,a),t.__k=t.props.children,d||po(e,t,i,o,"foreignObject"!==t.type&&s,n,r,Xi,a),a||("value"in h&&void 0!==h.value&&h.value!==e.value&&(e.value=null==h.value?"":h.value),"checked"in h&&void 0!==h.checked&&h.checked!==e.checked&&(e.checked=h.checked))),e}(i.__e,t,i,o,s,n,r,c);(u=qi.diffed)&&u(t)}catch(e){qi.__e(e,t,i)}return t.__e}function bo(e,t){for(var i;i=e.pop();)try{i.componentDidMount()}catch(e){qi.__e(e,i.__v)}qi.__c&&qi.__c(t)}function yo(e,t,i){try{"function"==typeof e?e(t):e.current=t}catch(e){qi.__e(e,i)}}function ko(e,t,i){var o,s,n;if(qi.unmount&&qi.unmount(e),(o=e.ref)&&yo(o,null,t),i||"function"==typeof e.type||(i=null!=(s=e.__e)),e.__e=e.l=null,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){qi.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(n=0;n<o.length;n++)o[n]&&ko(o[n],t,i);null!=s&&io(s)}function wo(e,t,i){return this.constructor(e,i)}function xo(){return xo=Object.assign||function(e){for(var t=arguments,i=1;i<arguments.length;i++){var o=t[i];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},xo.apply(this,arguments)}qi={},ro.prototype.setState=function(e,t){var i=this.__s!==this.state&&this.__s||(this.__s=to({},this.state));("function"!=typeof e||(e=e(i,this.props)))&&to(i,e),null!=e&&this.__v&&(this.u=!1,t&&this.__h.push(t),co(this))},ro.prototype.forceUpdate=function(e){this.__v&&(e&&this.__h.push(e),this.u=!0,co(this))},ro.prototype.render=no,Ki=[],Yi="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Zi=qi.debounceRendering,qi.__e=function(e,t,i){for(var o;t=t.__p;)if((o=t.__c)&&!o.__p)try{if(o.constructor&&null!=o.constructor.getDerivedStateFromError)o.setState(o.constructor.getDerivedStateFromError(e));else{if(null==o.componentDidCatch)continue;o.componentDidCatch(e)}return co(o.__E=o)}catch(t){e=t}throw e},Ji=Xi;var Co="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",So="[\\s|\\(]+("+Co+")[,|\\s]+("+Co+")[,|\\s]+("+Co+")\\s*\\)?",_o="[\\s|\\(]+("+Co+")[,|\\s]+("+Co+")[,|\\s]+("+Co+")[,|\\s]+("+Co+")\\s*\\)?",Eo=new RegExp("rgb"+So),zo=new RegExp("rgba"+_o),$o=new RegExp("hsl"+So),To=new RegExp("hsla"+_o),Oo=new RegExp("^(?:#?|0x?)([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$"),Io=new RegExp("^(?:#?|0x?)([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$"),Ao=new RegExp("^(?:#?|0x?)([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$"),Mo=new RegExp("^(?:#?|0x?)([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$"),Lo=Math.log,Po=Math.round,No=Math.floor;function Ro(e,t,i){return Math.min(Math.max(e,t),i)}function jo(e,t){var i=e.indexOf("%")>-1,o=parseFloat(e);return i?t/100*o:o}function Do(e){return parseInt(e,16)}function Uo(e){return e.toString(16).padStart(2,"0")}var Fo,Ho=function(){function e(e,t){this.$={h:0,s:0,v:0,a:1},e&&this.set(e),this.onChange=t,this.initialValue=xo({},this.$)}var t,i=e.prototype;return i.set=function(t){if("string"==typeof t)/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(t)?this.hexString=t:/^rgba?/.test(t)?this.rgbString=t:/^hsla?/.test(t)&&(this.hslString=t);else{if("object"!=typeof t)throw new Error("Invalid color value");t instanceof e?this.hsv=t.hsv:"object"==typeof t&&"r"in t&&"g"in t&&"b"in t?this.rgb=t:"object"==typeof t&&"h"in t&&"s"in t&&"v"in t?this.hsv=t:"object"==typeof t&&"h"in t&&"s"in t&&"l"in t&&(this.hsl=t)}},i.setChannel=function(e,t,i){var o;this[e]=xo({},this[e],((o={})[t]=i,o))},i.reset=function(){this.hsva=this.initialValue},i.clone=function(){return new e(this)},i.unbind=function(){this.onChange=void 0},e.hsvToRgb=function(e){var t=e.h/60,i=e.s/100,o=e.v/100,s=No(t),n=t-s,r=o*(1-i),a=o*(1-n*i),l=o*(1-(1-n)*i),c=s%6,u=[l,o,o,a,r,r][c],d=[r,r,l,o,o,a][c];return{r:Ro(255*[o,a,r,r,l,o][c],0,255),g:Ro(255*u,0,255),b:Ro(255*d,0,255)}},e.rgbToHsv=function(e){var t=e.r/255,i=e.g/255,o=e.b/255,s=Math.max(t,i,o),n=Math.min(t,i,o),r=s-n,a=0,l=s,c=0===s?0:r/s;switch(s){case n:a=0;break;case t:a=(i-o)/r+(i<o?6:0);break;case i:a=(o-t)/r+2;break;case o:a=(t-i)/r+4}return{h:60*a%360,s:Ro(100*c,0,100),v:Ro(100*l,0,100)}},e.hsvToHsl=function(e){var t=e.s/100,i=e.v/100,o=(2-t)*i,s=o<=1?o:2-o,n=s<1e-9?0:t*i/s;return{h:e.h,s:Ro(100*n,0,100),l:Ro(50*o,0,100)}},e.hslToHsv=function(e){var t=2*e.l,i=e.s*(t<=100?t:200-t)/100,o=t+i<1e-9?0:2*i/(t+i);return{h:e.h,s:Ro(100*o,0,100),v:Ro((t+i)/2,0,100)}},e.kelvinToRgb=function(e){var t,i,o,s=e/100;return s<66?(t=255,i=-155.25485562709179-.44596950469579133*(i=s-2)+104.49216199393888*Lo(i),o=s<20?0:.8274096064007395*(o=s-10)-254.76935184120902+115.67994401066147*Lo(o)):(t=351.97690566805693+.114206453784165*(t=s-55)-40.25366309332127*Lo(t),i=325.4494125711974+.07943456536662342*(i=s-50)-28.0852963507957*Lo(i),o=255),{r:Ro(No(t),0,255),g:Ro(No(i),0,255),b:Ro(No(o),0,255)}},e.rgbToKelvin=function(t){for(var i,o=t.r,s=t.b,n=2e3,r=4e4;r-n>.4;){i=.5*(r+n);var a=e.kelvinToRgb(i);a.b/a.r>=s/o?r=i:n=i}return i},t=[{key:"hsv",get:function(){var e=this.$;return{h:e.h,s:e.s,v:e.v}},set:function(e){var t=this.$;if(e=xo({},t,e),this.onChange){var i={h:!1,v:!1,s:!1,a:!1};for(var o in t)i[o]=e[o]!=t[o];this.$=e,(i.h||i.s||i.v||i.a)&&this.onChange(this,i)}else this.$=e}},{key:"hsva",get:function(){return xo({},this.$)},set:function(e){this.hsv=e}},{key:"hue",get:function(){return this.$.h},set:function(e){this.hsv={h:e}}},{key:"saturation",get:function(){return this.$.s},set:function(e){this.hsv={s:e}}},{key:"value",get:function(){return this.$.v},set:function(e){this.hsv={v:e}}},{key:"alpha",get:function(){return this.$.a},set:function(e){this.hsv=xo({},this.hsv,{a:e})}},{key:"kelvin",get:function(){return e.rgbToKelvin(this.rgb)},set:function(t){this.rgb=e.kelvinToRgb(t)}},{key:"red",get:function(){return this.rgb.r},set:function(e){this.rgb=xo({},this.rgb,{r:e})}},{key:"green",get:function(){return this.rgb.g},set:function(e){this.rgb=xo({},this.rgb,{g:e})}},{key:"blue",get:function(){return this.rgb.b},set:function(e){this.rgb=xo({},this.rgb,{b:e})}},{key:"rgb",get:function(){var t=e.hsvToRgb(this.$),i=t.r,o=t.g,s=t.b;return{r:Po(i),g:Po(o),b:Po(s)}},set:function(t){this.hsv=xo({},e.rgbToHsv(t),{a:void 0===t.a?1:t.a})}},{key:"rgba",get:function(){return xo({},this.rgb,{a:this.alpha})},set:function(e){this.rgb=e}},{key:"hsl",get:function(){var t=e.hsvToHsl(this.$),i=t.h,o=t.s,s=t.l;return{h:Po(i),s:Po(o),l:Po(s)}},set:function(t){this.hsv=xo({},e.hslToHsv(t),{a:void 0===t.a?1:t.a})}},{key:"hsla",get:function(){return xo({},this.hsl,{a:this.alpha})},set:function(e){this.hsl=e}},{key:"rgbString",get:function(){var e=this.rgb;return"rgb("+e.r+", "+e.g+", "+e.b+")"},set:function(e){var t,i,o,s,n=1;if((t=Eo.exec(e))?(i=jo(t[1],255),o=jo(t[2],255),s=jo(t[3],255)):(t=zo.exec(e))&&(i=jo(t[1],255),o=jo(t[2],255),s=jo(t[3],255),n=jo(t[4],1)),!t)throw new Error("Invalid rgb string");this.rgb={r:i,g:o,b:s,a:n}}},{key:"rgbaString",get:function(){var e=this.rgba;return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},set:function(e){this.rgbString=e}},{key:"hexString",get:function(){var e=this.rgb;return"#"+Uo(e.r)+Uo(e.g)+Uo(e.b)},set:function(e){var t,i,o,s,n=255;if((t=Oo.exec(e))?(i=17*Do(t[1]),o=17*Do(t[2]),s=17*Do(t[3])):(t=Io.exec(e))?(i=17*Do(t[1]),o=17*Do(t[2]),s=17*Do(t[3]),n=17*Do(t[4])):(t=Ao.exec(e))?(i=Do(t[1]),o=Do(t[2]),s=Do(t[3])):(t=Mo.exec(e))&&(i=Do(t[1]),o=Do(t[2]),s=Do(t[3]),n=Do(t[4])),!t)throw new Error("Invalid hex string");this.rgb={r:i,g:o,b:s,a:n/255}}},{key:"hex8String",get:function(){var e=this.rgba;return"#"+Uo(e.r)+Uo(e.g)+Uo(e.b)+Uo(No(255*e.a))},set:function(e){this.hexString=e}},{key:"hslString",get:function(){var e=this.hsl;return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},set:function(e){var t,i,o,s,n=1;if((t=$o.exec(e))?(i=jo(t[1],360),o=jo(t[2],100),s=jo(t[3],100)):(t=To.exec(e))&&(i=jo(t[1],360),o=jo(t[2],100),s=jo(t[3],100),n=jo(t[4],1)),!t)throw new Error("Invalid hsl string");this.hsl={h:i,s:o,l:s,a:n}}},{key:"hslaString",get:function(){var e=this.hsla;return"hsl("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},set:function(e){this.hslString=e}}],t&&function(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(e.prototype,t),e}();function Bo(e){var t,i=e.width,o=e.sliderSize,s=e.borderWidth,n=e.handleRadius,r=e.padding,a=e.sliderShape,l="horizontal"===e.layoutDirection;return o=null!=(t=o)?t:2*r+2*n+2*s,"circle"===a?{handleStart:e.padding+e.handleRadius,handleRange:i-2*r-2*n-2*s,width:i,height:i,cx:i/2,cy:i/2,radius:i/2-s/2}:{handleStart:o/2,handleRange:i-o,radius:o/2,x:0,y:0,width:l?o:i,height:l?i:o}}function Wo(e){var t=e.width/2;return{width:e.width,radius:t-e.borderWidth,cx:t,cy:t}}function Vo(e,t,i){var o=e.wheelAngle,s=e.wheelDirection;return((t=!i&&"clockwise"===s||i&&"anticlockwise"===s?(i?180:360)-(o-t):o+t)%360+360)%360}function Go(e,t,i){var o=Wo(e),s=o.cx,n=o.cy,r=e.width/2-e.padding-e.handleRadius-e.borderWidth;t=s-t,i=n-i;var a=Vo(e,Math.atan2(-i,-t)*(180/Math.PI)),l=Math.min(Math.sqrt(t*t+i*i),r);return{h:Math.round(a),s:Math.round(100/r*l)}}function qo(e){var t=e.width,i=e.boxHeight;return{width:t,height:null!=i?i:t,radius:e.padding+e.handleRadius}}function Ko(e,t,i){var o=qo(e),s=o.width,n=o.height,r=o.radius,a=(t-r)/(s-2*r)*100,l=(i-r)/(n-2*r)*100;return{s:Math.max(0,Math.min(a,100)),v:Math.max(0,Math.min(100-l,100))}}function Yo(e){Fo||(Fo=document.getElementsByTagName("base"));var t=window.navigator.userAgent,i=/^((?!chrome|android).)*safari/i.test(t),o=/iPhone|iPod|iPad/i.test(t),s=window.location;return(i||o)&&Fo.length>0?s.protocol+"//"+s.host+s.pathname+s.search+e:e}function Zo(e,t,i,o,s){var n=s-o<=180?0:1;return o*=Math.PI/180,s*=Math.PI/180,"M "+(e+i*Math.cos(s))+" "+(t+i*Math.sin(s))+" A "+i+" "+i+" 0 "+n+" 0 "+(e+i*Math.cos(o))+" "+(t+i*Math.sin(o))}function Jo(e,t,i,o){for(var s=0;s<o.length;s++){var n=o[s].x-t,r=o[s].y-i;if(Math.sqrt(n*n+r*r)<e.handleRadius)return s}return null}var Xo=["mousemove","touchmove","mouseup","touchend"],Qo=function(e){function t(t){e.call(this,t),this.uid=(Math.random()+1).toString(36).substring(5)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(e){var t=this.handleEvent.bind(this),i={onMouseDown:t,ontouchstart:t},o="horizontal"===e.layoutDirection,s=null===e.margin?e.sliderMargin:e.margin,n={overflow:"visible",display:o?"inline-block":"block"};return e.index>0&&(n[o?"marginLeft":"marginTop"]=s),oo(no,null,e.children(this.uid,i,n))},t.prototype.handleEvent=function(e){var t=this,i=this.props.onInput,o=this.base.getBoundingClientRect();e.preventDefault();var s=e.touches?e.changedTouches[0]:e,n=s.clientX-o.left,r=s.clientY-o.top;switch(e.type){case"mousedown":case"touchstart":Xo.forEach((function(e){document.addEventListener(e,t,{passive:!1})})),i(n,r,0);break;case"mousemove":case"touchmove":i(n,r,1);break;case"mouseup":case"touchend":i(n,r,2),Xo.forEach((function(e){document.removeEventListener(e,t,{passive:!1})}))}},t}(ro);function es(e){var t=e.r,i=e.url;return oo("svg",{className:"IroHandle IroHandle--"+e.index+" "+(e.isActive?"IroHandle--isActive":""),x:e.x,y:e.y,style:{overflow:"visible"}},i&&oo("use",Object.assign({xlinkHref:Yo(i)},e.props)),!i&&oo("circle",{r:t,fill:"none","stroke-width":2,stroke:"#000"}),!i&&oo("circle",{r:t-2,fill:e.fill,"stroke-width":2,stroke:"#fff"}))}function ts(e){var t=e.activeIndex,i=void 0!==t&&t<e.colors.length?e.colors[t]:e.color,o=Bo(e),s=o.width,n=o.height,r=o.radius,a=function(e,t){var i=Bo(e),o=i.width,s=i.height,n=i.handleRange,r=i.handleStart,a="horizontal"===e.layoutDirection,l=function(e,t){var i=t.hsva,o=t.rgb;switch(e.sliderType){case"red":return o.r/2.55;case"green":return o.g/2.55;case"blue":return o.b/2.55;case"alpha":return 100*i.a;case"kelvin":var s=e.minTemperature,n=e.maxTemperature-s,r=(t.kelvin-s)/n*100;return Math.max(0,Math.min(r,100));case"hue":return i.h/=3.6;case"saturation":return i.s;default:return i.v}}(e,t),c=a?o/2:s/2,u=r+l/100*n;return a&&(u=-1*u+n+2*r),{x:a?c:u,y:a?u:c}}(e,i),l=function(e,t){var i=t.hsv,o=t.rgb;switch(e.sliderType){case"red":return[[0,"rgb(0,"+o.g+","+o.b+")"],[100,"rgb(255,"+o.g+","+o.b+")"]];case"green":return[[0,"rgb("+o.r+",0,"+o.b+")"],[100,"rgb("+o.r+",255,"+o.b+")"]];case"blue":return[[0,"rgb("+o.r+","+o.g+",0)"],[100,"rgb("+o.r+","+o.g+",255)"]];case"alpha":return[[0,"rgba("+o.r+","+o.g+","+o.b+",0)"],[100,"rgb("+o.r+","+o.g+","+o.b+")"]];case"kelvin":for(var s=[],n=e.minTemperature,r=e.maxTemperature,a=r-n,l=n,c=0;l<r;l+=a/8,c+=1){var u=Ho.kelvinToRgb(l),d=u.r,p=u.g,h=u.b;s.push([12.5*c,"rgb("+d+","+p+","+h+")"])}return s;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var f=Ho.hsvToHsl({h:i.h,s:0,v:i.v}),m=Ho.hsvToHsl({h:i.h,s:100,v:i.v});return[[0,"hsl("+f.h+","+f.s+"%,"+f.l+"%)"],[100,"hsl("+m.h+","+m.s+"%,"+m.l+"%)"]];default:var g=Ho.hsvToHsl({h:i.h,s:i.s,v:100});return[[0,"#000"],[100,"hsl("+g.h+","+g.s+"%,"+g.l+"%)"]]}}(e,i),c="alpha"===e.sliderType;return oo(Qo,Object.assign({},e,{onInput:function(t,o,s){var n=function(e,t,i){var o,s=Bo(e),n=s.handleRange,r=s.handleStart;o="horizontal"===e.layoutDirection?-1*i+n+r:t-r,o=Math.max(Math.min(o,n),0);var a=Math.round(100/n*o);switch(e.sliderType){case"kelvin":var l=e.minTemperature;return l+(e.maxTemperature-l)*(a/100);case"alpha":return a/100;case"hue":return 3.6*a;case"red":case"blue":case"green":return 2.55*a;default:return a}}(e,t,o);e.parent.inputActive=!0,i[e.sliderType]=n,e.onInput(s,e.id)}}),(function(t,o,u){return oo("svg",Object.assign({},o,{className:"IroSlider",width:s,height:n,style:u}),oo("defs",null,oo("linearGradient",Object.assign({id:"g"+t},function(e){var t="horizontal"===e.layoutDirection;return{x1:"0%",y1:t?"100%":"0%",x2:t?"0%":"100%",y2:"0%"}}(e)),l.map((function(e){return oo("stop",{offset:e[0]+"%","stop-color":e[1]})}))),c&&oo("pattern",{id:"b"+t,width:"8",height:"8",patternUnits:"userSpaceOnUse"},oo("rect",{x:"0",y:"0",width:"8",height:"8",fill:"#fff"}),oo("rect",{x:"0",y:"0",width:"4",height:"4",fill:"#ccc"}),oo("rect",{x:"4",y:"4",width:"4",height:"4",fill:"#ccc"})),c&&oo("pattern",{id:"f"+t,width:"100%",height:"100%"},oo("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+Yo("#b"+t)+")"}),oo("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+Yo("#g"+t)+")"}))),oo("rect",{className:"IroSliderBg",rx:r,ry:r,x:e.borderWidth/2,y:e.borderWidth/2,width:s-e.borderWidth,height:n-e.borderWidth,"stroke-width":e.borderWidth,stroke:e.borderColor,fill:"url("+Yo((c?"#f":"#g")+t)+")"}),oo(es,{isActive:!0,index:i.index,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:a.x,y:a.y}))}))}es.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}},ts.defaultProps=Object.assign({},{sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3});var is=Array.apply(null,{length:360}).map((function(e,t){return t}));function os(e){var t=Wo(e),i=t.width,o=t.radius,s=t.cx,n=t.cy,r=e.colors,a=e.borderWidth,l=e.parent,c=e.color,u=c.hsv,d=r.map((function(t){return function(e,t){var i=t.hsv,o=Wo(e),s=o.cx,n=o.cy,r=e.width/2-e.padding-e.handleRadius-e.borderWidth,a=(180+Vo(e,i.h,!0))*(Math.PI/180),l=i.s/100*r,c="clockwise"===e.wheelDirection?-1:1;return{x:s+l*Math.cos(a)*c,y:n+l*Math.sin(a)*c}}(e,t)}));return oo(Qo,Object.assign({},e,{onInput:function(t,i,o){if(0===o){var s=Jo(e,t,i,d);null!==s?l.setActiveColor(s):(l.inputActive=!0,c.hsv=Go(e,t,i),e.onInput(o,e.id))}else 1===o&&(l.inputActive=!0,c.hsv=Go(e,t,i));e.onInput(o,e.id)}}),(function(t,l,p){return oo("svg",Object.assign({},l,{className:"IroWheel",width:i,height:i,style:p}),oo("defs",null,oo("radialGradient",{id:t},oo("stop",{offset:"0%","stop-color":"#fff"}),oo("stop",{offset:"100%","stop-color":"#fff","stop-opacity":"0"}))),oo("g",{className:"IroWheelHue","stroke-width":o,fill:"none"},is.map((function(t){return oo("path",{key:t,d:Zo(s,n,o/2,t,t+1.5),stroke:"hsl("+Vo(e,t)+", 100%, 50%)"})}))),oo("circle",{className:"IroWheelSaturation",cx:s,cy:n,r:o,fill:"url("+Yo("#"+t)+")"}),e.wheelLightness&&oo("circle",{className:"IroWheelLightness",cx:s,cy:n,r:o,fill:"#000",opacity:1-u.v/100}),oo("circle",{className:"IroWheelBorder",cx:s,cy:n,r:o,fill:"none",stroke:e.borderColor,"stroke-width":a}),r.filter((function(e){return e!==c})).map((function(t){return oo(es,{isActive:!1,index:t.index,fill:t.hslString,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:d[t.index].x,y:d[t.index].y})})),oo(es,{isActive:!0,index:c.index,fill:c.hslString,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:d[c.index].x,y:d[c.index].y}))}))}var ss=function(e){function t(t){var i=this;e.call(this,t),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=t.id,(t.colors.length>0?t.colors:[t.color]).forEach((function(e){return i.addColor(e)})),this.setActiveColor(0),this.state=Object.assign({},t,{color:this.color,colors:this.colors,layout:t.layout})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addColor=function(e,t){void 0===t&&(t=this.colors.length);var i=new Ho(e,this.onColorChange.bind(this));this.colors.splice(t,0,i),this.colors.forEach((function(e,t){return e.index=t})),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",i)},t.prototype.removeColor=function(e){var t=this.colors.splice(e,1)[0];t.unbind(),this.colors.forEach((function(e,t){return e.index=t})),this.state&&this.setState({colors:this.colors}),t.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",t)},t.prototype.setActiveColor=function(e){this.color=this.colors[e],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},t.prototype.setColors=function(e,t){var i=this;void 0===t&&(t=0),this.colors.forEach((function(e){return e.unbind()})),this.colors=[],e.forEach((function(e){return i.addColor(e)})),this.setActiveColor(t),this.emit("color:setAll",this.colors)},t.prototype.on=function(e,t){var i=this,o=this.events;(Array.isArray(e)?e:[e]).forEach((function(e){(o[e]||(o[e]=[])).push(t),i.deferredEvents[e]&&(i.deferredEvents[e].forEach((function(e){t.apply(null,e)})),i.deferredEvents[e]=[])}))},t.prototype.off=function(e,t){var i=this;(Array.isArray(e)?e:[e]).forEach((function(e){var o=i.events[e];o&&o.splice(o.indexOf(t),1)}))},t.prototype.emit=function(e){for(var t=this,i=[],o=arguments.length-1;o-- >0;)i[o]=arguments[o+1];var s=this.activeEvents,n=!!s.hasOwnProperty(e)&&s[e];if(!n){s[e]=!0;var r=this.events[e]||[];r.forEach((function(e){return e.apply(t,i)})),s[e]=!1}},t.prototype.deferredEmit=function(e){for(var t,i=[],o=arguments.length-1;o-- >0;)i[o]=arguments[o+1];var s=this.deferredEvents;(t=this).emit.apply(t,[e].concat(i)),(s[e]||(s[e]=[])).push(i)},t.prototype.setOptions=function(e){this.setState(Object.assign({},this.state,e))},t.prototype.resize=function(e){this.setOptions({width:e})},t.prototype.reset=function(){this.colors.forEach((function(e){return e.reset()})),this.setState({colors:this.colors})},t.prototype.onMount=function(e){this.el=e,this.deferredEmit("mount",this)},t.prototype.onColorChange=function(e,t){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",e,t)),this.emit("color:change",e,t)},t.prototype.emitInputEvent=function(e,t){0===e?this.emit("input:start",this.color,t):1===e?this.emit("input:move",this.color,t):2===e&&this.emit("input:end",this.color,t)},t.prototype.render=function(e,t){var i=this,o=t.layout;return Array.isArray(o)||(o=[{component:os},{component:ts}],t.transparency&&o.push({component:ts,options:{sliderType:"alpha"}})),oo("div",{class:"IroColorPicker",id:t.id,style:{display:t.display}},o.map((function(e,o){var s=e.component,n=e.options;return oo(s,Object.assign({},t,n,{ref:void 0,onInput:i.emitInputEvent.bind(i),parent:i,index:o}))})))},t}(ro);ss.defaultProps=Object.assign({},{width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},{colors:[],display:"block",id:null,layout:"default",margin:null});var ns,rs,as,ls,cs,us=(rs=function(e,t){var i,o=document.createElement("div");function s(){var t=e instanceof Element?e:document.querySelector(e);t.appendChild(i.base),i.onMount(t)}return function(e,t,i){var o,s,n;qi.__p&&qi.__p(e,t),s=(o=void 0===Ji)?null:t.__k,e=oo(no,null,[e]),n=[],vo(t,t.__k=e,s||Xi,Xi,void 0!==t.ownerSVGElement,s?null:Qi.slice.call(t.childNodes),n,!1,Xi,o),bo(n,e)}(oo(ns,Object.assign({},{ref:function(e){return i=e}},t)),o),"loading"!==document.readyState?s():document.addEventListener("DOMContentLoaded",s),i},rs.prototype=(ns=ss).prototype,Object.assign(rs,ns),rs.__component=ns,rs);(ls=as||(as={})).version="5.3.2",ls.Color=Ho,ls.ColorPicker=us,(cs=ls.ui||(ls.ui={})).h=oo,cs.ComponentBase=Qo,cs.Handle=es,cs.Slider=ts,cs.Wheel=os,cs.Box=function(e){var t=qo(e),i=t.width,o=t.height,s=t.radius,n=e.colors,r=e.parent,a=e.activeIndex,l=void 0!==a&&a<e.colors.length?e.colors[a]:e.color,c=[[[0,"#fff"],[100,"hsl("+l.hue+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]],u=n.map((function(t){return function(e,t){var i=qo(e),o=i.width,s=i.height,n=i.radius,r=t.hsv,a=n,l=o-2*n,c=s-2*n;return{x:a+r.s/100*l,y:a+(c-r.v/100*c)}}(e,t)}));return oo(Qo,Object.assign({},e,{onInput:function(t,i,o){if(0===o){var s=Jo(e,t,i,u);null!==s?r.setActiveColor(s):(r.inputActive=!0,l.hsv=Ko(e,t,i),e.onInput(o,e.id))}else 1===o&&(r.inputActive=!0,l.hsv=Ko(e,t,i));e.onInput(o,e.id)}}),(function(t,r,a){return oo("svg",Object.assign({},r,{className:"IroBox",width:i,height:o,style:a}),oo("defs",null,oo("linearGradient",{id:"s"+t,x1:"0%",y1:"0%",x2:"100%",y2:"0%"},c[0].map((function(e){return oo("stop",{offset:e[0]+"%","stop-color":e[1]})}))),oo("linearGradient",{id:"l"+t,x1:"0%",y1:"0%",x2:"0%",y2:"100%"},c[1].map((function(e){return oo("stop",{offset:e[0]+"%","stop-color":e[1]})}))),oo("pattern",{id:"f"+t,width:"100%",height:"100%"},oo("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+Yo("#s"+t)+")"}),oo("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url("+Yo("#l"+t)+")"}))),oo("rect",{className:"IroBoxBg",rx:s,ry:s,x:e.borderWidth/2,y:e.borderWidth/2,width:i-e.borderWidth,height:o-e.borderWidth,"stroke-width":e.borderWidth,stroke:e.borderColor,fill:"url("+Yo("#f"+t)+")"}),n.filter((function(e){return e!==l})).map((function(t){return oo(es,{isActive:!1,index:t.index,fill:t.hslString,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:u[t.index].x,y:u[t.index].y})})),oo(es,{isActive:!0,index:l.index,fill:l.hslString,r:e.handleRadius,url:e.handleSvg,props:e.handleProps,x:u[l.index].x,y:u[l.index].y}))}))};var ds=as;const ps=new Map([["aliceblue","#f0f8ff"],["antiquewhite","#faebd7"],["aqua","#00ffff"],["aquamarine","#7fffd4"],["azure","#f0ffff"],["beige","#f5f5dc"],["bisque","#ffe4c4"],["black","#000000"],["blanchedalmond","#ffebcd"],["blue","#0000ff"],["blueviolet","#8a2be2"],["brown","#a52a2a"],["burlywood","#deb887"],["cadetblue","#5f9ea0"],["chartreuse","#7fff00"],["chocolate","#d2691e"],["coral","#ff7f50"],["cornflowerblue","#6495ed"],["cornsilk","#fff8dc"],["crimson","#dc143c"],["cyan","#00ffff"],["darkblue","#00008b"],["darkcyan","#008b8b"],["darkgoldenrod","#b8860b"],["darkgray","#a9a9a9"],["darkgrey","#a9a9a9"],["darkgreen","#006400"],["darkkhaki","#bdb76b"],["darkmagenta","#8b008b"],["darkolivegreen","#556b2f"],["darkorange","#ff8c00"],["darkorchid","#9932cc"],["darkred","#8b0000"],["darksalmon","#e9967a"],["darkseagreen","#8fbc8f"],["darkslateblue","#483d8b"],["darkslategray","#2f4f4f"],["darkslategrey","#2f4f4f"],["darkturquoise","#00ced1"],["darkviolet","#9400d3"],["deeppink","#ff1493"],["deepskyblue","#00bfff"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1e90ff"],["firebrick","#b22222"],["floralwhite","#fffaf0"],["forestgreen","#228b22"],["fuchsia","#ff00ff"],["gainsboro","#dcdcdc"],["ghostwhite","#f8f8ff"],["gold","#ffd700"],["goldenrod","#daa520"],["gray","#808080"],["grey","#808080"],["green","#008000"],["greenyellow","#adff2f"],["honeydew","#f0fff0"],["hotpink","#ff69b4"],["indianred","#cd5c5c"],["indigo","#4b0082"],["ivory","#fffff0"],["khaki","#f0e68c"],["lavender","#e6e6fa"],["lavenderblush","#fff0f5"],["lawngreen","#7cfc00"],["lemonchiffon","#fffacd"],["lightblue","#add8e6"],["lightcoral","#f08080"],["lightcyan","#e0ffff"],["lightgoldenrodyellow","#fafad2"],["lightgray","#d3d3d3"],["lightgrey","#d3d3d3"],["lightgreen","#90ee90"],["lightpink","#ffb6c1"],["lightsalmon","#ffa07a"],["lightseagreen","#20b2aa"],["lightskyblue","#87cefa"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#b0c4de"],["lightyellow","#ffffe0"],["lime","#00ff00"],["limegreen","#32cd32"],["linen","#faf0e6"],["magenta","#ff00ff"],["maroon","#800000"],["mediumaquamarine","#66cdaa"],["mediumblue","#0000cd"],["mediumorchid","#ba55d3"],["mediumpurple","#9370d8"],["mediumseagreen","#3cb371"],["mediumslateblue","#7b68ee"],["mediumspringgreen","#00fa9a"],["mediumturquoise","#48d1cc"],["mediumvioletred","#c71585"],["midnightblue","#191970"],["mintcream","#f5fffa"],["mistyrose","#ffe4e1"],["moccasin","#ffe4b5"],["navajowhite","#ffdead"],["navy","#000080"],["oldlace","#fdf5e6"],["olive","#808000"],["olivedrab","#6b8e23"],["orange","#ffa500"],["orangered","#ff4500"],["orchid","#da70d6"],["palegoldenrod","#eee8aa"],["palegreen","#98fb98"],["paleturquoise","#afeeee"],["palevioletred","#d87093"],["papayawhip","#ffefd5"],["peachpuff","#ffdab9"],["peru","#cd853f"],["pink","#ffc0cb"],["plum","#dda0dd"],["powderblue","#b0e0e6"],["purple","#800080"],["red","#ff0000"],["rosybrown","#bc8f8f"],["royalblue","#4169e1"],["saddlebrown","#8b4513"],["salmon","#fa8072"],["sandybrown","#f4a460"],["seagreen","#2e8b57"],["seashell","#fff5ee"],["sienna","#a0522d"],["silver","#c0c0c0"],["skyblue","#87ceeb"],["slateblue","#6a5acd"],["slategray","#708090"],["slategrey","#708090"],["snow","#fffafa"],["springgreen","#00ff7f"],["steelblue","#4682b4"],["tan","#d2b48c"],["teal","#008080"],["thistle","#d8bfd8"],["tomato","#ff6347"],["turquoise","#40e0d0"],["violet","#ee82ee"],["wheat","#f5deb3"],["white","#ffffff"],["whitesmoke","#f5f5f5"],["yellow","#ffff00"],["yellowgreen","#9acd32"]]),hs=[...ps.entries()].reduce(((e,[t,i])=>(e.set(i,t),e)),new Map),fs=e=>class extends e{constructor(e,{defaults:t={},...i}){super(e,i),this.defaults=t}renderSvg(e){}svgCellCenter(e){const{row:i,col:o}=t(this.size,e);return[Ri(o+.5),Ri(i+.5)]}svgPathData(e,t=0,o=0){let s=e.map((e=>this.svgCellCenter(e)));if(t){const[e,o]=s.slice(0,2);s=[i(e,o,Ri(t)),...s.slice(1)]}if(o){const[e,t]=s.slice(-2);s=[...s.slice(0,-1),i(t,e,Ri(o))]}return s.map(((e,t)=>`${0===t?"M":"L"}${e}`)).join("")}enclosingPaths(e,t=0){return o(e,t,this.size).map((e=>e.map((([e,t])=>[Ri(e),Ri(t)]))))}errorColor(e){const t=new ds.Color(ps.get(e)||e),i=new ds.Color(ps.get("crimson"));return t.hsl.l<50&&i.setChannel("hsl","l",i.hsl.l+(100-i.hsl.l)/2),i.hex8String}params(e){const t=(e,i,o)=>{let s={};for(const[n,r]of Object.entries(e))switch(r.type){case"booleanSection":case"section":s={...s,[n]:t(e[n],i[n]??{},o[n])};break;case"choice":if(e[n].choices){for(const[r,{template:a}]of Object.entries(e[n].choices))s={...s,...t(a,i[n]?.[r]??{},o)};break}default:s[n]=o[n]??i[n]??e[n]?.default}return s};return{...e,...t(this.constructor.itemTemplate(),this.defaults,e)}}static dataUrl(e){return Gi(e,"0 0 200 200")}static svgImage(e){return ft`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 200 200" width="50">${e}<svg></svg></svg>`}};class ms extends(fs(a)){renderSvg(e={},t=[]){return this.arrows.map(((i,o)=>{let{arrowheadRatio:r,positions:a,color:l,arrowheadLength:c,radius:u,strokeWidth:d,fill:p,opacity:h,strokeLinejoin:f="round",strokeLinecap:m="round",_creating:g,_editing:v}=this.params(i);if(0===a.length)return[];const b=this.svgCellCenter(a[0]);l=e.showConflicts&&t[a[0]]?.arrow?.includes(o)?"crimson":l;const y=a.length>1?this.svgPathData(a,u/100,.125):"";let k="";if(a.length>1){const{x:e,y:t}=y.match(/L(?<x>[\d\.]+),(?<y>[\d\.]+)$/).groups,i=c/2,o=i*r,l=s(n(...a.slice(-2).map(this.svgCellCenter.bind(this))));k=Fi(`M${e-i},${t-o}L${~~e+i},${t}L${e-i},${~~t+o}M${e-1},${t}L${~~e+i},${t}`,{transform:`rotate(${l},${e},${t})`})}const w=[k,Bi(b,u,{strokeWidth:d,fill:p}),Fi(y,{strokeLinejoin:f,strokeLinecap:"butt"})];return Di("arrow",w,{index:o,stroke:l,strokeWidth:d,fill:"none",opacity:h})}))}static layer(){return 0}static itemTemplate(){return{positions:{type:"positions",range:[2,10],label:"cells"},color:{optional:!0,type:"color",default:"darkgrey"},strokeWidth:{optional:!0,type:"number",range:[0,25],label:"line width",default:4},fill:{optional:!0,type:"color",default:"none",alpha:!0},radius:{optional:!0,type:"number",range:[0,50],default:36},arrowheadLength:{optional:!0,type:"number",range:[0,50],label:"arrowhead l",default:20},arrowheadRatio:{optional:!0,type:"number",range:[.5,2],step:.1,label:"h/l ratio",default:1.6},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Arrow by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW]}static icon(){if(!this._icon){const e=new ms({size:9},{items:[{positions:[0,1,10],color:"grey",strokeWidth:12,arrowheadLength:38,radius:43}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}static ghost(e){return new ms({size:9},{items:[{...e,opacity:.5}]}).renderSvg()}}class gs extends(fs(l)){renderSvg(e={},t=[]){const i=[],o=this.lines.map(((o,s)=>{let{positions:n,stroke:r,strokeWidth:a,fill:l,radius:c,opacity:u}=this.params(o);if(0===n.length)return[];const d=n.map((e=>this.svgCellCenter(e))),p=[d[0],d[d.length-1]],h=n.length>1?this.svgPathData(n,~~c/100,~~c/100):"";r=e.showConflicts&&n.some((e=>t[e]?.betweenline?.includes(s)))?"crimson":r;const f=Di("betweenline",[Bi(p[0],c),Bi(p[1],c),Fi(h,{fill:"transparent",strokeLinejoin:"round"})],{index:s,stroke:r,fill:l,strokeWidth:a,opacity:u});return e.showConflicts&&n.some((e=>t[e]?.betweenline?.includes(s)))&&i.push(f),f}));return[...o.filter((e=>!i.includes(e))),...i]}static layer(){return 0}static itemTemplate(){return{positions:{type:"positions",range:[3,81],label:"cells"},stroke:{optional:!0,type:"color",default:"darkgrey"},strokeWidth:{optional:!0,type:"number",range:[0,25],label:"line width",default:3},fill:{optional:!0,type:"color",default:"lightgrey",alpha:!0},radius:{optional:!0,type:"number",range:[0,50],default:30},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Between Line by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW]}static icon(){if(!this._icon){const e=new gs({size:9},{items:[{positions:[0,9,10],stroke:"grey",strokeWidth:12,radius:40}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}}class vs extends(fs(c)){static layer(){return 1}renderSvg(t){const i=Ri(this.rows),o=Ri(this.cols),s=e(this.cols,(e=>i*e)),n=e(this.rows,(e=>o*e)),r=s.flatMap((e=>n.map((t=>Hi([e,t],i,o)))));return Di("box grid",r,{stroke:"black",fill:"none",strokeWidth:3.5})}}class bs extends(fs(u)){static layer(){return 1}renderSvg(){const t=Ri(this.size)+2,i=e(this.size+2,(e=>{const i=Ri(e),o=0===e?i-2:e===this.size?i+2:i,s=0===e||e===this.size?4:1;return Fi(`M${o},-2L${o},${t}`,{strokeWidth:s})}));return Di("column grid",i,{stroke:"black",strokeLinecap:"square"})}}class ys extends(fs(d)){renderSvg(e={},t=[]){return this.items.map((({positions:i,orientation:o,color:s="cyan",strokeWidth:n="3",opacity:r=1})=>{s=e.showConflicts&&i.some((e=>t[e]?.diagonal?.includes(index)))?"crimson":s;const a=-Math.sqrt(2)/2,l=Fi(this.svgPathData(i,a,a));return Di("diagonal",l,{stroke:s,strokeWidth:n,fill:"transparent",opacity:r})}))}static layer(){return 0}}class ks extends(fs(Object)){constructor(e,{items:t,defaults:i}){super(e,{defaults:i}),this.items=t}renderSvg(e={},t=[]){return this.items.map(((e,t)=>{let{stroke:i,point:o,sizes:s,rotation:n,strokeWidth:r,fill:a,opacity:l,_creating:c,_editing:u}=this.params(e);if(!o||o.length<2||!s||s.length<1)return[];const d=o.map((e=>Number(e))),[p,h]=s.map((e=>Number(e))),f={index:t,stroke:i,fill:a,strokeWidth:r,opacity:l},m=(([e,t],i,o,{rotation:s,stroke:n,strokeWidth:r,fill:a}={})=>{const l=s?`rotate(${s} ${e} ${t})`:void 0;return mt`<ellipse cx="${e}" cy="${t}" rx="${Math.abs(i)}" ry="${Math.abs(o)}" transform="${Ni(l)}" stroke="${Ni(n)}" stroke-width="${Ni(r)}" fill="${Ni(a)}"></ellipse>`})(d,Math.max(.1,p),Math.max(.1,h??p),{rotation:n});return Di("ellipse "+(c||u?"selected":""),m,f)}))}static layer(){return 0}static label(){return"Ellipse"}static itemTemplate(){return{_snapToGrid:{type:"boolean",label:"snap to grid",default:!0},point:{label:"center",type:"array",delimiter:", "},sizes:{label:"radius",type:"array",delimiter:", "},rotation:{optional:!0,type:"number",default:0,range:[-360,360]},stroke:{optional:!0,type:"color",default:"darkgrey"},strokeWidth:{optional:!0,type:"number",range:[0,400],label:"line width",default:3},fill:{optional:!0,type:"color",default:"none",alpha:!0},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Click or drag Ellipse onto the grid, setting the center, radius, and rotation. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[p.CENTER_SIZE]}static icon(){if(!this._icon){const e=new ks({size:9},{items:[{snapToGrid:!1,point:[85,85],sizes:[70,70],stroke:"black",strokeWidth:12,fill:"lightgrey"}]}),t=new ks({size:9},{items:[{snapToGrid:!1,point:[120,120],sizes:[50,90],rotation:45,opacity:.7,stroke:"black",strokeWidth:12,fill:"lightgrey"}]}),i=Di("ellipseIcon",[e.renderSvg(),t.renderSvg()]);this._icon=Gi(i,"0 0 200 200")}return this._icon}}class ws extends(fs(h)){static layer(){return 2}renderSvg(e={},t=[]){return this.symbols.map(((i,o)=>{let{positions:s,color:r,radius:a,fontSize:l="40px",opacity:c}=this.params(i);if(s.length<2)return[];const u=this.svgCellCenter(s[0]),d=this.svgCellCenter(s[1]),[p,h]=m(u,d);r=e.showConflicts&&s.some((e=>t[e]?.inequality?.includes(o)))?"crimson":r;const f=180/Math.PI*n(u,d);return Di("inequality",[Bi([p,h],a,{fill:"white",stroke:"none"}),Ui([p,h],ft`>`,{transform:`rotate(${f} ${p} ${h})`,textAnchor:"middle",dominantBaseline:"middle",fontSize:l,stroke:"none",fill:r})],{index:o,opacity:c})}))}static itemTemplate(){return{positions:{type:"positions",range:[2,2],label:"cells"},color:{optional:!0,type:"color",default:"black"},radius:{optional:!0,type:"number",range:[0,50],default:14},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Inequality by clicking in the higher value cell near a cell border. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[f.DOMINO]}static icon(){if(!this._icon){const e=Vi("* {font-family: helvetica}"),t=new ws({size:9},{defaults:{radius:30},items:[{fontSize:"70px",positions:[0,1]},{fontSize:"70px",positions:[1,10]},{fontSize:"70px",positions:[10,9]},{fontSize:"70px",positions:[9,0]}]}),i=[Fi("M100,0L100,200M0,100L200,100",{stroke:"black",strokeWidth:1})];this._icon=Gi([e,i,t.renderSvg()],"0 0 200 200")}return this._icon}}class xs extends(fs(g)){static layer(){return 0}renderSvg(e={},t=[]){const i=this.cages.map((e=>this.enclosingPaths(e.positions,ji(e.inset??this.defaults?.inset??6)))),o=i.map((e=>e.map((e=>e.map(((e,t,i)=>`${0===t?"M":"L"}${e}${t===i.length-1?"Z":""}`)).join(""))))),s="outline"+~~(1e5*v()());return[mt` <defs> <filter id="${s}" filterRes="1"> <feMorphology in="SourceAlpha" result="DILATED" operator="dilate" radius="2"></feMorphology> <feFlood flood-color="white" flood-opacity="1" result="WHITE"></feFlood> <feComposite in="WHITE" in2="DILATED" operator="in" result="OUTLINE"></feComposite> <feMerge> <feMergeNode in="OUTLINE"></feMergeNode> <feMergeNode in="SourceGraphic"></feMergeNode> </feMerge> </filter> </defs> `,...this.cages.flatMap(((s,n)=>{let{sum:r,positions:a,stroke:l,strokeWidth:c,fill:u,dashArray:d="8 4",fontSize:p="18px",opacity:h,inset:f}=this.params(s);l=e.showConflicts&&a.some((e=>t[e]?.killercage?.includes(n)))?"crimson":l;const m=i[n].map(((e,t)=>{const i=o[n][t];return Fi(i,{strokeDasharray:d,fill:u,mask:`url(#cage${n}mask)`})}));if(r&&s.positions.length){const e=Math.min(...s.positions),t=this.svgCellCenter(e),i=[t[0]-Ri(.5-ji(f))-c/2,t[1]-Ri(.5-ji(f))-c/2];m.unshift((e=>mt`<defs>${e}</defs>`)([Wi(`cage${n}mask`,[Hi([0,0],900,900,{fill:"white"}),Hi(i,11*`${r}`.length,14,{fill:"black"})])]));const o=[i[0]+5.5*`${r}`.length,i[1]];m.push(Ui(o,r,{fontSize:p,dominantBaseline:"hanging",textAnchor:"middle",fill:"black",stroke:"none"}))}return Di("killercage",m,{index:n,stroke:l,strokeWidth:c,opacity:h})}))]}static itemTemplate(){return{positions:{type:"positions",range:[3,81],label:"cells"},sum:{optional:!0,type:"number",range:[0,45],autofocus:!0},stroke:{optional:!0,type:"color",default:"black"},strokeWidth:{optional:!0,type:"number",range:[0,25],step:.1,label:"line width",default:2},fill:{optional:!0,type:"color",default:"none",alpha:!0},inset:{optional:!0,type:"number",default:6,range:[-10,20]},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Killer Cage by clicking or dragging on the grid. Type sum if any. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW,r.BOX_DRAW]}static icon(){if(!this._icon){const e=new xs({size:9},{items:[{positions:[0,1,9],strokeWidth:12,dashArray:"24 8"}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}}class Cs extends(fs(b)){static layer(){return 2}renderSvg(e={},t=[]){return this.items?.map(((i,o)=>{if(i.positions.length<2)return[];const{positions:s,doublesStroke:n,doublesFill:r,consecutivesStroke:a,consecutivesFill:l,radius:c,opacity:u,consecutivesRadius:d,consecutivesOpacity:p}=this.params(i),h=e.showConflicts&&s.some((e=>t[e]?.kropki?.includes(o))),f=h?"crimson":"black",[g,v]=m(this.svgCellCenter(s[0]),this.svgCellCenter(s[1]));return"consecutive"===i.type?Di("kropki consecutive",Bi([g,v],d),{index:o,fill:l,strokeWidth:4,stroke:h?f:a,opacity:p}):Di("kropki double",Bi([g,v],c),{index:o,fill:r,strokeWidth:4,stroke:h?f:n,opacity:u})}))}static constraintTemplate(){return{negativeConstraint:{type:"boolean",label:"Negative constraint"}}}static itemTemplate(){return{positions:{type:"positions",range:[2,2],label:"cells"},type:{type:"choice",default:"double",autofocus:!0,choices:{double:{label:"2:1 ratio",template:{doublesStroke:{optional:!0,type:"color",label:"stroke",default:"black"},doublesFill:{optional:!0,type:"color",label:"fill",default:"black",alpha:!0},radius:{optional:!0,type:"number",default:10,range:[0,25]},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1}}},consecutive:{label:"consecutive",template:{consecutivesStroke:{optional:!0,type:"color",label:"stroke",default:"black"},consecutivesFill:{optional:!0,type:"color",label:"fill",default:"white",alpha:!0},consecutivesRadius:{optional:!0,type:"number",label:"radius",default:10,range:[0,25]},consecutivesOpacity:{optional:!0,type:"number",label:"opacity",range:[0,1],step:.01,default:1}}}}},tip:"Position Kropki Dots by clicking on a cell border using alt-key to switch dot type. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[f.DOMINO]}static icon(){if(!this._icon){const e=new Cs({size:9},{items:[{type:"double",radius:20,positions:[0,1]},{type:"double",radius:20,positions:[10,9]},{type:"consecutive",consecutivesRadius:20,positions:[9,0]},{type:"consecutive",consecutivesRadius:20,positions:[1,10]}]}),t=[Fi("M100,0L100,200M0,100L200,100",{stroke:"black",strokeWidth:1})];this._icon=Gi([...t,...e.renderSvg()],"0 0 200 200")}return this._icon}}class Ss extends(fs(y)){static gutter(){return!0}static layer(){return 1}renderSvg(e={},t=[]){return[this.diagonals.map(((i,o)=>{let{positions:s,sum:r,color:a,arrowsize:l=12,arrowLength:c,strokeWidth:u,strokeLinejoin:d="round",strokeLinecap:p="round",opacity:h=1}=this.params(i);if(s.length){a=e.showConflicts&&s.some((e=>t[e]?.littlekiller?.includes(o)))?"crimson":a;const[i,f]=this.svgCellCenter(s[0]),[m,g]=k(s).on((({length:e})=>e>1),(e=>this.svgCellCenter(e[1]))).otherwise((e=>{const t=this.size-1,i=this.size**2-this.size,o=this.size**2-1;return(([e,t])=>[Ri(e),Ri(t)])(k(s[0]).on((e=>0===e),(e=>[1.5,-.5])).on((e=>e===t),(e=>[this.size-1.5,-.5])).on((e=>e===i),(e=>[1.5,this.size+.5])).on((e=>e===o),(e=>[this.size-1.5,this.size+.5])).otherwise((e=>[])))})),[v,b]=[i-m,f-g],y=ji(c),[w,x]=[i+(y+.65)*v,f+(y+.65)*b],[C,S]=[i+.65*v,f+.65*b],[_,E]=[i+(y+.8)*v,f+(y+.8)*b];let z="";const $=l/2,T=180*n([w,x],[C,S])/Math.PI;z=Fi([`M${C-$},${S-$}`,`L${~~C+$},${S}`,`L${C-$},${~~S+$}`,`M${C},${S}`,`L${~~C+$},${S}`].join(""),{transform:`rotate(${T},${C},${S})`,strokeLinejoin:d,strokeLinecap:p});const O=[z,Fi(`M${w},${x}L${C},${S}`),Ui([_,E],r,{textAnchor:"middle",dominantBaseline:"central",fontSize:"30px",fill:a,stroke:"none"})];return Di("littlekiller",O,{index:o,stroke:a,strokeWidth:u,fill:"none",opacity:h})}return[]}))]}static itemTemplate(){return{positions:{type:"positions",range:[2,9],label:"cells"},sum:{type:"number",range:[1,72],autofocus:!0},color:{optional:!0,type:"color",default:"black"},strokeWidth:{optional:!0,type:"number",range:[0,15],label:"line width",default:3},arrowLength:{optional:!0,type:"number",range:[10,35],label:"line length",default:16},tip:"Position Little Killer by selecting the cell nearest the sum arrow, using alt-key to switch arrow orientation. Type sum digits, adjust styles below, or just press enter to save."}}static selectionTemplates(){return[w.DIAGONAL_POSITIVE,w.DIAGONAL_NEGATIVE]}static icon(){if(!this._icon){const e=Vi("* {font-family: helvetica}"),t=[Fi("M70,70L70,200M70,70L200,70",{stroke:"black",strokeWidth:3}),Fi("M170,70L170,200M70,170L200,170",{stroke:"black",strokeWidth:1})],i=((e,t,{width:i,height:o,refX:s,refY:n,orient:r,markerUnits:a}={})=>mt`<marker id="${e}" markerWidth="${Ni(i)}" markerHeight="${Ni(o)}" refX="${Ni(s)}" refY="${Ni(n)}" orient="${Ni(r)}" markerUnits="${Ni(a)}">${t}</marker>`)("arrowhead",Fi("M1,1L11,6L1,11M6,6L11,6",{stroke:"black",fill:"none"}),{width:12,height:12,refX:6,refY:6,orient:"auto",markerUnits:"strokeWidth"}),o=[Fi("M35,35L60,60",{markerEnd:"url(#arrowhead)",stroke:"black",strokeWidth:2,fill:"none"}),Ui([20,20],"25",{textAnchor:"middle",dominantBaseline:"central",fontSize:"40px",stroke:"none"}),Fi("M35,135L60,160",{markerEnd:"url(#arrowhead)",stroke:"black",strokeWidth:2,fill:"none"}),Ui([20,120],"38",{textAnchor:"middle",dominantBaseline:"central",fontSize:"40px",stroke:"none"})];return Gi([e,t,i,o],"0 0 200 200")}return this._icon}}class _s extends(fs(x)){static layer(){return 0}renderSvg(e={},t=[]){return this.items.map(((i,o)=>{let{type:s,positions:n,color:r,radius:a,size:l,opacity:c,evenColor:u,evenOpacity:d}=this.params(i);if(0===n.length)return[];const p=e.showConflicts&&n.some((e=>t[e]?.oddeven?.includes(o)))?"crimson":"none";if("even"===s){const[e,t]=this.svgCellCenter(n[0]);return Di("oddeven even",Hi([e-l/2,t-l/2],l,l),{index:o,fill:u,strokeWidth:4,stroke:p,opacity:d})}{const[e,t]=this.svgCellCenter(n[0]);return Di("oddeven odd",Bi([e,t],a),{index:o,fill:r,strokeWidth:4,stroke:p,opacity:c})}}))}static itemTemplate(){return{positions:{type:"positions",range:[1,1],label:"cell"},type:{type:"choice",default:"odd",autofocus:!0,choices:{odd:{label:"Odd",template:{radius:{optional:!0,type:"number",range:[0,50],default:40},color:{optional:!0,type:"color",default:"lightgrey"},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1}}},even:{label:"Even",template:{size:{optional:!0,type:"number",range:[0,100],default:70},evenColor:{optional:!0,type:"color",label:"color",default:"lightgrey"},evenOpacity:{optional:!0,type:"number",label:"opacity",range:[0,1],step:.01,default:1}}}}},tip:"Position Odd/Even by selecting a cell, using alt-key to switch odd to even. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[f.CELL]}static icon(){if(!this._icon){const e=new _s({size:9},{items:[{type:"odd",positions:[0],color:"darkgrey"},{type:"even",positions:[10],evenColor:"darkgrey"}]}),t=[Fi("M100,0L100,200M0,100L200,100",{stroke:"black",strokeWidth:2})];this._icon=Gi([...t,...e.renderSvg()],"0 0 200 200")}return this._icon}}class Es extends(fs(C)){static layer(){return 0}renderSvg(e={},t=[]){return this.lines.map(((i,o)=>{let{positions:s,stroke:n,strokeWidth:r,strokeLinejoin:a="round",strokeLinecap:l="round",opacity:c}=this.params(i);if(0===s.length)return[];if(1===s.length)return Di("palindrome",Bi(this.svgCellCenter(s[0]),r/2,{stroke:"none",fill:n}),{index:o,opacity:c});const u=this.svgPathData(s),d=Fi(u,{stroke:"crimson",strokeWidth:2,strokeLinejoin:a,strokeLinecap:l,fill:"none"});return Di("palindrome",[Bi(this.svgCellCenter(s[0]),r/2,{stroke:"none",fill:"none"}),Fi(u,{strokeLinejoin:a,strokeLinecap:l}),e.showConflicts&&s.some((e=>t[e]?.palindrome?.includes(o)))?d:""],{index:o,opacity:c,stroke:n,strokeWidth:r,fill:"none"})}))}static itemTemplate(){return{positions:{type:"positions",range:[2,81],label:"cells"},stroke:{optional:!0,type:"color",default:"lightgrey",label:"color"},strokeWidth:{optional:!0,type:"number",range:[0,25],label:"line width",default:15},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Palindrome by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW]}static icon(){if(!this._icon){const e=new Es({size:9},{items:[{positions:[1,0,10,9],stroke:"darkgrey",strokeWidth:25}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}}class zs extends(fs(S)){static layer(){return 2}renderSvg(e={},t=[]){return this.quadruples.map(((i,o)=>{let{positions:s,values:n,stroke:r,strokeWidth:a,fill:l,radius:c,fontSize:u="18px",opacity:d=1}=this.params(i);if(s.length<4)return[];const p=s.map((e=>this.svgCellCenter(e))),h=m(m(p[0],p[1]),m(p[2],p[3]));r=e.showConflicts&&s.some((e=>t[e]?.quadruple?.includes(o)))?"crimson":r;const f=[Bi(h,c,{fill:l,stroke:r,strokeWidth:a}),Ui(h,n.join(""),{textAnchor:"middle",dominantBaseline:"middle",stroke:"none",fill:r,dy:".1em",fontSize:u})];return Di("quadruple",f,{index:o,opacity:d})}))}static itemTemplate(){return{positions:{type:"positions",range:[3,81],label:"cells"},values:{optional:!0,type:"array",range:[0,4],autofocus:!0,delimiter:"",default:"",pattern:"^(?:\\s*[1-9]){1,4}\\s*$",formatMessage:"Enter 1 to 4 digits."},stroke:{optional:!0,type:"color",default:"black"},strokeWidth:{optional:!0,type:"number",range:[0,25],label:"line width",default:3},fill:{optional:!0,type:"color",default:"white",alpha:!0},radius:{optional:!0,type:"number",range:[0,50],default:23},tip:"Position Quadruple by clicking a grid intersecton. Type value digits, adjust styles below, or just press enter to save."}}static selectionTemplates(){return[f.TWO_BY_TWO]}static icon(){if(!this._icon){const e=Vi("* {font-family: helvetica}"),t=new zs({size:9},{items:[{positions:[0,1,9,10],values:[2,3,5,8],radius:50,fontSize:"38px"}]}).renderSvg(),i=[Fi("M100,0L100,200M0,100L200,100",{stroke:"black",strokeWidth:1})];this._icon=Gi([e,i,t],"0 0 200 200")}return this._icon}}class $s extends(fs(_)){static layer(){return 1}renderSvg(){const t=Ri(this.size),i=e(this.size+2,(e=>{const i=Ri(e),o=0===e?i-2:e===this.size?i+2:i,s=0===e||e===this.size?4:1;return Fi(`M0,${o}L${t},${o}`,{strokeWidth:s})}));return Di("row grid",i,{stroke:"black",strokeLinecap:"square"})}}class Ts extends(fs(E)){static gutter(){return!0}static layer(){return 1}renderSvg(e={},i=[]){return this.sums.map(((o,s)=>{let{positions:n,sum:r,color:a,opacity:l=1}=this.params(o);if(n.length>1){const o=.85,c=t(this.size,n[0]),u=t(this.size,n.slice(-1)[0]),d=c.col+.5+k(u.col-c.col).on((e=>e>0),(e=>-o)).on((e=>e<0),(e=>o)).otherwise((e=>0)),p=c.row+.5+k(u.row-c.row).on((e=>e>0),(e=>-o)).on((e=>e<0),(e=>o)).otherwise((e=>0)),h=Ri(d),f=Ri(p);return a=e.showConflicts&&n.some((e=>i[e]?.sandwichsum?.includes(s)))?"crimson":a,Di("sandwichsum",Ui([h,f],r??"##",{textAnchor:"middle",dominantBaseline:"central",fontSize:"40px",fill:a,stroke:"none"}),{index:s,opacity:l})}return[]}))}static selectionTemplates(){return[w.COLUMN,w.ROW]}static itemTemplate(){return{positions:{type:"positions",range:[2,9],label:"cells"},sum:{type:"number",range:[0,35],autofocus:!0},color:{optional:!0,type:"color",default:"black"},tip:"Position Sandwich Sum by selecting the cell nearest the sum arrow, using alt-key to switch orientation. Type sum digits, adjust styles below, or just press enter to save."}}static icon(){if(!this._icon){const e=Vi("* {font-family: helvetica}"),t=[Fi("M70,70L70,200M70,70L200,70",{stroke:"black",strokeWidth:3}),Fi("M170,70L170,200M70,170L200,170",{stroke:"black",strokeWidth:1})],i=[Ui([35,120],"24",{style:"font-family: helvetica",textAnchor:"middle",dominantBaseline:"central",fontSize:"40px",fill:"black",stroke:"none"}),Ui([120,40],"32",{style:"font-family: helvetica",textAnchor:"middle",dominantBaseline:"central",fontSize:"40px",fill:"black",stroke:"none"})];this._icon=Gi([e,t,i],"0 0 200 200")}return this._icon}}class Os extends(fs(z)){static layer(){return 0}renderSvg(e={},t=[]){const i=[],o=this.thermos.map(((o,s)=>{let{positions:n,color:r,strokeWidth:a,radius:l,opacity:c}=this.params(o);if(!n||0===n.length)return[];const[u,d]=this.svgCellCenter(n[0]),p=n.length>1?this.svgPathData(n,l/100,.125):"",h=[Bi([u,d],l/1.5,{stroke:"crimson",strokeWidth:2,fill:"none"}),Fi(n.length>1?this.svgPathData(n,l/150,.125):"",{stroke:"crimson",strokeWidth:2,strokeLinejoin:"round",strokeLinecap:"round",fill:"none"})];i.push(e.showConflicts&&n.some((e=>t[e]?.thermo?.includes(s)))?h:[]);const f=[Bi([u,d],l,{stroke:"none"}),Fi(p,{strokeLinecap:"round",fill:"none",strokeLinejoin:"round"}),...e.showConflicts&&n.some((e=>t[e]?.thermo?.includes(s)))?h:[]];return Di("thermo",f,{index:s,stroke:r,strokeWidth:a,fill:r,opacity:c})}));return[o,Di("thermoConflicts",i)]}static itemTemplate(){return{positions:{type:"positions",range:[2,9],label:"cells"},color:{optional:!0,type:"color",default:"lightgrey"},radius:{optional:!0,type:"number",range:[0,50],default:30},strokeWidth:{optional:!0,type:"number",range:[0,50],label:"line width",default:15},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Thermo by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW]}static icon(){if(!this._icon){const e=new Os({size:9},{items:[{positions:[1,0,9,10],color:"darkgrey",strokeWidth:30,radius:40}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}}class Is extends(fs($)){static layer(){return 2}renderSvg(e={},t=[]){return this.items?.map(((i,o)=>{let{type:s,positions:n,vColor:r,vFill:a,vRadius:l,xColor:c,xFill:u,xRadius:d,fontSize:p="40px",opacity:h=1}=this.params(i);if(n.length<2)return[];const[f,g]=m(...n.slice(0,2).map((e=>this.svgCellCenter(e))));let[v,b,y]="v"===s?[r,a,l]:[c,u,d];v=e.showConflicts&&n.some((e=>t[e]?.xv?.includes(o)))?"crimson":v;const k=[Bi([f,g],y,{fill:b}),Ui([f,g],s??"x",{fontSize:p,textAnchor:"middle",dominantBaseline:"middle"})];return Di(`xv ${s??"x"}`,k,{index:o,style:`font: ${p} Helvetica`,stroke:"none",fill:v,opacity:h})}))}static constraintTemplate(){return{negativeConstraint:{type:"boolean",label:"Negative constraint"}}}static itemTemplate(){return{positions:{type:"positions",range:[2,2],label:"cells"},type:{type:"choice",default:"x",autofocus:!0,choices:{x:{label:"X",template:{xColor:{optional:!0,label:"color",type:"color",default:"black"},xFill:{optional:!0,label:"fill",type:"color",default:"white",alpha:!0},xRadius:{optional:!0,label:"radius",type:"number",default:16,range:[0,25]}}},v:{label:"V",template:{vColor:{optional:!0,label:"color",type:"color",default:"black"},vFill:{optional:!0,label:"fill",type:"color",default:"white",alpha:!0},vRadius:{optional:!0,label:"radius",type:"number",default:16,range:[0,25]}}}}},tip:"Position XV by clicking on a cell border using alt-key to switch X to V. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[f.DOMINO]}static icon(){if(!this._icon){const e=Vi("font-family: helvetica"),t=new Is({size:9},{items:[{type:"v",vRadius:25,fontSize:"50px",positions:[0,1]},{type:"v",vRadius:26,fontSize:"50px",positions:[10,9]},{type:"x",xRadius:25,fontSize:"50px",positions:[9,0]},{type:"x",xRadius:26,fontSize:"50px",positions:[1,10]}]}),i=[Fi("M100,0L100,200M0,100L200,100",{stroke:"black",strokeWidth:1})];this._icon=Gi([e,i,t.renderSvg()],"0 0 200 200")}return this._icon}}class As extends(fs(T)){static layer(){return 1}renderSvg(e){const t=this.items.map((e=>this.enclosingPaths(e.positions,ji(e.inset??0)))),i=t.map((e=>e.map((e=>e.map(((e,t,i)=>`${0===t?"M":"L"}${e}${t===i.length-1?"Z":""}`)).join("")))));return[...this.items.flatMap(((e,o)=>{let{stroke:s,strokeWidth:n,fill:r,opacity:a}=this.params(e);const l=t[o].map(((e,t)=>{const s=i[o][t];return Fi(s,{fill:r})}));return Di("region grid",l,{index:o,stroke:s,strokeWidth:n,opacity:a})}))]}static itemTemplate(){return{positions:{type:"positions",range:[1,9],label:"cells"},stroke:{optional:!0,type:"color",default:"black"},strokeWidth:{optional:!0,type:"number",range:[0,25],label:"line width",default:4},fill:{optional:!0,type:"color",default:"none",alpha:!0},inset:{optional:!0,type:"number",default:0,range:[-14,14]},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Region by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW,r.BOX_DRAW]}static icon(){if(!this._icon){const e=new As({size:9},{items:[{positions:[1,9,10],strokeWidth:8,inset:5}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}}class Ms extends(fs(O)){static layer(){return 0}renderSvg(e={},t=[]){return this.items.flatMap(((i,o)=>{let{positions:s,stroke:n,strokeWidth:r,fill:a,opacity:l,inset:c=0}=this.params(i);const u=this.enclosingPaths(s,ji(c)).map((e=>e.map(((e,t,i)=>`${0===t?"M":"L"}${e}${t===i.length-1?"Z":""}`)).join("")));return n=e.showConflicts&&s.some((e=>t[e]?.magicsquare?.includes(o)))?"crimson":n,Di("magicsquare",Fi(u),{index:o,stroke:n,strokeWidth:r,fill:a,opacity:l})}))}static itemTemplate(){return{positions:{type:"positions",range:[9],label:"cells"},stroke:{optional:!0,type:"color",default:"none"},strokeWidth:{optional:!0,type:"number",range:[0,25],label:"line width",default:1},fill:{optional:!0,type:"color",default:"#e7e7e7",alpha:!0},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Magic Square by clicking on the center cell. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[f.PUZZLE_SIZE_BLOCK]}static icon(){if(!this._icon){const e="M10,18L190,18M10,78L190,78M10,138L190,138M10,198L190,198M10,18L10,198M70,18L70,198M130,18L130,198M190,18L190,198",t=[Hi([10,18],180,180,{stroke:"none",fill:"lightgrey",cls:"magicsquare"}),Fi(e,{stroke:"black",strokeWidth:2})];this._icon=Gi(t,"0 0 200 200")}return this._icon}}class Ls extends(fs(I)){static layer(){return 0}static label(){return"Min/Max"}renderSvg(e={},i=[]){return this.items.map(((o,s)=>{let{type:n,positions:r,color:a,opacity:l=1,size:c=20,strokeWidth:u=4}=this.params(o);if(0===r.length)return[];const d=A(this.size,o.positions[0]),p=Object.values(M).filter((e=>null!=d[e]));a=e.showConflicts&&r.some((e=>i[e]?.minmax?.includes(s)))?"crimson":a;const h=50-c/2,f=50+c/2,m=2+c/2,g="max"===n?`M${m},${f}L4,50L${m},${h}`:`M4,${f}L${m},50L4,${h}`,{row:v,col:b}=t(this.size,r[0]),y=`translate(${Ri(b)}, ${Ri(v)})`,k={[M.EAST]:Fi(g,{transform:`${y} rotate(180, 50, 50)`}),[M.SOUTH]:Fi(g,{transform:`${y} rotate(270, 50, 50)`}),[M.WEST]:Fi(g,{transform:`${y}`}),[M.NORTH]:Fi(g,{transform:`${y} rotate(90, 50, 50)`})},w=p.filter((e=>!this.items.some((t=>t.type==n&&t.positions?.[0]===d[e])))).map((e=>k[e]));return Di(`minmax ${n??"min"}`,w,{index:s,fill:"none",strokeWidth:u,stroke:a,opacity:l})}))}static itemTemplate(){return{positions:{type:"positions",range:[1,1],label:"cell"},type:{type:"choice",default:"min",autofocus:!0,choices:{min:{label:"Min",template:{color:{optional:!0,type:"color",default:"black"}}},max:{label:"Max",template:{color:{optional:!0,type:"color",default:"black"}}}}},tip:"Position Min/Max by selecting a cell, using alt-key to switch min to max. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[f.CELL]}static icon(){if(!this._icon){const e=new Ls({size:9},{items:[{type:"min",positions:[10],color:"grey",size:35,strokeWidth:10},{type:"max",positions:[20],color:"grey",size:35,strokeWidth:10}]}),t=[Fi("M200,0L200,300M0,200L300,200",{stroke:"black"})];this._icon=Gi([...t,...e.renderSvg()],"100 100 200 200")}return this._icon}}class Ps extends(fs(Object)){constructor(e,{items:t,defaults:i}){super(e,{defaults:i}),this.items=t}renderSvg(e={},t=[]){return this.items.map(((e,t)=>{let{stroke:i,point:o,sizes:s,rotation:n,strokeWidth:r,fill:a,opacity:l,_creating:c,_editing:u}=this.params(e);if(!o||o.length<2||!s||s.length<1)return[];const[d,p]=o.map((e=>Number(e))),[h,f]=s.map((e=>Number(e))),m={index:t,stroke:i,strokeWidth:r,fill:a,opacity:l},g=Hi([d,p],h||.1,(f??h)||.1,{rotation:n});return Di("rectangle "+(c||u?"selected":""),g,m)}))}static layer(){return 0}static label(){return"Rectangle"}static itemTemplate(){return{_snapToGrid:{type:"boolean",label:"snap to grid",default:!0},point:{label:"corner",type:"array",delimiter:", "},sizes:{label:"size",type:"array",delimiter:", "},rotation:{optional:!0,type:"number",default:0,range:[-360,360]},stroke:{optional:!0,type:"color",default:"darkgrey"},strokeWidth:{optional:!0,type:"number",range:[0,400],label:"line width",default:3},fill:{optional:!0,type:"color",default:"none",alpha:!0},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Click or drag Rectangle onto the grid, setting opposing corners and rotation. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[p.CORNER_SIZE]}static icon(){if(!this._icon){const e=new Ps({size:9},{items:[{snapToGrid:!1,point:[5,30],sizes:[120,120],stroke:"black",strokeWidth:12,fill:"lightgrey"}]}),t=new Ps({size:9},{items:[{snapToGrid:!1,point:[75,45],sizes:[80,140],rotation:45,opacity:.7,stroke:"black",strokeWidth:12,fill:"lightgrey"}]}),i=Di("rectangleIcon",[e.renderSvg(),t.renderSvg()]);this._icon=Gi(i,"0 0 200 200")}return this._icon}}class Ns extends(fs(Object)){constructor(e,{items:t,defaults:i}){super(e,{defaults:i}),this.items=t}renderSvg(e={},t=[]){return this.items.map(((e,t)=>{let{stroke:i,points:o,closed:s,strokeWidth:n,fill:r,strokeDasharray:a,opacity:l,_creating:c,_editing:u}=this.params(e);if(!o||o.length<2)return[];const d={index:t,stroke:i,strokeWidth:n,fill:r,opacity:l,strokeLinecap:"round"},p=Fi(o.map(((e,t)=>`${0===t?"M":"L"}${e.join(" ")}`)).join("")+(s?"Z":""),{strokeLinejoin:"round",strokeDasharray:a}),h=Bi(o[0],n/2,{stroke:"none",fill:"none"}),f=Bi(o.slice(-1)[0],n/2,{stroke:"none",fill:"none"});return Di("path "+(c||u?"selected":""),[h,f,p],d)}))}static layer(){return 0}static label(){return"Path"}static itemTemplate(){return{_snapToGrid:{type:"boolean",label:"snap to grid",default:!0},closed:{type:"boolean",default:!1},points:{type:"array",delimiter:["; ",", "]},stroke:{optional:!0,type:"color",default:"darkgrey"},strokeWidth:{optional:!0,type:"number",range:[0,400],label:"line width",default:3},strokeDasharray:{optional:!0,type:"text",default:"0",label:"dash size"},fill:{optional:!0,type:"color",default:"none"},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Click Path points on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[p.PATH]}static icon(){if(!this._icon){const e=new Ns({size:9},{items:[{points:[[90,30],[70,90],[10,90],[60,125],[30,190],[90,150],[150,190],[120,125],[170,90],[110,90]],closed:!0,opacity:.7,stroke:"black",strokeWidth:10,fill:"lightgrey"}]}),t=Di("ellipseIcon",[e.renderSvg()]);this._icon=Gi(t,"0 0 200 200")}return this._icon}}class Rs extends(fs(Object)){constructor(e,{items:t,defaults:i}){super(e,{defaults:i}),this.items=t}renderSvg(e={},t=[]){return this.items?.map(((e,t)=>{if(e.point){const{size:i,color:o,opacity:s,rotation:n,text:r}=this.params(e),a=n?`rotate(${n} ${e.point.join(" ")})`:void 0;return Di("text",[Ui(e.point,r,{fontSize:i+"px",textAnchor:"middle",dominantBaseline:"central",fill:o,transform:a})],{opacity:s,index:t})}}))}static layer(){return 0}static label(){return"Text"}static itemTemplate(){return{_snapToGrid:{type:"boolean",label:"snap to grid",default:!0},point:{label:"center",type:"array",delimiter:", "},text:{type:"text",default:"text",autofocus:!0},size:{label:"size",type:"number",default:"40"},rotation:{optional:!0,type:"number",default:0,range:[-360,360]},color:{optional:!0,type:"color",default:"black"},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Text by clicking on the grid setting the text center and rotation. Enter text, adjust styles, or just press enter to save."}}static selectionTemplates(){return[p.CENTER_SIZE]}static icon(){if(!this._icon){const e=new Rs({size:9},{items:[{snapToGrid:!1,text:"TEXT",point:[100,120],size:80,fill:"black"}]}),t=Di("textIcon",[e.renderSvg()],{style:"font-family: helvetica"});this._icon=Gi(t,"0 0 200 200")}return this._icon}}class js extends(fs(L)){static layer(){return 0}renderSvg(e={},t=[]){return this.items.map(((i,o)=>{let{positions:s,color:n,strokeWidth:r,opacity:a}=this.params(i);if(!s||0===s.length)return[];if(1===s.length)return Di("renban",Bi(this.svgCellCenter(s[0]),r/2,{stroke:"none",fill:n}),{index:o,opacity:a});const l=s.length>1?this.svgPathData(s,.125,.125):"",c=[Fi(l,{stroke:"crimson",strokeWidth:2,strokeLinejoin:"round",strokeLinecap:"round",fill:"none"})];return Di("renban",[Bi(this.svgCellCenter(s[0]),r/2,{stroke:"none",fill:"none"}),Fi(l,{strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),...e.showConflicts&&s.some((e=>t[e]?.renban?.includes(o)))?c:[]],{index:o,stroke:n,strokeWidth:r,fill:n,opacity:a})}))}static itemTemplate(){return{positions:{type:"positions",range:[2,9],label:"cells"},color:{optional:!0,type:"color",default:"darkgrey"},strokeWidth:{optional:!0,type:"number",range:[0,50],label:"line width",default:10},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position Renban Line by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW]}static icon(){if(!this._icon){const e=new js({size:9},{items:[{positions:[9,0,1,10],color:"darkgrey",strokeWidth:20}]});this._icon=Gi(e.renderSvg(),"0 0 200 200")}return this._icon}}class Ds extends(fs(P)){static layer(){return 0}renderSvg(e={},t=[]){return this.items.map(((i,o)=>{let{positions:s,color:n,strokeWidth:r,opacity:a}=this.params(i);if(!s||0===s.length)return[];if(1===s.length)return Di("whispers",Bi(this.svgCellCenter(s[0]),r/2,{stroke:"none",fill:n}),{index:o,opacity:a});const l=s.length>1?this.svgPathData(s,.1,.1):"",c=[Fi(l,{stroke:"crimson",strokeWidth:2,strokeLinejoin:"round",strokeLinecap:"round",fill:"none"})];return Di("whispers",[Bi(this.svgCellCenter(s[0]),r/2,{stroke:"none",fill:"none"}),Fi(l,{strokeLinecap:"round",fill:"none",strokeLinejoin:"round"}),...e.showConflicts&&s.some((e=>t[e]?.whispers?.includes(o)))?c:[]],{index:o,stroke:n,strokeWidth:r,fill:n,opacity:a})}))}static itemTemplate(){return{positions:{type:"positions",range:[2,9],label:"cells"},color:{optional:!0,type:"color",default:"lightgrey"},strokeWidth:{optional:!0,type:"number",range:[0,50],label:"line width",default:10},opacity:{optional:!0,type:"number",range:[0,1],step:.01,default:1},tip:"Position German Whispers Line by clicking or dragging on the grid. Adjust styles below or just press enter to save."}}static selectionTemplates(){return[r.LINE_DRAW]}static icon(){if(!this._icon){const e=new Ds({size:9},{items:[{positions:[2,1,0,9,18,19,20,11,10],color:"darkgrey",strokeWidth:30}]});this._icon=Gi(e.renderSvg(),"0 0 300 300")}return this._icon}}const Us=new Map([["arrow",ms],["betweenline",gs],["box",vs],["column",bs],["diagonal",ys],["ellipse",ks],["gutter",R],["inequality",ws],["killercage",xs],["kropki",Cs],["littlekiller",Ss],["magicsquare",Ms],["minmax",Ls],["oddeven",_s],["palindrome",Es],["path",Ns],["quadruple",zs],["renban",js],["rectangle",Ps],["region",As],["row",$s],["sandwichsum",Ts],["text",Rs],["thermo",Os],["whispers",Ds],["xv",Is]]),Fs={corners:new Map([["arrow","arrow"],["between","betweenline"],["min/max","minmax"],["odd/even","oddeven"],["palindrome","palindrome"],["renban","renban"],["thermo","thermo"],["whispers","whispers"]]),centers:new Map([["inequality","inequality"],["killer cage","killercage"],["kropki","kropki"],["little killer","littlekiller"],["magic²","magicsquare"],["quadruple","quadruple"],["region","region"],["sandwich","sandwichsum"],["xv","xv"]]),colors:new Map([["ellipse","ellipse"],["rectangle","rectangle"],["path","path"],["text","text"]])},Hs=e=>Object.fromEntries(Object.keys(e.constraints).map((e=>[e,Us.get(e)])).filter((([,e])=>!!e))),Bs=e=>{const t=Li([e],(e=>e.size)),i=Li([e],(e=>e.featureName)),o=Li([e],(e=>{const t=Object.fromEntries(Object.entries(j(e)).filter((([e])=>!["row","column","gutter"].includes(e))).map((([e,t])=>[e,t.rules])));return e.rules?{fpuzzles:e.rules}:t})),s=Li([e],(e=>{const t=j(e);return Object.fromEntries(Object.entries(D(e)).filter((([e])=>!["row","column","gutter"].includes(e))).map((([e,i])=>[e,i.rules(t[e])])))})),n=Li([e],(e=>Object.fromEntries(Object.entries(D(e)).map((([e,t])=>[e,t.label?.()??""]))))),r=Li([e],(e=>Object.values(Hs(e)).some((e=>e.gutter)))),a=Li([i],(e=>Us.get(e)?.itemTemplate())),l=Li([i,e],((e,t)=>t.constraints[e]?.items?.find((e=>e._editing||e._creating)))),c=Li([i,e],((e,t)=>t.constraints[e]?.items.findIndex((e=>e._editing||e._creating)))),u=Li([e],(e=>e.featureItemSelectionTemplate)),d=Li([e],(e=>e.highlightFeatureName)),p=Li([e],(e=>e.highlightFeatureItemIndex)),h=Li([e],(e=>e.revertItem)),f=Li([e],(e=>e.givens)),m=Li([e],(e=>e.constraints)),g=Li([m,i],((e,t)=>e[t])),v=Li([e],(e=>e.puzzleIteration)),b=Li([e],(e=>e.solutionSteps));return{puzzle:e,size:t,units:Li([e],(e=>U(e,(({units:e})=>e)))),featureName:i,rules:o,defaultRules:s,gutter:r,featureTemplate:a,featureItem:l,featureItemIndex:c,featureItemSelectionTemplate:u,highlightFeatureName:d,highlightFeatureItemIndex:p,revertItem:h,givens:f,constraints:m,feature:g,puzzleIteration:v,solutionSteps:b,labels:n}},Ws=Bs((e=>e.game.present.puzzle)),Vs=((t,i)=>{const o=i.puzzle,s=Li([t.values,i.givens],((e,t)=>e.map(((e,i)=>t[i]||e)))),n=Li([o,s],((t,i)=>{const o=e(i.length,(e=>[]));return F(t,((e,t)=>{e.conflicts(i).forEach((([e,i])=>{null!=e&&i.forEach((i=>{o[i][t]=o[i][t]??[],o[i][t].push(e)}))}))})),o})),r=Li([o],(t=>H(t,((e,t)=>{const i=t.peers;return i.length?e.map(((e,t)=>[...new Set([...e,...i[t]])])):e}),e(t.size**2,(e=>[]))))),a=Li([r,s],((e,t)=>t.map(((i,o)=>[...new Set(e[o].filter((e=>0!==i&&t[e]===i)))])))),l=Li([o,n,a],((e,t,i)=>{const o=U(e,(({peers:e})=>e)),s=t.reduce(((e,t,i)=>Object.entries(t).reduce(((e,[t,o])=>(t in e||(e[t]=[]),e[t].push(i),e)),e)),{});return i.reduce(((e,t,i)=>{for(const s in o){const n=o[s][i];n&&t.some((e=>n.includes(e)))&&(s in e||(e[s]=[]),e[s].push(i))}return e}),s)})),c=Li([o,s,r,t.userCandidates],((t,i,o,s)=>{let n=e(t.size**2,(e=>"123456789"));for(i.forEach(((e,t)=>{0!==e&&(n[t]=`${e}`,o[t].forEach((t=>{n[t]=n[t].replace(e,"")})))}));;){const e=n.join("");if(F(t,(e=>n=e.clearCandidates(i,n,o))),e===n.join("")||n.some((e=>""===e)))break}return n})),u=Li([c,t.userCandidates],((e,t)=>e.map(((e,i)=>e.replace(new RegExp(`[^${t[i]}]`,"g"),""))))),d=Li([o,s],((e,t)=>{const i=e.size**2,o=U(e,(e=>e.units)),s=e=>{const i={value:t[e],index:~~e};for(const[t,s]of Object.entries(o)){const o=s.findIndex((t=>t.includes(~~e)));-1!==o&&(i[t]=o)}return i};return new Proxy([],{get:(e,t)=>{if(t===Symbol.iterator||"values"===t){let e=0;return t=>({next:t=>e<i?{done:!1,value:s(e++)}:{done:!0}})}if("entries"===t){let e=0;return t=>({next:t=>e<i?{done:!1,value:[e,s(e++)]}:{done:!0}})}return"length"===t?i:"symbol"!=typeof t&&Number(t)!==Number.NaN&&t<i?s(t):"map"===t?t=>{const o=[];for(let n=0;n<i;++n)o[n]=t(s(n),n,e);return o}:"reduce"===t?(t,o)=>{let n=o??s(0);for(let r=o?0:1;r<i;++r)n=t(n,s(r),r,e);return n}:Reflect.get(e,t)},ownKeys:e=>["length",...Array.from({length:i},((e,t)=>`${t}`))],getOwnPropertyDescriptor:(t,o)=>"length"===o?{writable:!0,configurable:!1,enumerable:!1,value:i}:Number(o)<e.size?{writable:!0,configurable:!0,enumerable:!0,value:s(o)}:void 0})})),p=Li([s,i.size],((e,t)=>t**2-e.filter((e=>0!==e)).length));return{values:s,cells:d,peers:r,duplicates:a,conflicts:n,duplicatesByConstraint:l,candidates:c,displayedCandidates:u,unfilledCellCount:p}})(Pi,Ws),Gs=(e=>{const t=Li([e],(e=>e.count));t.iteration=Li([t],(e=>e.iteration)),t.cancelIteration=Li([t],(e=>e.cancelIteration));const i=Li([t],(e=>e.stats));Object.values(B).forEach((e=>i[e]=Li([i],(t=>t[e])))),t.stats=i,t.index=Li([t],(e=>e.index)),t.endTime=Li([t],(e=>e.endTime)),t.startTime=Li([t],(e=>e.startTime)),t.requirementCount=Li([t],(e=>e.requirementCount)),t.restrictionCount=Li([t],(e=>e.restrictionCount)),t.optionCount=Li([t],(e=>e.optionCount)),t.requestDownloadIteration=Li([t],(e=>e.requestDownloadIteration)),t.idle=Li([i],(e=>e.status===W)),t.counting=Li([i],(e=>e.status===V)),t.abandoned=Li([i],(e=>e.status===G)),t.cancelled=Li([i],(e=>e.status===q)),t.exhausted=Li([i],(e=>e.status===K)),t.completed=Li([i],(e=>e.status===Y));const o=Li([e],(e=>e.showingSolutionType)),s=Li([e],(e=>e.logical));return s.steps=Li([s],(e=>e.steps)),s.stepCount=Li([s.steps],(e=>e.length)),s.step=Li([s],(e=>e.step)),s.substep=Li([s],(e=>e.substep)),s.iteration=Li([s],(e=>e.iteration)),s.cancelIteration=Li([s],(e=>e.cancelIteration)),s.highlightedPositions=Li([s],(e=>e.highlightedPositions)),s.impactedPositions=Li([s],(e=>e.impactedPositions)),s.solving=Li([s],(e=>e.iteration>0&&(0===e.steps.length||![Z,J,X].includes(e.steps[e.steps.length-1].type)))),{solution:e,showingSolutionType:o,solutionCount:t,logical:s}})((e=>e.solution)),qs=(e=>{const t=Li([e],(e=>e.cursor)),i=Li([e],(e=>e.selectingCells)),o=Li([e],(e=>e.selectedCells)),s=Li([e],(e=>e.tentativelySelectedCells)),n=Li([e],(e=>e.highlightedConflicts)),r=Li([e],(e=>e.mode)),a=Li([e],(e=>e.keyMode)),l=Li([e],(e=>e.startTime)),c=Li([e],(e=>e.paused)),u=Li([e],(e=>e.pauseTime)),d=Li([e],(e=>e.stopped)),p=Li([e],(e=>e.stopTime)),h=Li([e],(e=>e.recentColors)),f=Li([e],(e=>e.palette)),m=Li([e],(e=>e.nextPalette)),g=Li([e],(e=>e.prevPalette)),v=Li([e],(e=>e.settings));return{ui:e,options:Li([v],(({autoCandidates:e,autoCheck:t,autoClearMarks:i,autoSolve:o,dimColors:s,hideEditTips:n,hideTimer:r,outlineSelection:a,shadePeers:l,showConflicts:c,staticCorners:u})=>({autoCandidates:e,autoCheck:t,autoClearMarks:i,autoSolve:o,dimColors:s,hideEditTips:n,hideTimer:r,outlineSelection:a,shadePeers:l,showConflicts:c,staticCorners:u}))),cursor:t,selectingCells:i,selectedCells:o,tentativelySelectedCells:s,highlightedConflicts:n,mode:r,keyMode:a,startTime:l,paused:c,pauseTime:u,stopped:d,stopTime:p,recentColors:h,settings:v,notifications:Li([e],(e=>e.notifications)),cellSetValues:Li([e],(e=>e.cellSetValues)),palette:f,nextPalette:m,prevPalette:g}})((e=>e.ui)),Ks=((e,t,i,o,s)=>{t.grid;const n=o.solution,r=i.puzzle;s.ui;const a=Li([e.candidates,e.values,e.peers,r,n],((e,t,i,o,s)=>{const n=s.logical.steps,r=s.logical.step,a=s.logical.substep;if(t=Q(t),e=Q(e),i=Q(i),n.length>r){for(let s=0;s<r;s++)[Z,J].includes(n[s].type)||ee(n[s],t,e,i,o,(e=>{}));if(n[r].steps?.length>=a)for(let s=0;s<a;s++)ee(n[r].steps[s],t,e,i,o,(e=>{}))}return{values:t,candidates:e}})),l=Li([a],(e=>e.values)),c=Li([a],(e=>e.candidates)),u=Li([i.featureItem,i.size,s.settings],((e,t,i)=>e?.positions?.map((e=>te(t,e,"rncn"===i.cellNameStyle))))),d=(e,t,i,o)=>{let s;i.forEach(((i,o)=>{0!==i&&e[o].forEach((e=>{t[e]=t[e].replace(i,"")}))}));do{s=t.join(""),F(o,(o=>o.clearCandidates(i,t,e)))}while(t.every((e=>e.length))&&s!==t.join(""));return t};return{logicalSolutionStep:a,logicalSolutionCandidates:c,logicalSolutionValues:l,featureCellNames:u,cornerMarks:Li([e.peers,t.cornerMarks,e.values,r,s.options],((e,t,i,o,s)=>s.autoClearMarks?d(e,t.slice(),i,o):t)),centerMarks:Li([e.peers,t.centerMarks,e.values,r,s.options],((e,t,i,o,s)=>s.autoClearMarks?d(e,t.slice(),i,o):t))}})(Vs,Pi,Ws,Gs,qs);var Ys=ie((function(e,t){
/*!
      localForage -- Offline Storage, Improved
      Version 1.10.0
      https://localforage.github.io/localForage
      (c) 2013-2017 Mozilla, Apache License 2.0
  */
e.exports=function e(t,i,o){function s(r,a){if(!i[r]){if(!t[r]){var l="function"==typeof se&&se;if(!a&&l)return l(r,!0);if(n)return n(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[r]={exports:{}};t[r][0].call(u.exports,(function(e){return s(t[r][1][e]||e)}),u,u.exports,e,t,i,o)}return i[r].exports}for(var n="function"==typeof se&&se,r=0;r<o.length;r++)s(o[r]);return s}({1:[function(e,t,i){(function(e){var i,o,s=e.MutationObserver||e.WebKitMutationObserver;if(s){var n=0,r=new s(u),a=e.document.createTextNode("");r.observe(a,{characterData:!0}),i=function(){a.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,i=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;o=!0;for(var i=c.length;i;){for(t=c,c=[],e=-1;++e<i;)t[e]();i=c.length}o=!1}t.exports=function(e){1!==c.push(e)||o||i()}}).call(this,void 0!==oe?oe:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){var o=e(1);function s(){}var n={},r=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==s&&h(this,e)}function u(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){o((function(){var o;try{o=t(i)}catch(t){return n.reject(e,t)}o===e?n.reject(e,new TypeError("Cannot resolve promise with itself")):n.resolve(e,o)}))}function p(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var i=!1;function o(t){i||(i=!0,n.reject(e,t))}function s(t){i||(i=!0,n.resolve(e,t))}var r=f((function(){t(s,o)}));"error"===r.status&&o(r.value)}function f(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===r)return this;var i=new this.constructor(s);return this.state!==l?d(i,this.state===a?e:t,this.outcome):this.queue.push(new u(i,e,t)),i},u.prototype.callFulfilled=function(e){n.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){n.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},n.resolve=function(e,t){var i=f(p,t);if("error"===i.status)return n.reject(e,i.value);var o=i.value;if(o)h(e,o);else{e.state=a,e.outcome=t;for(var s=-1,r=e.queue.length;++s<r;)e.queue[s].callFulfilled(t)}return e},n.reject=function(e,t){e.state=r,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:n.resolve(new this(s),e)},c.reject=function(e){var t=new this(s);return n.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var r=new Array(i),a=0,l=-1,c=new this(s);++l<i;)u(e[l],l);return c;function u(e,s){t.resolve(e).then((function(e){r[s]=e,++a!==i||o||(o=!0,n.resolve(c,r))}),(function(e){o||(o=!0,n.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,o=!1;if(!i)return this.resolve([]);for(var r=-1,a=new this(s);++r<i;)l(e[r]);return a;function l(e){t.resolve(e).then((function(e){o||(o=!0,n.resolve(a,e))}),(function(e){o||(o=!0,n.reject(a,e))}))}}},{1:1}],3:[function(e,t,i){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==oe?oe:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,i){var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(s){if("TypeError"!==s.name)throw s;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),o=0;o<e.length;o+=1)i.append(e[o]);return i.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var r=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function l(e,t,i){"function"==typeof t&&e.then(t),"function"==typeof i&&e.catch(i)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d="local-forage-detect-blob-support",p=void 0,h={},f=Object.prototype.toString,m="readonly",g="readwrite";function v(e){for(var t=e.length,i=new ArrayBuffer(t),o=new Uint8Array(i),s=0;s<t;s++)o[s]=e.charCodeAt(s);return i}function b(e){var t=h[e.name],i={};i.promise=new r((function(e,t){i.resolve=e,i.reject=t})),t.deferredOperations.push(i),t.dbReady?t.dbReady=t.dbReady.then((function(){return i.promise})):t.dbReady=i.promise}function y(e){var t=h[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function k(e,t){var i=h[e.name].deferredOperations.pop();if(i)return i.reject(t),i.promise}function w(e,t){return new r((function(i,o){if(h[e.name]=h[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return i(e.db);b(e),e.db.close()}var n=[e.name];t&&n.push(e.version);var r=s.open.apply(s,n);t&&(r.onupgradeneeded=function(t){var i=r.result;try{i.createObjectStore(e.storeName),t.oldVersion<=1&&i.createObjectStore(d)}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),r.onerror=function(e){e.preventDefault(),o(r.error)},r.onsuccess=function(){var t=r.result;t.onversionchange=function(e){e.target.close()},i(t),y(e)}}))}function x(e){return w(e,!1)}function C(e){return w(e,!0)}function S(e,t){if(!e.db)return!0;var i=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,s=e.version>e.db.version;if(o&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),s||i){if(i){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function _(e){return n([v(atob(e.data))],{type:e.type})}function E(e){return e&&e.__local_forage_encoded_blob}function z(e){var t=this,i=t._initReady().then((function(){var e=h[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return l(i,e,e),i}function $(e,t,i,o){void 0===o&&(o=1);try{var s=e.db.transaction(e.storeName,t);i(null,s)}catch(s){if(o>0&&(!e.db||"InvalidStateError"===s.name||"NotFoundError"===s.name))return r.resolve().then((function(){if(!e.db||"NotFoundError"===s.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),C(e)})).then((function(){return function(e){b(e);for(var t=h[e.name],i=t.forages,o=0;o<i.length;o++){var s=i[o];s._dbInfo.db&&(s._dbInfo.db.close(),s._dbInfo.db=null)}return e.db=null,x(e).then((function(t){return e.db=t,S(e)?C(e):t})).then((function(o){e.db=t.db=o;for(var s=0;s<i.length;s++)i[s]._dbInfo.db=o})).catch((function(t){throw k(e,t),t}))}(e).then((function(){$(e,t,i,o-1)}))})).catch(i);i(s)}}var T={_driver:"asyncStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var o in e)i[o]=e[o];var s=h[i.name];s||(s={forages:[],db:null,dbReady:null,deferredOperations:[]},h[i.name]=s),s.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=z);var n=[];function a(){return r.resolve()}for(var l=0;l<s.forages.length;l++){var c=s.forages[l];c!==t&&n.push(c._initReady().catch(a))}var u=s.forages.slice(0);return r.all(n).then((function(){return i.db=s.db,x(i)})).then((function(e){return i.db=e,S(i,t._defaultConfig.version)?C(i):e})).then((function(e){i.db=s.db=e,t._dbInfo=i;for(var o=0;o<u.length;o++){var n=u[o];n!==t&&(n._dbInfo.db=i.db,n._dbInfo.version=i.version)}}))},_support:function(){try{if(!s||!s.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var i=this,o=new r((function(t,o){i.ready().then((function(){$(i._dbInfo,m,(function(s,n){if(s)return o(s);try{var r=n.objectStore(i._dbInfo.storeName).openCursor(),a=1;r.onsuccess=function(){var i=r.result;if(i){var o=i.value;E(o)&&(o=_(o));var s=e(o,i.key,a++);void 0!==s?t(s):i.continue()}else t()},r.onerror=function(){o(r.error)}}catch(e){o(e)}}))})).catch(o)}));return a(o,t),o},getItem:function(e,t){var i=this;e=c(e);var o=new r((function(t,o){i.ready().then((function(){$(i._dbInfo,m,(function(s,n){if(s)return o(s);try{var r=n.objectStore(i._dbInfo.storeName).get(e);r.onsuccess=function(){var e=r.result;void 0===e&&(e=null),E(e)&&(e=_(e)),t(e)},r.onerror=function(){o(r.error)}}catch(e){o(e)}}))})).catch(o)}));return a(o,t),o},setItem:function(e,t,i){var o=this;e=c(e);var s=new r((function(i,s){var a;o.ready().then((function(){return a=o._dbInfo,"[object Blob]"===f.call(t)?function(e){return"boolean"==typeof p?r.resolve(p):function(e){return new r((function(t){var i=e.transaction(d,g),o=n([""]);i.objectStore(d).put(o,"key"),i.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},i.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);t(i||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return p=e}))}(a.db).then((function(e){return e?t:function(e){return new r((function(t,i){var o=new FileReader;o.onerror=i,o.onloadend=function(i){var o=btoa(i.target.result||"");t({__local_forage_encoded_blob:!0,data:o,type:e.type})},o.readAsBinaryString(e)}))}(t)})):t})).then((function(t){$(o._dbInfo,g,(function(n,r){if(n)return s(n);try{var a=r.objectStore(o._dbInfo.storeName);null===t&&(t=void 0);var l=a.put(t,e);r.oncomplete=function(){void 0===t&&(t=null),i(t)},r.onabort=r.onerror=function(){var e=l.error?l.error:l.transaction.error;s(e)}}catch(e){s(e)}}))})).catch(s)}));return a(s,i),s},removeItem:function(e,t){var i=this;e=c(e);var o=new r((function(t,o){i.ready().then((function(){$(i._dbInfo,g,(function(s,n){if(s)return o(s);try{var r=n.objectStore(i._dbInfo.storeName).delete(e);n.oncomplete=function(){t()},n.onerror=function(){o(r.error)},n.onabort=function(){var e=r.error?r.error:r.transaction.error;o(e)}}catch(e){o(e)}}))})).catch(o)}));return a(o,t),o},clear:function(e){var t=this,i=new r((function(e,i){t.ready().then((function(){$(t._dbInfo,g,(function(o,s){if(o)return i(o);try{var n=s.objectStore(t._dbInfo.storeName).clear();s.oncomplete=function(){e()},s.onabort=s.onerror=function(){var e=n.error?n.error:n.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new r((function(e,i){t.ready().then((function(){$(t._dbInfo,m,(function(o,s){if(o)return i(o);try{var n=s.objectStore(t._dbInfo.storeName).count();n.onsuccess=function(){e(n.result)},n.onerror=function(){i(n.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,o=new r((function(t,o){e<0?t(null):i.ready().then((function(){$(i._dbInfo,m,(function(s,n){if(s)return o(s);try{var r=n.objectStore(i._dbInfo.storeName),a=!1,l=r.openKeyCursor();l.onsuccess=function(){var i=l.result;i?0===e||a?t(i.key):(a=!0,i.advance(e)):t(null)},l.onerror=function(){o(l.error)}}catch(e){o(e)}}))})).catch(o)}));return a(o,t),o},keys:function(e){var t=this,i=new r((function(e,i){t.ready().then((function(){$(t._dbInfo,m,(function(o,s){if(o)return i(o);try{var n=s.objectStore(t._dbInfo.storeName).openKeyCursor(),r=[];n.onsuccess=function(){var t=n.result;t?(r.push(t.key),t.continue()):e(r)},n.onerror=function(){i(n.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,e),i},dropInstance:function(e,t){t=u.apply(this,arguments);var i=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||i.name,e.storeName=e.storeName||i.storeName);var o,n=this;if(e.name){var l=e.name===i.name&&n._dbInfo.db?r.resolve(n._dbInfo.db):x(e).then((function(t){var i=h[e.name],o=i.forages;i.db=t;for(var s=0;s<o.length;s++)o[s]._dbInfo.db=t;return t}));o=e.storeName?l.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var i=t.version+1;b(e);var o=h[e.name],n=o.forages;t.close();for(var a=0;a<n.length;a++){var l=n[a];l._dbInfo.db=null,l._dbInfo.version=i}return new r((function(t,o){var n=s.open(e.name,i);n.onerror=function(e){n.result.close(),o(e)},n.onupgradeneeded=function(){n.result.deleteObjectStore(e.storeName)},n.onsuccess=function(){var e=n.result;e.close(),t(e)}})).then((function(e){o.db=e;for(var t=0;t<n.length;t++){var i=n[t];i._dbInfo.db=e,y(i._dbInfo)}})).catch((function(t){throw(k(e,t)||r.resolve()).catch((function(){})),t}))}})):l.then((function(t){b(e);var i=h[e.name],o=i.forages;t.close();for(var n=0;n<o.length;n++)o[n]._dbInfo.db=null;return new r((function(t,i){var o=s.deleteDatabase(e.name);o.onerror=function(){var e=o.result;e&&e.close(),i(o.error)},o.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},o.onsuccess=function(){var e=o.result;e&&e.close(),t(e)}})).then((function(e){i.db=e;for(var t=0;t<o.length;t++)y(o[t]._dbInfo)})).catch((function(t){throw(k(e,t)||r.resolve()).catch((function(){})),t}))}))}else o=r.reject("Invalid arguments");return a(o,t),o}},O="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=/^~~local_forage_type~([^~]+)~/,A="__lfsc__:",M=A.length,L="arbf",P="blob",N="si08",R="ui08",j="uic8",D="si16",U="si32",F="ur16",H="ui32",B="fl32",W="fl64",V=M+L.length,G=Object.prototype.toString;function q(e){var t,i,o,s,n,r=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(r--,"="===e[e.length-2]&&r--);var c=new ArrayBuffer(r),u=new Uint8Array(c);for(t=0;t<a;t+=4)i=O.indexOf(e[t]),o=O.indexOf(e[t+1]),s=O.indexOf(e[t+2]),n=O.indexOf(e[t+3]),u[l++]=i<<2|o>>4,u[l++]=(15&o)<<4|s>>2,u[l++]=(3&s)<<6|63&n;return c}function K(e){var t,i=new Uint8Array(e),o="";for(t=0;t<i.length;t+=3)o+=O[i[t]>>2],o+=O[(3&i[t])<<4|i[t+1]>>4],o+=O[(15&i[t+1])<<2|i[t+2]>>6],o+=O[63&i[t+2]];return i.length%3==2?o=o.substring(0,o.length-1)+"=":i.length%3==1&&(o=o.substring(0,o.length-2)+"=="),o}var Y={serialize:function(e,t){var i="";if(e&&(i=G.call(e)),e&&("[object ArrayBuffer]"===i||e.buffer&&"[object ArrayBuffer]"===G.call(e.buffer))){var o,s=A;e instanceof ArrayBuffer?(o=e,s+=L):(o=e.buffer,"[object Int8Array]"===i?s+=N:"[object Uint8Array]"===i?s+=R:"[object Uint8ClampedArray]"===i?s+=j:"[object Int16Array]"===i?s+=D:"[object Uint16Array]"===i?s+=F:"[object Int32Array]"===i?s+=U:"[object Uint32Array]"===i?s+=H:"[object Float32Array]"===i?s+=B:"[object Float64Array]"===i?s+=W:t(new Error("Failed to get type for BinaryArray"))),t(s+K(o))}else if("[object Blob]"===i){var n=new FileReader;n.onload=function(){var i="~~local_forage_type~"+e.type+"~"+K(this.result);t(A+P+i)},n.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),t(null,i)}},deserialize:function(e){if(e.substring(0,M)!==A)return JSON.parse(e);var t,i=e.substring(V),o=e.substring(M,V);if(o===P&&I.test(i)){var s=i.match(I);t=s[1],i=i.substring(s[0].length)}var r=q(i);switch(o){case L:return r;case P:return n([r],{type:t});case N:return new Int8Array(r);case R:return new Uint8Array(r);case j:return new Uint8ClampedArray(r);case D:return new Int16Array(r);case F:return new Uint16Array(r);case U:return new Int32Array(r);case H:return new Uint32Array(r);case B:return new Float32Array(r);case W:return new Float64Array(r);default:throw new Error("Unkown type: "+o)}},stringToBuffer:q,bufferToString:K};function Z(e,t,i,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],i,o)}function J(e,t,i,o,s,n){e.executeSql(i,o,s,(function(e,r){r.code===r.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?n(e,r):Z(e,t,(function(){e.executeSql(i,o,s,n)}),n)}),n):n(e,r)}),n)}function X(e,t,i,o){var s=this;e=c(e);var n=new r((function(n,r){s.ready().then((function(){void 0===t&&(t=null);var a=t,l=s._dbInfo;l.serializer.serialize(t,(function(t,c){c?r(c):l.db.transaction((function(i){J(i,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){n(a)}),(function(e,t){r(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(o>0)return void n(X.apply(s,[e,a,i,o-1]));r(t)}}))}))})).catch(r)}));return a(n,i),n}function Q(e){return new r((function(t,i){e.transaction((function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(i,o){for(var s=[],n=0;n<o.rows.length;n++)s.push(o.rows.item(n).name);t({db:e,storeNames:s})}),(function(e,t){i(t)}))}),(function(e){i(e)}))}))}var ee={_driver:"webSQLStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var o in e)i[o]="string"!=typeof e[o]?e[o].toString():e[o];var s=new r((function(e,o){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return o(e)}i.db.transaction((function(s){Z(s,i,(function(){t._dbInfo=i,e()}),(function(e,t){o(t)}))}),o)}));return i.serializer=Y,s},_support:"function"==typeof openDatabase,iterate:function(e,t){var i=this,o=new r((function(t,o){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){J(i,s,"SELECT * FROM "+s.storeName,[],(function(i,o){for(var n=o.rows,r=n.length,a=0;a<r;a++){var l=n.item(a),c=l.value;if(c&&(c=s.serializer.deserialize(c)),void 0!==(c=e(c,l.key,a+1)))return void t(c)}t()}),(function(e,t){o(t)}))}))})).catch(o)}));return a(o,t),o},getItem:function(e,t){var i=this;e=c(e);var o=new r((function(t,o){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){J(i,s,"SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,i){var o=i.rows.length?i.rows.item(0).value:null;o&&(o=s.serializer.deserialize(o)),t(o)}),(function(e,t){o(t)}))}))})).catch(o)}));return a(o,t),o},setItem:function(e,t,i){return X.apply(this,[e,t,i,1])},removeItem:function(e,t){var i=this;e=c(e);var o=new r((function(t,o){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){J(i,s,"DELETE FROM "+s.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){o(t)}))}))})).catch(o)}));return a(o,t),o},clear:function(e){var t=this,i=new r((function(e,i){t.ready().then((function(){var o=t._dbInfo;o.db.transaction((function(t){J(t,o,"DELETE FROM "+o.storeName,[],(function(){e()}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new r((function(e,i){t.ready().then((function(){var o=t._dbInfo;o.db.transaction((function(t){J(t,o,"SELECT COUNT(key) as c FROM "+o.storeName,[],(function(t,i){var o=i.rows.item(0).c;e(o)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,o=new r((function(t,o){i.ready().then((function(){var s=i._dbInfo;s.db.transaction((function(i){J(i,s,"SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,i){var o=i.rows.length?i.rows.item(0).key:null;t(o)}),(function(e,t){o(t)}))}))})).catch(o)}));return a(o,t),o},keys:function(e){var t=this,i=new r((function(e,i){t.ready().then((function(){var o=t._dbInfo;o.db.transaction((function(t){J(t,o,"SELECT key FROM "+o.storeName,[],(function(t,i){for(var o=[],s=0;s<i.rows.length;s++)o.push(i.rows.item(s).key);e(o)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},dropInstance:function(e,t){t=u.apply(this,arguments);var i=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||i.name,e.storeName=e.storeName||i.storeName);var o,s=this;return o=e.name?new r((function(t){var o;o=e.name===i.name?s._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:o,storeNames:[e.storeName]}):t(Q(o))})).then((function(e){return new r((function(t,i){e.db.transaction((function(o){function s(e){return new r((function(t,i){o.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){i(t)}))}))}for(var n=[],a=0,l=e.storeNames.length;a<l;a++)n.push(s(e.storeNames[a]));r.all(n).then((function(){t()})).catch((function(e){i(e)}))}),(function(e){i(e)}))}))})):r.reject("Invalid arguments"),a(o,t),o}};function te(e,t){var i=e.name+"/";return e.storeName!==t.storeName&&(i+=e.storeName+"/"),i}var ie={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var i in e)t[i]=e[i];return t.keyPrefix=te(e,this._defaultConfig),!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0?(this._dbInfo=t,t.serializer=Y,r.resolve()):r.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var i=this,o=i.ready().then((function(){for(var t=i._dbInfo,o=t.keyPrefix,s=o.length,n=localStorage.length,r=1,a=0;a<n;a++){var l=localStorage.key(a);if(0===l.indexOf(o)){var c=localStorage.getItem(l);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,l.substring(s),r++)))return c}}}));return a(o,t),o},getItem:function(e,t){var i=this;e=c(e);var o=i.ready().then((function(){var t=i._dbInfo,o=localStorage.getItem(t.keyPrefix+e);return o&&(o=t.serializer.deserialize(o)),o}));return a(o,t),o},setItem:function(e,t,i){var o=this;e=c(e);var s=o.ready().then((function(){void 0===t&&(t=null);var i=t;return new r((function(s,n){var r=o._dbInfo;r.serializer.serialize(t,(function(t,o){if(o)n(o);else try{localStorage.setItem(r.keyPrefix+e,t),s(i)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||n(e),n(e)}}))}))}));return a(s,i),s},removeItem:function(e,t){var i=this;e=c(e);var o=i.ready().then((function(){var t=i._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(o,t),o},clear:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var o=localStorage.key(i);0===o.indexOf(e)&&localStorage.removeItem(o)}}));return a(i,e),i},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var i=this,o=i.ready().then((function(){var t,o=i._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(o.keyPrefix.length)),t}));return a(o,t),o},keys:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo,i=localStorage.length,o=[],s=0;s<i;s++){var n=localStorage.key(s);0===n.indexOf(e.keyPrefix)&&o.push(n.substring(e.keyPrefix.length))}return o}));return a(i,e),i},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var i=this.config();e.name=e.name||i.name,e.storeName=e.storeName||i.storeName}var o,s=this;return o=e.name?new r((function(t){e.storeName?t(te(e,s._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var i=localStorage.key(t);0===i.indexOf(e)&&localStorage.removeItem(i)}})):r.reject("Invalid arguments"),a(o,t),o}},oe=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},se=function(e,t){for(var i=e.length,o=0;o<i;){if(oe(e[o],t))return!0;o++}return!1},ne=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},re={},ae={},le={INDEXEDDB:T,WEBSQL:ee,LOCALSTORAGE:ie},ce=[le.INDEXEDDB._driver,le.WEBSQL._driver,le.LOCALSTORAGE._driver],ue=["dropInstance"],de=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ue),pe={description:"",driver:ce.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function he(e,t){e[t]=function(){var i=arguments;return e.ready().then((function(){return e[t].apply(e,i)}))}}function fe(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var i in t)t.hasOwnProperty(i)&&(ne(t[i])?arguments[0][i]=t[i].slice():arguments[0][i]=t[i])}return arguments[0]}var me=function(){function e(t){for(var i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),le)if(le.hasOwnProperty(i)){var o=le[i],s=o._driver;this[i]=s,re[s]||this.defineDriver(o)}this._defaultConfig=fe({},pe),this._config=fe({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":o(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,i){var o=new r((function(t,i){try{var o=e._driver,s=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void i(s);for(var n=de.concat("_initStorage"),l=0,c=n.length;l<c;l++){var u=n[l];if((!se(ue,u)||e[u])&&"function"!=typeof e[u])return void i(s)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),i=r.reject(t);return a(i,arguments[arguments.length-1]),i}},i=0,o=ue.length;i<o;i++){var s=ue[i];e[s]||(e[s]=t(s))}}();var d=function(i){re[o]&&console.info("Redefining LocalForage driver: "+o),re[o]=e,ae[o]=i,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,i):d(!!e._support):d(!0)}catch(e){i(e)}}));return l(o,t,i),o},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,i){var o=re[e]?r.resolve(re[e]):r.reject(new Error("Driver not found."));return l(o,t,i),o},e.prototype.getSerializer=function(e){var t=r.resolve(Y);return l(t,e),t},e.prototype.ready=function(e){var t=this,i=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return l(i,e,e),i},e.prototype.setDriver=function(e,t,i){var o=this;ne(e)||(e=[e]);var s=this._getSupportedDrivers(e);function n(){o._config.driver=o.driver()}function a(e){return o._extend(e),n(),o._ready=o._initStorage(o._config),o._ready}var c=null!==this._driverSet?this._driverSet.catch((function(){return r.resolve()})):r.resolve();return this._driverSet=c.then((function(){var e=s[0];return o._dbInfo=null,o._ready=null,o.getDriver(e).then((function(e){o._driver=e._driver,n(),o._wrapLibraryMethodsWithReady(),o._initDriver=function(e){return function(){var t=0;return function i(){for(;t<e.length;){var s=e[t];return t++,o._dbInfo=null,o._ready=null,o.getDriver(s).then(a).catch(i)}n();var l=new Error("No available storage method found.");return o._driverSet=r.reject(l),o._driverSet}()}}(s)}))})).catch((function(){n();var e=new Error("No available storage method found.");return o._driverSet=r.reject(e),o._driverSet})),l(this._driverSet,t,i),this._driverSet},e.prototype.supports=function(e){return!!ae[e]},e.prototype._extend=function(e){fe(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],i=0,o=e.length;i<o;i++){var s=e[i];this.supports(s)&&t.push(s)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=de.length;e<t;e++)he(this,de[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),ge=new me;t.exports=ge},{3:3}]},{},[4])(4)})),Zs=ie((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ActionCreators=t.ActionTypes=void 0;var i={UNDO:"@@redux-undo/UNDO",REDO:"@@redux-undo/REDO",JUMP_TO_FUTURE:"@@redux-undo/JUMP_TO_FUTURE",JUMP_TO_PAST:"@@redux-undo/JUMP_TO_PAST",JUMP:"@@redux-undo/JUMP",CLEAR_HISTORY:"@@redux-undo/CLEAR_HISTORY"};t.ActionTypes=i;var o={undo:function(){return{type:i.UNDO}},redo:function(){return{type:i.REDO}},jumpToFuture:function(e){return{type:i.JUMP_TO_FUTURE,index:e}},jumpToPast:function(e){return{type:i.JUMP_TO_PAST,index:e}},jump:function(e){return{type:i.JUMP,index:e}},clearHistory:function(){return{type:i.CLEAR_HISTORY}}};t.ActionCreators=o})),Js=ie((function(e,t){function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Array.isArray(e)?e:"string"==typeof e?[e]:t}Object.defineProperty(t,"__esModule",{value:!0}),t.parseActions=i,t.isHistory=function(e){return void 0!==e.present&&void 0!==e.future&&void 0!==e.past&&Array.isArray(e.future)&&Array.isArray(e.past)},t.includeAction=function(e){var t=i(e);return function(e){return t.indexOf(e.type)>=0}},t.excludeAction=function(e){var t=i(e);return function(e){return t.indexOf(e.type)<0}},t.combineFilters=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce((function(e,t){return function(i,o,s){return e(i,o,s)&&t(i,o,s)}}),(function(){return!0}))},t.groupByActionTypes=function(e){var t=i(e);return function(e){return t.indexOf(e.type)>=0?e.type:null}},t.newHistory=function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{past:e,present:t,future:i,group:o,_latestUnfiltered:t,index:e.length,limit:e.length+i.length+1}}})),Xs=ie((function(e,t){function i(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o,s;Object.defineProperty(t,"__esModule",{value:!0}),t.set=function(e){o=e},t.start=function(e,t){s={header:[],prev:[],action:[],next:[],msgs:[]},o&&(console.group?(s.header=["%credux-undo","font-style: italic","action",e.type],s.action=l("action",r,e),s.prev=l("prev history",n,t)):(s.header=["redux-undo action",e.type],s.action=["action",e],s.prev=["prev history",t]))},t.end=function(e){o&&(console.group?s.next=l("next history",a,e):s.next=["next history",e],function(){var e,t,o,n,r,a,l,c,u,d,p=s,h=p.header,f=p.prev,m=p.next,g=p.action,v=p.msgs;console.group?((e=console).groupCollapsed.apply(e,i(h)),(t=console).log.apply(t,i(f)),(o=console).log.apply(o,i(g)),(n=console).log.apply(n,i(m)),(r=console).log.apply(r,i(v)),console.groupEnd()):((a=console).log.apply(a,i(h)),(l=console).log.apply(l,i(f)),(c=console).log.apply(c,i(g)),(u=console).log.apply(u,i(m)),(d=console).log.apply(d,i(v)))}())},t.log=function(){if(o){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s.msgs=s.msgs.concat([].concat(t,["\n"]))}};var n="#9E9E9E",r="#03A9F4",a="#4CAF50";function l(e,t,i){return["%c".concat(e),"color: ".concat(t,"; font-weight: bold"),i]}})),Qs=ie((function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.set(t.debug);var i,s=r({limit:void 0,filter:function(){return!0},groupBy:function(){return null},undoType:Zs.ActionTypes.UNDO,redoType:Zs.ActionTypes.REDO,jumpToPastType:Zs.ActionTypes.JUMP_TO_PAST,jumpToFutureType:Zs.ActionTypes.JUMP_TO_FUTURE,jumpType:Zs.ActionTypes.JUMP,neverSkipReducer:!1,ignoreInitialState:!1,syncFilter:!1},t,{initTypes:(0,Js.parseActions)(t.initTypes,["@@redux-undo/INIT"]),clearHistoryType:(0,Js.parseActions)(t.clearHistoryType,[Zs.ActionTypes.CLEAR_HISTORY])}),n=s.neverSkipReducer?function(t,i){for(var o=arguments.length,s=new Array(o>2?o-2:0),n=2;n<o;n++)s[n-2]=arguments[n];return r({},t,{present:e.apply(void 0,[t.present,i].concat(s))})}:function(e){return e};return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.start(r,t);for(var a,l=t,m=arguments.length,g=new Array(m>2?m-2:0),v=2;v<m;v++)g[v-2]=arguments[v];if(!i){if(o.log("history is uninitialized"),void 0===t){var b={type:"@@redux-undo/CREATE_HISTORY"},y=e.apply(void 0,[t,b].concat(g));return l=c(y,s.ignoreInitialState),o.log("do not set initialState on probe actions"),o.end(l),l}(0,Js.isHistory)(t)?(l=i=s.ignoreInitialState?t:(0,Js.newHistory)(t.past,t.present,t.future),o.log("initialHistory initialized: initialState is a history",i)):(l=i=c(t,s.ignoreInitialState),o.log("initialHistory initialized: initialState is not a history",i))}switch(r.type){case void 0:return l;case s.undoType:return a=h(l,-1),o.log("perform undo"),o.end(a),n.apply(void 0,[a,r].concat(g));case s.redoType:return a=h(l,1),o.log("perform redo"),o.end(a),n.apply(void 0,[a,r].concat(g));case s.jumpToPastType:return a=p(l,r.index),o.log("perform jumpToPast to ".concat(r.index)),o.end(a),n.apply(void 0,[a,r].concat(g));case s.jumpToFutureType:return a=d(l,r.index),o.log("perform jumpToFuture to ".concat(r.index)),o.end(a),n.apply(void 0,[a,r].concat(g));case s.jumpType:return a=h(l,r.index),o.log("perform jump to ".concat(r.index)),o.end(a),n.apply(void 0,[a,r].concat(g));case f(r.type,s.clearHistoryType):return a=c(l.present,s.ignoreInitialState),o.log("perform clearHistory"),o.end(a),n.apply(void 0,[a,r].concat(g));default:if(a=e.apply(void 0,[l.present,r].concat(g)),s.initTypes.some((function(e){return e===r.type})))return o.log("reset history due to init action"),o.end(i),i;if(l._latestUnfiltered===a)return l;var k="function"==typeof s.filter&&!s.filter(r,a,l);if(k){var w=(0,Js.newHistory)(l.past,a,l.future,l.group);return s.syncFilter||(w._latestUnfiltered=l._latestUnfiltered),o.log("filter ignored action, not storing it in past"),o.end(w),w}var x=s.groupBy(r,a,l);if(null!=x&&x===l.group){var C=(0,Js.newHistory)(l.past,a,l.future,l.group);return o.log("groupBy grouped the action with the previous action"),o.end(C),C}return l=u(l,a,s.limit,x),o.log("inserted new state into history"),o.end(l),l}}};var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var o={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=n?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(o,r,a):o[r]=e[r]}return o.default=e,t&&t.set(e,o),o}(Xs);function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){var i=(0,Js.newHistory)([],e,[]);return t&&(i._latestUnfiltered=null),i}function u(e,t,i,s){var n=e.past.length+1;o.log("inserting",t),o.log("new free: ",i-n);var r=e.past,a=e._latestUnfiltered,c=i&&i<=n,u=r.slice(c?1:0),d=null!=a?[].concat(l(u),[a]):u;return(0,Js.newHistory)(d,t,[],s)}function d(e,t){if(t<0||t>=e.future.length)return e;var i=e.past,o=e.future,s=e._latestUnfiltered,n=[].concat(l(i),[s],l(o.slice(0,t))),r=o[t],a=o.slice(t+1);return(0,Js.newHistory)(n,r,a)}function p(e,t){if(t<0||t>=e.past.length)return e;var i=e.past,o=e.future,s=e._latestUnfiltered,n=i.slice(0,t),r=[].concat(l(i.slice(t+1)),[s],l(o)),a=i[t];return(0,Js.newHistory)(n,a,r)}function h(e,t){return t>0?d(e,t-1):t<0?p(e,e.past.length+t):e}function f(e,t){return t.indexOf(e)>-1?e:!e}})),en=ie((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ActionTypes",{enumerable:!0,get:function(){return Zs.ActionTypes}}),Object.defineProperty(t,"ActionCreators",{enumerable:!0,get:function(){return Zs.ActionCreators}}),Object.defineProperty(t,"parseActions",{enumerable:!0,get:function(){return Js.parseActions}}),Object.defineProperty(t,"isHistory",{enumerable:!0,get:function(){return Js.isHistory}}),Object.defineProperty(t,"includeAction",{enumerable:!0,get:function(){return Js.includeAction}}),Object.defineProperty(t,"excludeAction",{enumerable:!0,get:function(){return Js.excludeAction}}),Object.defineProperty(t,"combineFilters",{enumerable:!0,get:function(){return Js.combineFilters}}),Object.defineProperty(t,"groupByActionTypes",{enumerable:!0,get:function(){return Js.groupByActionTypes}}),Object.defineProperty(t,"newHistory",{enumerable:!0,get:function(){return Js.newHistory}}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o.default}});var i,o=(i=Qs)&&i.__esModule?i:{default:i}})),tn=ne(en),on=en.ActionCreators,sn=en.excludeAction;function nn(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var rn="function"==typeof Symbol&&Symbol.observable||"@@observable",an=function(){return Math.random().toString(36).substring(7).split("").join(".")},ln={INIT:"@@redux/INIT"+an(),REPLACE:"@@redux/REPLACE"+an(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+an()}};function cn(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function un(e,t,i){var o;if("function"==typeof t&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(nn(0));if("function"==typeof t&&void 0===i&&(i=t,t=void 0),void 0!==i){if("function"!=typeof i)throw new Error(nn(1));return i(un)(e,t)}if("function"!=typeof e)throw new Error(nn(2));var s=e,n=t,r=[],a=r,l=!1;function c(){a===r&&(a=r.slice())}function u(){if(l)throw new Error(nn(3));return n}function d(e){if("function"!=typeof e)throw new Error(nn(4));if(l)throw new Error(nn(5));var t=!0;return c(),a.push(e),function(){if(t){if(l)throw new Error(nn(6));t=!1,c();var i=a.indexOf(e);a.splice(i,1),r=null}}}function p(e){if(!cn(e))throw new Error(nn(7));if(void 0===e.type)throw new Error(nn(8));if(l)throw new Error(nn(9));try{l=!0,n=s(n,e)}finally{l=!1}for(var t=r=a,i=0;i<t.length;i++)(0,t[i])();return e}function h(e){if("function"!=typeof e)throw new Error(nn(10));s=e,p({type:ln.REPLACE})}function f(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(nn(11));function i(){e.next&&e.next(u())}return i(),{unsubscribe:t(i)}}})[rn]=function(){return this},e}return p({type:ln.INIT}),(o={dispatch:p,subscribe:d,getState:u,replaceReducer:h})[rn]=f,o}function dn(e){for(var t=Object.keys(e),i={},o=0;o<t.length;o++){var s=t[o];"function"==typeof e[s]&&(i[s]=e[s])}var n,r=Object.keys(i);try{!function(e){Object.keys(e).forEach((function(t){var i=e[t];if(void 0===i(void 0,{type:ln.INIT}))throw new Error(nn(12));if(void 0===i(void 0,{type:ln.PROBE_UNKNOWN_ACTION()}))throw new Error(nn(13))}))}(i)}catch(e){n=e}return function(e,t){if(void 0===e&&(e={}),n)throw n;for(var o=!1,s={},a=0;a<r.length;a++){var l=r[a],c=i[l],u=e[l],d=c(u,t);if(void 0===d)throw t&&t.type,new Error(nn(14));s[l]=d,o=o||d!==u}return(o=o||r.length!==Object.keys(e).length)?s:e}}var pn="persist/REHYDRATE",hn="persist/REGISTER";function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function gn(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vn(e,t,i,o){o.debug;var s=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?mn(i,!0).forEach((function(t){gn(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mn(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},i);return e&&"object"===fn(e)&&Object.keys(e).forEach((function(o){"_persist"!==o&&t[o]===i[o]&&(s[o]=e[o])})),s}function bn(e){return JSON.stringify(e)}function yn(e){var t,i=e.transforms||[],o="".concat(void 0!==e.keyPrefix?e.keyPrefix:"persist:").concat(e.key),s=e.storage;return e.debug,t=!1===e.deserialize?function(e){return e}:"function"==typeof e.deserialize?e.deserialize:kn,s.getItem(o).then((function(e){if(e)try{var o={},s=t(e);return Object.keys(s).forEach((function(e){o[e]=i.reduceRight((function(t,i){return i.out(t,e,s)}),t(s[e]))})),o}catch(e){throw e}}))}function kn(e){return JSON.parse(e)}function wn(e){}function xn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function Cn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?xn(i,!0).forEach((function(t){Sn(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xn(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Sn(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _n(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function En(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function zn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?En(i,!0).forEach((function(t){$n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):En(i).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function $n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Tn={registry:[],bootstrapped:!1},On=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case hn:return zn({},e,{registry:[].concat(_n(e.registry),[t.key])});case pn:var i=e.registry.indexOf(t.key),o=_n(e.registry);return o.splice(i,1),zn({},e,{registry:o,bootstrapped:0===o.length});default:return e}},In=Object.freeze({__proto__:null,START_CELL_SELECTION:"START_CELL_SELECTION",SELECT_CELL:"SELECT_CELL",END_CELL_SELECTION:"END_CELL_SELECTION",SELECT_SIMILAR_CELLS:"SELECT_SIMILAR_CELLS",TENTATIVELY_SELECT_CELLS:"TENTATIVELY_SELECT_CELLS",CLEAR_TENTATIVE_CELL_SELECTION:"CLEAR_TENTATIVE_CELL_SELECTION",MOVE_CELL_POSITION:"MOVE_CELL_POSITION",SET_KEY_MODE:"SET_KEY_MODE",SET_MODE:"SET_MODE",HIGHLIGHT_CONFLICTS:"HIGHLIGHT_CONFLICTS",UNHIGHLIGHT_CONFLICTS:"UNHIGHLIGHT_CONFLICTS",REPORT_STEPS:"REPORT_STEPS",UPDATE_FEATURE_ITEM:"UPDATE_FEATURE_ITEM",UPDATE_FEATURE_POSITIONS:"UPDATE_FEATURE_POSITIONS",TOGGLE_FEATURE_NAME:"TOGGLE_FEATURE_NAME",HIGHLIGHT_FEATURE_ITEM:"HIGHLIGHT_FEATURE_ITEM",UNHIGHLIGHT_FEATURE_ITEM:"UNHIGHLIGHT_FEATURE_ITEM",REQUEST_SOLUTION_COUNT:"REQUEST_SOLUTION_COUNT",REPORT_SOLUTION_COUNT:"REPORT_SOLUTION_COUNT",CANCEL_SOLUTION_COUNT:"CANCEL_SOLUTION_COUNT",SHOW_HEAT_MAP:"SHOW_HEAT_MAP",HIDE_HEAT_MAP:"HIDE_HEAT_MAP",UPDATE_SOLUTION_INDEX:"UPDATE_SOLUTION_INDEX",ADD_RECENT_COLOR:"ADD_RECENT_COLOR"});const An={iteration:0,values:e(81,(e=>0)),cornerMarks:e(81,(e=>"")),centerMarks:e(81,(e=>"")),userCandidates:e(81,(e=>"")),cellColors:e(81,(e=>"")),optionClasses:{}},Mn=(t,{puzzle:i})=>{const o=i.size,s=e(o**2,(e=>"123456789"));return{...t,values:e(o**2,(e=>0)),cornerMarks:e(o**2,(e=>"")),centerMarks:e(o**2,(e=>"")),cellColors:e(o**2,(e=>"")),userCandidates:s,iteration:t.iteration+1}},Ln=(e,{positions:t,value:i,puzzle:o,options:s})=>{if(t.every((t=>e.values[t]===~~i)))return e;const n=e.values.map(((e,o)=>t.includes(o)?Number(i):e));return{...e,values:n,iteration:e.iteration+1}},Pn=(e,t,i)=>{const o=t.some((t=>!e[t].includes(i)));return e.map(((e,s)=>t.includes(s)?o?e.includes(i)?e:[...e+i].sort().join(""):e.replace(i,""):e))},Nn=(e,t)=>e.map(((e,i)=>t.includes(i)?"":e)),Rn={puzzleIteration:0,featureName:"",constraints:{row:{},column:{},box:{}},givens:e(81,(e=>0)),size:9,name:"",setter:""},jn=(t,{puzzle:i})=>{const{givens:o,constraints:s,size:n=9,name:r="",setter:a="",alias:l,disableViolationChecking:c,...u}=i;return c&&(u.disableViolationChecking=!0),{...u,puzzleIteration:t.puzzleIteration+1,alias:l,givens:e(n**2,(e=>o[e]??0)),constraints:s,size:~~n,name:r,setter:a}},Dn=(e,{positions:t,value:i})=>({...e,puzzleIteration:e.puzzleIteration+1,givens:e.givens.map(((e,o)=>t.includes(o)?~~i:e))}),Un=e=>{if(e.featureName){const t=e.constraints[e.featureName];if(t){const i=t?.items.filter((e=>!e._creating)),o=i.findIndex((e=>e._editing)),s=e.revertItem,n=-1!==o?[...i.slice(0,o),s,...i.slice(o+1)]:i;n.length||t.negativeConstraint?e={...e,revertItem:{},latestEditPosition:void 0,constraints:{...e.constraints,[e.featureName]:{...t,items:n}}}:delete(e={...e}).constraints[e.featureName]}}return e},Fn=(e,{featureName:t})=>{if(t===(e=Un(e)).featureName){const{featureName:t,...i}=e;return i}const i=e.constraints[t]??{},o=i.items??[];return{...e,featureName:e.featureName===t?"":t,latestEditPosition:void 0,featureItemSelectionTemplate:Us.get(t).selectionTemplates()[0],constraints:{...e.constraints,[t]:{...i,items:[...o,{_creating:!0,positions:[]}]}}}},Hn=(e,t,i)=>Object.entries(e).reduce(((t,[o,s])=>{if("object"==typeof s&&!("default"in s))return t;switch(s.type){case"section":case"booleanSection":t[o]=Hn(e[o],t[o]??{},i[o]);break;case"choice":if(e[o].choices){const s=i[o]??e[o].default,n=e[o].choices[s].template??e;t[o]={...t[o],[s]:Hn(n,t[o]?.[s]??{},i)};break}default:t[o]=i[o]??t[o]}return t}),t),Bn=(e,t,i,o,a,l,c)=>{const u=Us.get(e),d=u.selectionTemplates(),h=d[c.alt&&d.length>1?1:0];if([p.CENTER_SIZE,p.CORNER_SIZE].includes(h)){const e=[Ri(l.x),Ri(l.y)],i={point:e,sizes:[25,25],...t},o=e=>Math.round(10*e)/10,r=h===p.CENTER_SIZE?e=>Math.abs(e):e=>e,a=!1===i._snapToGrid?e=>Number(e):e=>Ri(Math.round(4*ji(e)))/4;if(i._done_setting)return t;if(i._set_rotation){const t=h===p.CORNER_SIZE?[Number(i.point[0])+i.sizes[0]/2,Number(i.point[1])+(i.sizes[1]??i.sizes[0])/2]:i.point,r=!1===i._snapToGrid?e=>o(e):e=>45*Math.round(e/45);i.rotation=r(s(n(t,e))),delete i._set_rotation,i._done_setting=!0}else i._set_sizes?(i.sizes=[e[0]-i.point[0],e[1]-i.point[1]].map(a).map(o).map(r),c.shift&&(h===p.CENTER_SIZE?i.sizes[0]=i.sizes[1]=o(a(r(re(e[0]-i.point[0],e[1]-i.point[1])))):0===i.sizes[1]?i.sizes[1]=i.sizes[0]:0===i.sizes[0]?i.sizes[0]=i.sizes[1]:Math.abs(i.sizes[0])>Math.abs(i.sizes[1])?i.sizes[1]=Math.abs(i.sizes[0])*Math.sign(i.sizes[1]):i.sizes[0]=Math.abs(i.sizes[1])*Math.sign(i.sizes[0])),i.sizes[1]===i.sizes[0]&&(i.sizes.length=1),i._set_rotation=!0,delete i._set_sizes):(i.point=e.map(a).map(o),i._set_sizes=!0);return i}if(h===p.PATH){const e=e=>Math.round(10*e)/10,i=!1===t._snapToGrid?e=>Number(e):e=>Ri(Math.round(4*ji(e)))/4,o=[Ri(l.x),Ri(l.y)];if(c.shift&&t.points?.length>0){const e=t.points.slice(-1)[0];Math.abs(o[0]-e[0])>Math.abs(o[1]-e[1])?o[1]=e[1]:o[0]=e[0]}return{...t,points:[...t.points??[],o.map(i).map(e)]}}if(h===p.POINT){const e=e=>Math.round(10*e)/10,i=!1===t._snapToGrid?e=>Number(e):e=>Ri(Math.round(4*ji(e)))/4,o=[Ri(l.x),Ri(l.y)];return{...t,points:[...t.points??[],o.map(i).map(e)]}}!a&&Object.values(r).includes(h)&&(a=t.positions[t.positions.length-1]);const f=ae(h,i,{positions:[o,a],point:l});if(!f||!f.length)return t;Object.values(w).includes(h)&&f.indexOf(o)>=f.length/2&&f.reverse(),f.length&&c.shift&&f.reverse();const m=Object.values(r).includes(h)?t.positions:[],g=[...new Set([...m,...f])],v=u.itemTemplate(),b={};if(v.type){const e=Object.keys(v.type.choices),i=t.type??v.type.default;b.type=c.alt?e.find((e=>e!==i)):i}return{...t,positions:g,...b}},Wn={count:{iteration:0,cancelIteration:0,requestDownloadIteration:0,stats:{count:0,status:W,deadends:0,requirements:0,restrictions:0,options:0,depth:0,maxDepth:0},startTime:0,endTime:0,requirementCount:0,restrictionCount:0,optionCount:0,index:0},logical:{steps:[],step:0,iteration:0,cancelIteration:0,highlightedPositions:[],impactedPositions:[]}},Vn={default:[16482418,11787881,8434131,16567781,13429701,12499674,16626786,16772463,12353725],ctc:[15198183,11645361,0,13758631,15839735,16037265,16028818,16509084,9224950],"f-puzzles":[11053224,16752800,16769120,16777136,11599792,6344800,13684991,8421616,16744703,1047958],pastels:[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,14145495]},{NORTH:Gn,SOUTH:qn,WEST:Kn,EAST:Yn}=M,Zn={mode:"play",keyMode:"values",cursor:0,selectingCells:!1,addToSelection:!0,selectedCells:[],tentativelySelectedCells:[],highlightedConflicts:[],highlightedPositions:[],cellSetValues:[],impactedPositions:[],priorSelection:[],startTime:Date.now(),paused:!1,pauseTime:0,stopped:!1,stopTime:0,recentColors:[],notifications:[],palette:"default",nextPalette:"ctc",prevPalette:"pastels",settings:{solutionCount:{heatmap:!1,solutions:!1,givensOnly:!1,randomize:!0,stats:!0,timeLimitMs:6e4,solutionLimit:1e6},addRemoveModifier:navigator.platform.includes("Mac")?"metaKey":"ctrlKey",cornersModifier:"shiftKey",centersModifier:"ctrlKey",colorsModifier:"altKey",rowModifier:"none",columnModifier:"none",boxModifier:"none",cellNameStyle:"j9",selectionOutlineColor:"#6666ddff",selectionOutlineSize:5,selectionColor:"#ffff0054",givenBackgroundColor:"#0000000b",autoCandidates:!1,autoCheck:!1,autoClearMarks:!1,autoSolve:!1,hideTimer:!1,outlineSelection:!0,shadePeers:!1,showConflicts:!0,hideEditTips:!1,dimColors:!1}},Jn=(t,{puzzle:i})=>({...t,startTime:Date.now(),pauseTime:0,stopTime:0,paused:!1,stopped:!1,steps:[],cellSetValues:e(i.size**2,(e=>0))}),Xn=(e,{position:t,accumulate:i})=>{if(i){const i=e.addToSelection?[...e.selectedCells,t]:e.selectedCells.filter((e=>e!==t));return{...e,cursor:t,selectedCells:[...new Set(i)]}}return{...e,cursor:t,selectedCells:[t]}},Qn=(t,{position:i,criterion:o,accumulate:s})=>{if("edit"===t.mode&&"values"!==t.keyMode)return t;const n=o[i],r=e(o.length).filter((e=>o[e]===n)),a=[...new Set(s?[...t.selectedCells,...r,i]:[...r,i])];return{...t,cursor:i,selectedCells:a}},er=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,33,36,40,41,42,44,46,47,64,63,61,91,93,94,95,96,126,45,58,59].map((e=>String.fromCharCode(e))).join(""),tr=new Map([...er].map(((e,t)=>[e,t]))),ir=e=>{if(!(e instanceof Uint8Array))throw new TypeError("Invalid input type. encodeUint8Array() expects a Uint8Array argument.");const t=[];let i=0;for(const[o,s]of e.entries())if(i=256*i+s,!(o<e.length-1&&(o+1)%4)){for(let e=0;e<5;++e)t.push(i%85),i=~~(i/85);i=0}return t.slice(0,Math.ceil(5*e.length/4)).map((e=>er[e])).join("")},or=e=>{const t=[];let i=0;for(const[o,s]of[...e].entries())if(i+=85**(o%5)*tr.get(s),!(o<e.length-1&&(o+1)%5)){switch(o%5){case 4:t.push((i>>>24)%256);case 3:t.push((i>>>16)%256);case 2:t.push((i>>>8)%256);default:t.push(i%256)}i=0}return Uint8Array.from(t)},sr=dn({ui:(e=Zn,t)=>{switch(t.type){case"SET_PUZZLE":return Jn(e,t);case"START_CELL_SELECTION":return((e,{position:t,accumulate:i})=>Xn({...e,addToSelection:!i||!e.selectedCells.includes(t),selectingCells:!0},{position:t,accumulate:i}))(e,t);case"SELECT_CELL":return Xn(e,t);case"END_CELL_SELECTION":return(e=>{const t=[...new Set([...e.selectedCells,...e.tentativelySelectedCells])];return{...e,selectingCells:!1,addToSelection:!0,selectedCells:t,tentativelySelectedCells:[]}})(e);case"TENTATIVELY_SELECT_CELLS":return((e,{positions:t,accumulate:i})=>({...e,tentativelySelectedCells:i?[...e.tentativelySelectedCells,...t]:t}))(e,t);case"CLEAR_TENTATIVE_CELL_SELECTION":return(e=>({...e,tentativelySelectedCells:[]}))(e);case"SELECT_SIMILAR_CELLS":return Qn(e,t);case"MOVE_CELL_POSITION":return((e,{direction:t,accumulate:i,puzzle:o,peers:s})=>{const n=((e,t,i)=>{const o=i===Yn?t%e<e-1?t+1:t-e+1:i===Kn?t%e!=0?t-1:t+e-1:i===Gn?t-e>=0?t-e:t+(e**2-e):i===qn?t+e<e**2?t+e:t-(e**2-e):t;return o>=0&&o<e**2?o:t})(o.size,e.cursor,t),r=i?[...new Set([n,...e.selectedCells])]:[n];return{...e,cursor:n,selectedCells:r}})(e,t);case"SET_MODE":return((e,{mode:t})=>({...e,mode:t,keyMode:"values"}))(e,t);case"SET_KEY_MODE":return((e,{keyMode:t})=>({...e,keyMode:t}))(e,t);case"HIGHLIGHT_CONFLICTS":return((e,{positions:t})=>({...e,highlightedConflicts:t}))(e,t);case"UNHIGHLIGHT_CONFLICTS":return(e=>({...e,highlightedConflicts:[]}))(e);case"TOGGLE_PAUSE":return(e=>({...e,paused:!e.paused,pauseTime:Date.now(),startTime:e.startTime-(e.paused?e.pauseTime-Date.now():0)}))(e);case"STOP_TIMER":return(e=>({...e,paused:!1,stopTime:Date.now(),stopped:!0,startTime:e.startTime-(e.paused?e.pauseTime-Date.now():0)}))(e);case"ADD_RECENT_COLOR":return((e,{color:t})=>({...e,recentColors:[...new Set([t,...e.recentColors])].slice(0,12)}))(e,t);case"UPDATE_SETTINGS":return((e,{settings:t})=>({...e,settings:ce(e.settings,t)}))(e,t);case"SEND_NOTIFICATION":return((e,{notification:t})=>({...e,notifications:[...e.notifications,t]}))(e,t);case"CLEAR_NOTIFICATION":return((e,{notification:t})=>({...e,notifications:e.notifications.filter((e=>e!==t))}))(e,t);case"SELECT_FEATURE_ITEM":return((e,{featureName:t,index:i})=>({...e,keyMode:Object.keys(Fs).find((e=>[...Fs[e].values()].includes(t)))}))(e,t);case"ADD_CELL_SET_VALUE":return((e,{positions:t})=>({...e,cellSetValues:e.cellSetValues.map(((e=0,i)=>t.includes(i)?e+1:e))}))(e,t);case"DELETE_CELL_SET_VALUE":return((e,{positions:t})=>({...e,cellSetValues:e.cellSetValues.map(((e=0,i)=>t.includes(i)?e-1:e))}))(e,t);case"SET_PALETTE":return((e,{offset:t})=>{const i=Object.keys(Vn),o=i.length,s=(o+i.indexOf(e.palette)+t)%o,n=i[s],r=i[(s+1)%o],a=i[(o+s-1)%o];return{...e,palette:n,nextPalette:r,prevPalette:a}})(e,t);default:return e}},solution:(e=Wn,t)=>{switch(t.type){case"REQUEST_SOLUTION_COUNT":return(e=>({...e,count:{...e.count,stats:{...e.count.stats,status:le,count:0,deadends:0},iteration:e.count.iteration+1,index:0}}))(e);case"CANCEL_SOLUTION_COUNT":return(e=>({...e,count:{...e.count,cancelIteration:e.count.cancelIteration+1,endTime:Date.now()}}))(e);case"REPORT_SOLUTION_COUNT":return((e,{stats:t})=>{const i=[Y,G,K].includes(t.status)?Date.now():e.count.endTime;return{...e,count:{...e.count,stats:{...e.count.stats,...t},endTime:i}}})(e,t);case"SEARCH_INITIATED":return((e,{searchInitiation:t})=>({...e,count:{...e.count,...t,stats:{...e.count.stats,status:V},startTime:Date.now(),endTime:Date.now()}}))(e,t);case"UPDATE_SOLUTION_INDEX":return((e,{index:t})=>({...e,count:{...e.count,index:t}}))(e,t);case"SET_SHOWING_SOLUTION_TYPE":return((e,{showingSolutionType:t})=>({...e,showingSolutionType:t}))(e,t);case"REPORT_STEPS":return((e,{steps:t})=>({...e,logical:{...e.logical,steps:[...e.logical.steps,...t],step:e.logical.steps.length+t.length}}))(e,t);case"CLEAR_STEPS":return(e=>({...e,logical:{...e.logical,steps:[]}}))(e);case"UPDATE_SOLUTION_STEP":return((e,{step:t,substep:i})=>({...e,logical:{...e.logical,step:t,substep:i}}))(e,t);case"REQUEST_LOGICAL_SOLVE":return(e=>({...e,logical:{...e.logical,iteration:e.logical.iteration+1,step:0}}))(e);case"CANCEL_LOGICAL_SOLVE":return(e=>({...e,logical:{...e.logical,cancelIteration:e.logical.cancelIteration+1}}))(e);case"HIGHLIGHT_POSITIONS":return((e,{index:t,subindex:i,positions:o,impactedPositions:s={}})=>({...e,logical:{...e.logical,highlightedPositions:o,impactedPositions:s,step:t,substep:i},showingSolutionType:"LOGICAL"}))(e,t);case"UNHIGHLIGHT_POSITIONS":return(e=>({...e,logical:{...e.logical,highlightedPositions:[],impactedPositions:[],step:0,substep:0}}))(e);case"DOWNLOAD_SOLUTIONS":return(e=>({...e,count:{...e.count,requestDownloadIteration:e.count.requestDownloadIteration+1}}))(e);default:return e}},game:tn(dn({puzzle:(e=Rn,t)=>{switch(t.type){case"SET_CELL_GIVENS":return Dn(e,t);case"CLEAR_CELL_GIVENS":return((e,{positions:t})=>Dn(e,{positions:t,value:0}))(e,t);case"SET_PUZZLE":return jn(e,t);case"CLEAR_PUZZLE":return(e=>({...Rn,puzzleIteration:e.puzzleIteration+1}))(e);case"UPDATE_PUZZLE":return((e,{puzzle:t})=>{const{disableViolationChecking:i,setter:o,name:s,givens:n,constraints:r,...a}=e;return{...Rn,...a,...t,puzzleIteration:e.puzzleIteration+1}})(e,t);case"SET_KEY_MODE":return(e=>e.featureName?Fn(e,{featureName:e.featureName}):e)(e);case"SET_MODE":return((e,{mode:t})=>"edit"!==t?{...Un(e),featureName:""}:e)(e,t);case"UPDATE_FEATURE_POSITIONS":return((e,{position:t,point:i,modifiers:o})=>{const s=e.constraints[e.featureName];if(!s)return e;const n=s.items,r=n.findIndex((e=>e._creating||e._editing));if(-1===r)return e;const a=e.featureName,l=e.size,c=e.latestEditPosition,u=n[r],d=Bn(a,u,l,t,c,i,o);return{...e,latestEditPosition:t,featureItemSelectionTemplate:Us.get(a).selectionTemplates()[0],constraints:{...e.constraints,[e.featureName]:{...s,items:[...n.slice(0,r),d,...n.slice(r+1)]}}}})(e,t);case"UPDATE_FEATURE_ITEM":return((e,{item:t,defaultStyle:i})=>{const o=e.constraints[e.featureName];if(!o)return e;const s=o.items,n=s.findIndex((e=>e._creating||e._editing));if(-1===n)return e;if(i){const i=Us.get(e.featureName).itemTemplate();o.defaults=Hn(i,o.defaults??{},t)}return{...e,latestEditPosition:t.positions?.includes(e.latestEditPosition)?e.latestEditPosition:void 0,constraints:{...e.constraints,[e.featureName]:{...o,items:[...s.slice(0,n),t,...s.slice(n+1)]}}}})(e,t);case"SAVE_FEATURE_ITEM":return((e,{item:t})=>{const i=e.constraints[e.featureName]??{},o=i.items,s=o.findIndex((e=>e._creating||e._editing)),{_creating:n,_editing:r,_snapToGrid:a,...l}=t;return i.items=[...o.slice(0,s),l,...o.slice(s+1),{_creating:!0,positions:[]}],{...e,puzzleIteration:e.puzzleIteration+1,revertItem:{},latestEditPosition:void 0,constraints:{...e.constraints,[e.featureName]:i}}})(e,t);case"REVERT_FEATURE_ITEM":return(e=>{const t=e.revertItem,i=e.constraints[e.featureName].items,o=i?.findIndex((e=>e._editing));return-1===o?e:{...e,revertItem:{},featureName:void 0,latestEditPosition:void 0,constraints:{...e.constraints,[e.featureName]:{...e.constraints[e.featureName],items:[...i.slice(0,o),t,...i.slice(o+1)]}}}})(e);case"DELETE_FEATURE_ITEM":return(e=>{const t=e.revertItem,i=(e=Un(e)).constraints[e.featureName]??{},o=i.items?.filter((e=>e!==t))??[],s=Q(e.constraints);return 0===o.length?s[e.featureName]&&(delete s[e.featureName].items,"negativeConstraint"in i||delete s[e.featureName]):s[e.featureName]={...s[e.featureName],items:[...o]},{...e,puzzleIteration:e.puzzleIteration+1,revertItem:{},featureName:void 0,latestEditPosition:void 0,constraints:{...s}}})(e);case"SELECT_FEATURE_ITEM":return((e,{featureName:t,index:i})=>{const o=e.constraints[t].items[i];if(!o||o._creating||o._editing)return e;const s=(e=Un(e)).constraints[t].items,n={...o,_editing:!0},r=[...s.slice(0,i),n,...s.slice(i+1)];return{...e,revertItem:o,latestEditPosition:void 0,featureItemSelectionTemplate:Us.get(t).selectionTemplates()[0],constraints:{...e.constraints,[t]:{...e.constraints[t],items:r}},featureName:t}})(e,t);case"TOGGLE_FEATURE_NAME":return Fn(e,t);case"HIGHLIGHT_FEATURE_ITEM":return((e,{featureName:t,index:i})=>({...e,highlightFeatureName:t,highlightFeatureItemIndex:~~i}))(e,t);case"UNHIGHLIGHT_FEATURE_ITEM":return(e=>({...e,highlightFeatureName:"",highlightFeatureItemIndex:""}))(e);case"SWAP_FEATURE_ORDER":return((e,{featureName1:t,featureName2:i})=>{const o={};for(const s of Object.keys(e.constraints))s===t?o[i]=e.constraints[i]:s===i?o[t]=e.constraints[t]:o[s]=e.constraints[s];return{...e,constraints:o}})(e,t);case"SET_RULE":return((e,{constraint:t,rule:i})=>({...e,constraints:{...e.constraints,[t]:{...e.constraints[t],rules:i}}}))(e,t);case"RESET_RULE":return((e,{constraint:t})=>{if("fpuzzles"===t){const{rules:t,...i}=e;return i}const{rules:i,...o}=e.constraints[t];return{...e,constraints:{...e.constraints,[t]:o}}})(e,t);default:return e}},grid:(e=An,t)=>{switch(t.type){case"SET_PUZZLE":return Mn(e,t);case"CLEAR_PUZZLE":return(e=>Mn(e,{puzzle:{size:9}}))(e);case"SET_CELL_VALUES":return Ln(e,t);case"CLEAR_CELL_VALUES":return((e,{positions:t,puzzle:i,options:o})=>Ln(e,{positions:t,value:0,puzzle:i,options:o}))(e,t);case"SET_CELL_GIVENS":return((e,{positions:t})=>{const i=e.values.map(((e,i)=>t.includes(i)?0:e));return{...e,values:i}})(e,t);case"TOGGLE_CORNER_MARKS":return((e,{positions:t,mark:i,autoCandidates:o,puzzle:s})=>{if(o){const s=t.filter((e=>o[e].includes(i))),n=Pn(e.userCandidates,s,i),r=e.iteration+1;return{...e,userCandidates:n,iteration:r}}return{...e,cornerMarks:Pn(e.cornerMarks,t,i)}})(e,t);case"CLEAR_CORNER_MARKS":return((e,{positions:t,autoCandidates:i,puzzle:o})=>{if(i){const o=e.userCandidates.map(((e,o)=>t.includes(o)?e.replace(new RegExp(`[${i[o]}]`,"g"),""):e)),s=e.iteration+1;return{...e,userCandidates:o,iteration:s}}return{...e,cornerMarks:Nn(e.cornerMarks,t)}})(e,t);case"TOGGLE_CENTER_MARKS":return((e,{positions:t,mark:i})=>({...e,centerMarks:Pn(e.centerMarks,t,i)}))(e,t);case"CLEAR_CENTER_MARKS":return((e,{positions:t})=>({...e,centerMarks:Nn(e.centerMarks,t)}))(e,t);case"SET_CELL_COLORS":return((e,{positions:t,newColor:i})=>({...e,cellColors:e.cellColors.map(((e,o)=>t.includes(o)?i:e))}))(e,t);case"CLEAR_CELL_COLORS":return((e,{positions:t})=>({...e,cellColors:e.cellColors.map(((e,i)=>t.includes(i)?"":e))}))(e,t);default:return e}}}),{limit:1e4,ignoreInitialState:!0,filter:sn(["persist/PERSIST","persist/REHYDRATE",...Object.values(In)])})}),nr=e=>{const{puzzleIteration:t,alias:i,...o}=e;return o},rr={key:"root",storage:(ar=Ys,new Proxy(ar,{get:(e,t)=>"getItem"===t?(e,t)=>new Promise((i=>{ur.awaitUrlSet?ur.awaitUrlSet.then((o=>{delete ur.awaitUrlSet,i(ar.getItem(e,t))})):i(ar.getItem(e))})):Reflect.get(ar,t,e)})),blacklist:["solution"],stateReconciler:(e,t,i)=>{const o=nr(e.game.present.puzzle),s=nr(t.game.present.puzzle),n=JSON.stringify(o)===JSON.stringify(s)?ce(t.game,e.game):t.game;return{solution:t.solution,ui:{...t.ui,options:ce(t.ui.options,e.ui.options),settings:ce(t.ui.settings,e.ui.settings)},game:n}}};var ar;const lr=[function(e,t){var i=void 0!==e.version?e.version:-1,o=void 0===e.stateReconciler?vn:e.stateReconciler,s=e.getStoredState||yn,n=void 0!==e.timeout?e.timeout:5e3,r=null,a=!1,l=!0,c=function(e){return e._persist.rehydrated&&r&&!l&&r.update(e),e};return function(u,d){var p=u||{},h=p._persist,f=function(e,t){if(null==e)return{};var i,o,s=function(e,t){if(null==e)return{};var i,o,s={},n=Object.keys(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||(s[i]=e[i]);return s}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)i=n[o],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}(p,["_persist"]);if("persist/PERSIST"===d.type){var m=!1,g=function(t,i){m||(d.rehydrate(e.key,t,i),m=!0)};if(n&&setTimeout((function(){!m&&g(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(e.key,'"')))}),n),l=!1,r||(r=function(e){var t,i=e.blacklist||null,o=e.whitelist||null,s=e.transforms||[],n=e.throttle||0,r="".concat(void 0!==e.keyPrefix?e.keyPrefix:"persist:").concat(e.key),a=e.storage;t=!1===e.serialize?function(e){return e}:"function"==typeof e.serialize?e.serialize:bn;var l=e.writeFailHandler||null,c={},u={},d=[],p=null,h=null;function f(){if(0===d.length)return p&&clearInterval(p),void(p=null);var e=d.shift(),i=s.reduce((function(t,i){return i.in(t,e,c)}),c[e]);if(void 0!==i)try{u[e]=t(i)}catch(e){console.error("redux-persist/createPersistoid: error serializing state",e)}else delete u[e];0===d.length&&(Object.keys(u).forEach((function(e){void 0===c[e]&&delete u[e]})),h=a.setItem(r,t(u)).catch(g))}function m(e){return!(o&&-1===o.indexOf(e)&&"_persist"!==e||i&&-1!==i.indexOf(e))}function g(e){l&&l(e)}return{update:function(e){Object.keys(e).forEach((function(t){m(t)&&c[t]!==e[t]&&-1===d.indexOf(t)&&d.push(t)})),Object.keys(c).forEach((function(t){void 0===e[t]&&m(t)&&-1===d.indexOf(t)&&void 0!==c[t]&&d.push(t)})),null===p&&(p=setInterval(f,n)),c=e},flush:function(){for(;0!==d.length;)f();return h||Promise.resolve()}}}(e)),h)return Cn({},t(f,d),{_persist:h});if("function"!=typeof d.rehydrate||"function"!=typeof d.register)throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return d.register(e.key),s(e).then((function(t){var o=e.migrate||function(e,t){return Promise.resolve(e)};o(t,i).then((function(e){g(e)}),(function(e){g(void 0,e)}))}),(function(e){g(void 0,e)})),Cn({},t(f,d),{_persist:{version:i,rehydrated:!1}})}if("persist/PURGE"===d.type)return a=!0,d.result(function(e){var t=e.storage,i="".concat(void 0!==e.keyPrefix?e.keyPrefix:"persist:").concat(e.key);return t.removeItem(i,wn)}(e)),Cn({},t(f,d),{_persist:h});if("persist/FLUSH"===d.type)return d.result(r&&r.flush()),Cn({},t(f,d),{_persist:h});if("persist/PAUSE"===d.type)l=!0;else if(d.type===pn){if(a)return Cn({},f,{_persist:Cn({},h,{rehydrated:!0})});if(d.key===e.key){var v=t(f,d),b=d.payload,y=Cn({},!1!==o&&void 0!==b?o(b,u,v,e):v,{_persist:Cn({},h,{rehydrated:!0})});return c(y)}}if(!h)return t(u,d);var k=t(f,d);return k===f?u:c(Cn({},k,{_persist:h}))}}({...rr,transforms:[(cr=rr,function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.whitelist||null,s=i.blacklist||null;function n(e){return!(!o||-1!==o.indexOf(e))||!(!s||-1===s.indexOf(e))}return{in:function(t,i,o){return!n(i)&&e?e(t,i,o):t},out:function(e,i,o){return!n(i)&&t?t(e,i,o):e}}}((e=>ir(de(e))),(e=>ue(or(e))),cr))]},sr)];var cr;const ur=un(...lr);ur.awaitUrlSet=new Promise((e=>{ur.resolveAwaitUrlSet=e})),function(e,t,i){var o=!1,s=un(On,Tn,void 0),n=function(e){s.dispatch({type:hn,key:e})},r=function(t,i,n){var r={type:pn,payload:i,err:n,key:t};e.dispatch(r),s.dispatch(r),o&&a.getState().bootstrapped&&(o(),o=!1)},a=zn({},s,{purge:function(){var t=[];return e.dispatch({type:"persist/PURGE",result:function(e){t.push(e)}}),Promise.all(t)},flush:function(){var t=[];return e.dispatch({type:"persist/FLUSH",result:function(e){t.push(e)}}),Promise.all(t)},pause:function(){e.dispatch({type:"persist/PAUSE"})},persist:function(){e.dispatch({type:"persist/PERSIST",register:n,rehydrate:r})}});a.persist()}(ur);
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const dr=e=>(...t)=>({_$litDirective$:e,values:t});class pr{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,i){this._$Ct=e,this._$AM=t,this._$Ci=i}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const hr=dr(class extends pr{constructor(e){var t;if(super(e),1!==e.type||"class"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){var i,o;if(void 0===this.nt){this.nt=new Set,void 0!==e.strings&&(this.st=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!(null===(i=this.st)||void 0===i?void 0:i.has(e))&&this.nt.add(e);return this.render(t)}const s=e.element.classList;this.nt.forEach((e=>{e in t||(s.remove(e),this.nt.delete(e))}));for(const e in t){const i=!!t[e];i===this.nt.has(e)||(null===(o=this.st)||void 0===o?void 0:o.has(e))||(i?(s.add(e),this.nt.add(e)):(s.remove(e),this.nt.delete(e)))}return gt}});var fr=Object.defineProperty,mr=(e,t,i)=>(((e,t,i)=>{t in e?fr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class gr extends Zt{close(){this.pickerOpen&&(this.pickerOpen=!1,this.picker=void 0,this.shadowRoot.querySelector(".cpContainer").firstElementChild.remove())}toggle(){this.pickerOpen?this.close():this.open()}open(){this.pickerOpen=!0;const e={width:"280",height:"280",color:this.color,borderWidth:1,borderColor:"#fff",layoutDirection:"horizontal",layout:[{component:ds.ui.Slider,options:{sliderType:"hue"}},{component:ds.ui.Box}]};this.alpha&&(e.layout.push({component:ds.ui.Slider,options:{sliderType:"alpha"}}),e.width="300"),this.picker=new ds.ColorPicker(this.shadowRoot.querySelector(".cpContainer"),e),this.picker.on("color:change",(e=>{this.dispatchEvent(new CustomEvent("change:color",{detail:{color:this.picker.color}})),this.color=this.picker.color.hex8String}))}colorSelector(e){return t=>{this.picker.color.set(e),this.color=this.picker.color.hex8String,t.preventDefault(),t.stopPropagation()}}render(){const t={cp:!0,open:this.pickerOpen};return ft` <div class="${hr(t)}"> <div class="cpContainer"></div> <div class="recentColors"> ${this.recentColors.map((e=>ft` <button type="button" title="${e}" style="background-color:${ps.get(e)??e}" class="colorButton" @click="${this.colorSelector(e)}"></button> `))} ${e(12-this.recentColors.length,(e=>ft` <button disabled="disabled" type="button" class="colorButton"></button> `))} </div> </div> `}}mr(gr,"styles",Rt`:host{position:relative}.cp{display:none;position:relative;width:max-content;height:max-content;background-color:#fff;padding:10px;border-radius:3px}.cp.open{display:inline-block}.colorButton{height:22px;width:22px;margin:0;padding:0;appearance:none;-webkit-appearance:none;border:1px solid #a9a9a9;border-style:outset;background-color:#eee;border-radius:2px;cursor:pointer}:host([alpha]) .colorButton{width:27px}.colorButton[disabled]{background-color:#eeeeee5f}.colorButton:focus{border:1px solid #06d}`),mr(gr,"properties",{color:{type:String,attribute:!0,reflect:!0},pickerOpen:Boolean,picker:Object,iro:Object,recentColors:Array,alpha:Boolean}),customElements.define("color-picker",gr);const vr=Rt`*{box-sizing:border-box}:host{--base-unit:1vw;--font-base-size:1px;margin:20px 0;position:relative;width:calc(100% - 30px);font-size:calc(var(--font-base-size) * 19);outline:0;overflow-y:auto;transition:width .3s ease;box-sizing:border-box}.leftPane{grid-area:leftPane}.rightPane{grid-area:rightPane}.controls{display:grid;position:relative;min-height:0;width:100%;gap:10px;grid-template-areas:'leftPane rightPane';grid-template-columns:calc(var(--base-unit) * 12) auto;background-color:#fff;padding:20px;box-shadow:0 2px 6px rgba(0,0,0,.5)}:host([mode='settings']) .controls{grid-template-columns:1fr}:host([mode='solve']) .controls{grid-template-columns:1fr}:host([mode='puzzles']) .controls{height:100%;grid-template-columns:1fr;gap:0}.controls h2{margin-top:0;margin-bottom:10px}.settings{align-self:flex-start;user-select:none}.controls .puzzleInfo label,.settings label{display:block}.checkResults legend,.featureTable legend,.rules legend,.settings legend{text-align:right;margin-right:30px;font-size:calc(var(--font-base-size) * 25);font-weight:700}.rules{margin-top:0;display:none}:host([mode="play"]) .rules{display:block;position:relative;margin-bottom:5px;padding-bottom:0}.rules ul{position:relative;margin:0 auto;padding-top:0;list-style:none;padding-left:0;overflow-y:auto;max-height:100%}.rules::after{content:' ';position:absolute;height:25px;bottom:0;left:0;width:100%;background-image:linear-gradient(#fffFFF00,#fffFFF30 75%,#fff);pointer-events:none}.rules li{margin:10px}.rules li[constraints="fpuzzles"]{white-space:pre-wrap}:host([options~="showConflicts"]) .rules .violation{color:#dc143c;cursor:pointer}.puzzleInfo{display:none;position:relative;min-height:80px}:host([mode="play"]) .puzzleInfo{display:block}fieldset.checkResults{padding-top:3px;overflow-x:hidden;overflow-y:auto}button.solve{height:28px;width:100%}sudoku-keypad{height:calc(var(--base-unit) * 22)}sudoku-timer{margin-top:10px;height:calc(var(--base-unit) * 2.2);font-size:calc(var(--base-unit) * 1.5);line-height:calc(var(--base-unit) * 2.2);display:block}button.check{display:inline-block;position:relative;width:40px;height:30px;bottom:-4px;font-size:calc(var(--font-base-size) * 16);vertical-align:baseline}.solutions{display:none}:host([mode="edit"]) .solutions{display:block}@keyframes ellipsis{0%{content:'...'}8%{content:' ..'}16%{content:' \\a0 .'}24%{content:''}32%{content:' \\a0 .'}40%{content:' ..'}48%{content:'...'}54%{content:'..'}62%{content:'.'}70%{content:''}76%{content:''}84%{content:'.'}92%{content:'..'}100%{content:'...'}}.solutions .solutionCount.counting::after{content:'...';animation:ellipsis .9s linear infinite;width:20px}.featureEditForm legend{font-size:calc(var(--font-base-size) * 20);font-weight:700;text-align:center}.puzzleForm label div{width:60px;text-align:right}.puzzleForm input:not([type="radio"]):not([type="checkbox"]){width:calc(100% - 60px)}.puzzleForm .constraints label div{width:auto;text-align:left}:host(:not([mode="edit"])) .featureTable{display:none}.featureTable{grid-area:table;width:100%;position:relative}.featureTable .noelements{font-style:italic;padding:10px}.featureTable legend{text-align:center;font-weight:700}.featureTable h4{text-align:center;margin:0;padding:10px auto;border-bottom:2px solid #000;font-size:calc(var(--font-base-size) * 20)}puzzle-form{display:block;height:min-content}.puzzleForm{position:relative;display:flex;flex-flow:column;flex:0 0 100px;height:300px;padding:10px 10px 0;overflow:auto}.puzzleForm > *{flex:0 0 27px}.puzzleForm > label{height:27px;display:flex;flex-flow:row;max-width:calc(100% - 60px)}.puzzleForm > label input{flex-grow:2}.puzzleForm .children > label{margin-left:10px}.puzzleForm .constraints{margin-top:10px;height:200px;display:flex;flex-flow:column wrap;flex-grow:0 0}.puzzleForm .constraints > .section{break-inside:avoid}.puzzleForm .constraints label{height:27px}.puzzleForm h3{margin:0}.featureTable h4{margin:10px 0 0 0}.featureTable fieldset{padding:0;margin:0;padding-top:10px}.featureTable .tablescroll{max-height:252px;overflow-x:hidden;overflow-y:auto;scroll-behavior:smooth}.featureTable table{border-collapse:collapse;width:100%;padding-bottom:100px}.featureTable tr{height:22px;padding:0;width:100%;cursor:pointer;position:relative}.featureTable tr.highlight{background-color:#06d;color:#fff}.featureTable td{vertical-align:top;height:min-content;text-overflow:ellipsis;padding:5px;border-top:1px solid #000}.featureTable th{background-color:#eee;vertical-align:top;padding:6px;height:22px;text-align:left}.featureTable th .move{position:absolute;right:0;top:0}.featureTable th .move button{height:30px;width:30px;padding:0;margin:2px 0}.featureTable .field.choice{text-transform:capitalize}.sticky{top:0;position:sticky;position:-webkit-sticky;z-index:1}.featureTable .swatch{display:inline-block;height:16px;width:16px}.featureTable label{width:auto;height:auto;display:inline-block;text-transform:capitalize;white-space:nowrap}.featureTable .field{white-space:nowrap;display:inline-block;min-width:0;text-overflow:ellipsis;overflow-x:hidden;max-width:490px}.featureTable .field:not(:last-child)::after{content:'; ';display:inline-block;left:-5px;position:relative}.featureTable td{display:flex;flex-wrap:wrap}.featureEditForm label div{width:110px}.featureEditForm label{position:relative}.featureEditForm input:not([type="checkbox"]):not([type="radio"]){width:calc(100% - 120px)}.tip{padding:0 10px 10px;font-style:italic;color:grey;font-size:calc(var(--font-base-size) * 19)}.notification{position:absolute;top:125px;height:140px;width:calc(100% - 40px);margin:10px;padding:10px;background:#fff;border:1px solid #000;box-shadow:0 2px 4px #0000007F}.notification .close{position:absolute;top:3px;right:10px;cursor:pointer}.notification.rulesEditor{top:0;z-index:2;height:min-content;max-height:calc(100% - 30px);min-height:290px;width:calc(100% - 10px);position:absolute;margin:0;padding:0 10px;background:#fff;border:0;box-shadow:none;overflow:scroll}.notification.rulesEditor + .close{position:absolute;top:-5px;right:10px;z-index:2;cursor:pointer}.notification.rulesEditor > label:first-of-type{position:sticky;top:0;background-color:#fff;min-width:100%;height:30px;padding-bottom:10px}.rulesEditor .heading{display:grid;grid-auto-flow:column;width:100%;align-items:flex-end}.rulesEditor h4{text-align:left;border-bottom:0}.rulesEditor button{justify-self:flex-end;margin:10px 0 3px 0}.rulesEditor textarea{display:block;font-family:Helvetica;font-size:calc(var(--font-base-size) * 18);height:70px;width:100%;resize:vertical}.notification .filename,.notification .url{margin:10px auto;text-align:center}.notification a{color:#66e;text-decoration:underline}@media (max-width:1570px) and (orientation:landscape){.notification{height:190px}.puzzleForm{height:340px}.puzzleForm .constraints{height:240px}}@media (max-width:640px) and (orientation:portrait){.notification{height:190px}.puzzleForm{height:340px}.puzzleForm .constraints{height:240px}}@media (orientation:portrait){:host{--base-unit:2vw;margin:0 auto;width:min(99vw,70vh);overflow-y:unset}}@media only screen and (max-width:480px),only screen and (max-device-width:480px){:host{--font-base-size:.7px}}`,br=(e,t)=>ft` <svg class="${hr({icon:!0,[e]:!0})}" xmlns="http://www.w3.org/2000/svg" height="${t}" viewBox="0 0 24 24" width="${t}"> ${yr[e]} </svg>`,yr={undo:mt`<path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z">`,delete:mt`<path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z">`,redo:mt`<path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z">`,play:mt`><path d="M8 5v14l11-7z">`,pause:mt`<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z">`,fastforward:mt`<path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z">`,rewind:mt`<path d="M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z">`,palette:mt`<g> <path stroke="black" stroke-width="2" fill="none" d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8z"></path> <path d="m6.7,12c-1,0 -2,-0.9 -1.9,-1.9s0.9,-1.9 1.9,-1.9s1.9,0.9 1.9,1.9s-0.9,1.9-1.9,1.9z" fill="red"></path> <path d="m10,9c-1,0 -2,-0.9 -2,-2s0.89,-2 2,-2s2,0.89 2,2s-0.89,2 -2,2z" fill="green"></path> <path d="m14.5,9c-1,0 -1.9,-0.9 -1.9,-1.9s0.9,-1.9 1.9,-1.9s1.9,0.9 1.9,1.9s-0.9,1.9 -1.9,1.9z" fill="blue"></path> <path d="m17,12.8c-1,0 -1.9,-0.8 -1.9,-1.9s0.8,-1.9 1.9,-1.9s1.9,0.8 1.9,1.9s-0.8,1.9 -1.9,1.9z" fill="purple"></path> </g>`,corners:mt`<path d="M3 3v18h18V3H3zm16 16H5V5h14v14zM7 7h2v2H7zm8 0h2v2h-2zM7 15h2v2H7zm8 0h2v2h-2z">`,centers:mt`<path d="M3 3v18h18V3H3zm16 16H5V5h14v14zM8 11h2v2H8zM11 11h2v2H11zM14 11h2v2H14z">`,down:mt`<path d="M7 10l5 5 5-5z">`,up:mt`<path d="M7 14l5-5 5 5z">`,search:mt`<path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z">`,menuopen:mt`<path d="M3 18h13v-2H3v2zm0-5h10v-2H3v2zm0-7v2h13V6H3zm18 9.59L17.42 12 21 8.41 19.59 7l-5 5 5 5L21 15.59z">`,menu:mt`<path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z">`,collapse:mt`<path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z">`,expand:mt`<path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z">`,check:mt`<path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z">`,prev:mt`<path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z">`,next:mt`<path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z">`,close:mt`<path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z">`,help:mt`<path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z">`,plus:mt`<path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z">`,minus:mt`<path d="M19 13H5v-2h14v2z">`,download:mt`<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z">`,export:mt`<path d="M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z">`};var kr=Object.defineProperty,wr=(e,t,i)=>(((e,t,i)=>{t in e?kr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class xr extends Zt{updated(){const e=this.getRootNode().activeElement;e&&e.closest("form")||this.querySelector("[autofocus]")?.focus(),[...this.querySelectorAll('input[type="radio"][checked]')].forEach((e=>{e.checked=!0})),super.update()}checkValidity(e,t,i,o){switch(e.type){case"positions":{if(!pe(o))return i[t].setCustomValidity('Oops! Invalid format. Enter cell names like this "B3, C3,..." or "r2c3, r3c3,..."'),i[t].reportValidity(),!1;o=he(this.size,o);const e=Us.get(this.featureName);if(e.validatePositions){const s=e.validatePositions(this.size,o);if(s)return i[t].setCustomValidity(s),i[t].reportValidity(),!1}break}default:if(e.pattern&&o&&!new RegExp(e.pattern).test(o))return i[t].setCustomValidity("Oops! Invalid format. "+e.formatMessage),i[t].reportValidity(),!1}return!0}objectUpdated(e,t={},i={},o,s){let n=!1;for(let[r,a]of Object.entries(e))if(r in o||["section","boolean"].includes(a.type)){let e=o[r];if("positions"===a.type){if(s[r].setCustomValidity(""),s[r].value){if(s[r].value=e=e.replace(/\s*|,\s*$/g,""),!this.checkValidity(a,r,s,e))continue;if(e=he(this.size,e),t[r].every((t=>e.includes(t)))&&e.every((e=>t[r].includes(e))))continue;n=!0,t[r]=e}}else if("color"===a.type)n|=this.updateColor(i,r,e,a,t);else if("array"===a.type)if(s[r].setCustomValidity(""),"default"in a&&e==a.default)n|=this.deleteProperty(r,t);else{if(!this.checkValidity(a,r,s,e))continue;n=!0,e=e&&a.converters?.to?a.converters.to(e):fe(e,a.delimiter),t[r]=e}else"choice"===a.type?n|=this.updateChoice(a,e,r,t,o,i,s):"boolean"===a.type?n|=this.updateBoolean(a,"on"===e,r,t,o,i,s):"booleanSection"===a.type?n|=this.updateBooleanSection(a,e,r,t,i,o,s):"section"===a.type?n|=this.updateSection(a,t,i,r,o,s):"number"===a.type?n|=this.updateNumber(i,r,e,a,t):n|=this.updateOther(i,r,e,a,t)}else n|=this.deleteProperty(r,t);return n}updateSection(e,t,i,o,s,n){let r=!1;return e.template&&(r|=this.objectUpdated(e.template,"name"in e?t[e.name]:t,i[o],s,n)),r}updateOther(e,t,i,o,s){let n=!1;return null!=e[t]&&i==e[t]||null==e[t]&&"default"in o&&i==o.default?n|=this.deleteProperty(t,s):(n=!0,s[t]=i),n}updateColor(e,t,i,o,s){let n=!1;return null!=e[t]&&(i==e[t]||hs.get(i.toLowerCase())===e[t])||null==e[t]&&"default"in o&&(i==o.default||hs.get(i.toLowerCase())===o.default)?n|=this.deleteProperty(t,s):i==s[t]||s[t]&&hs.get(i.toLowerCase())===s[t]||(n=!0,s[t]=i),n}updateChoice(e,t,i,o,s,n,r){let a=!1;return"default"in e&&t==e.default?a|=this.deleteProperty(i,o):(a=!0,o[e.name??i]=e.value??t),e.choices[s[i]].template&&(a|=this.objectUpdated(e.choices[s[i]].template,o,n[i]?.[t],s,r)),a}updateBoolean(e,t,i,o,s,n,r){let a=!1;return"default"in e&&t==e.default?a|=this.deleteProperty(i,o):(a=!0,o[i]=t),a}updateBooleanSection(e,t,i,o,s,n,r){let a=!1;return"default"in e&&t==e.default?a|=this.deleteProperty(i,o):(a=!0,o[i]={}),i in o&&e.template&&(a|=this.objectUpdated(e.template,o[i],s[i],n,r)),a}updateNumber(e,t,i,o,s){let n=!1;return null!=e[t]&&i==e[t]||null==e[t]&&"default"in o&&i==o.default?n|=this.deleteProperty(t,s):(n=!0,s[t]=Number(i)),n}deleteProperty(e,t){if(e in t)return delete t[e],!0}formInputChanger(e,t){return e=>{}}formChanger(e,t){return e=>{}}buttonHandler(e){return e=>{e.preventDefault(),e.stopPropagation()}}anchorButtonHandler(e){return e=>{e.preventDefault(),e.stopPropagation()}}colorPickerToggler(e,t){return i=>{const o=i.target.parentElement.querySelector("color-picker"),s=i.target.parentElement.querySelector("input"),n=s.closest("form"),r=me(s.parentElement,(i=>{o.close();const s=hs.get(o.color)??o.color;s!==e&&s!==t&&ur.dispatch(_i(s)),r()}));o.addEventListener("change:color",(e=>{const t=e.detail.color;s.value=1!==t.alpha?t.hex8String:hs.get(t.hexString)??t.hexString;var i=document.createEvent("HTMLEvents");i.initEvent("change",!1,!0),n.dispatchEvent(i)})),[...this.querySelectorAll("color-picker")].filter((e=>e!==o)).forEach((e=>e.close())),o.toggle(),i.preventDefault(),i.stopPropagation()}}renderFormFields(e,t={},i){if(!e)return[];const o=[];for(const[s,n]of Object.entries(e))switch(n.type){case"positions":o.push(ft` <label><div>${n.label??s}${n.optional?"":"*"}</div> <input type="text" name="${s}" ?required="${!n.optional}" size="${20}" @keypress="${e=>e.target.setCustomValidity("")}" spellcheck="false" placeholder="${n.placeholder??"Select cells on the grid"}" value="${this.featureCellNames?.join(",")??""}" .value="${this.featureCellNames?.join(",")??""}">  </label> `);break;case"text":o.push(ft` <label><div>${n.label??s}${n.optional?"":"*"}</div> <input type="text" name="${s}" @input="${this.formInputChanger(e,i)}" ?required="${!n.optional}" placeholder="${Ni(n.placeholder??n.default)}" ?autofocus="${n.autofocus}" value="${i[s]??t[s]??""}" .value="${i[s]??t[s]??""}">  </label> `);break;case"array":{let t=ge(i[s]??n.default??[],n.delimiter??", ");n.converters?.from&&(t=n.converters.from(i[s])),o.push(ft` <label><div>${n.label??s}${n.optional?"":"*"}</div> <input type="text" name="${s}" @input="${n.onchange??1?this.formInputChanger(this.featureTemplate??e,i):e=>!0}" ?required="${!n.optional}" placeholder="${Ni(n.placeholder)}" ?autofocus="${n.autofocus}" value="${t}" .value="${t}"> </label> `);break}case"number":o.push(ft` <label><div>${n.label??s}${n.optional?"":"*"}</div> <input type="number" name="${s}" ?required="${!n.optional}" ?autofocus="${n.autofocus}" placeholder="${Ni(n.placeholder)}" @input="${this.formInputChanger(this.featureTemplate??e,i)}" min="${Ni(n?.range?.[0])}" max="${Ni(n?.range?.[1])}" step="${Ni(n?.step)}" value="${i[s]??t[s]??n.default}" .value="${i[s]??t[s]??n.default}"> </label> `);break;case"color":o.push(ft` <label><div>${n.label??s}${n.optional?"":"*"}</div> <input type="text" class="color" name="${s}" ?required="${!n.optional}" spellcheck="false" ?autofocus="${n.autofocus}" placeholder="${Ni(n.placeholder)}" value="${i[s]??t[s]??hs.get(n.default)??n.default}" .value="${i[s]??t[s]??hs.get(n.default)??n.default}"> <button type="button" style="background-color:${i[s]??t[s]??ps.get(n.default)??n.default}" class="colorPickerButton" @click="${this.colorPickerToggler(t[s]??n.default,i[s])}"></button> <color-picker color="${ps.get(i[s]??t[s]??n.default)??i[s]??t[s]??n.default}" .recentColors="${this.recentColors??[]}" ?alpha="${n.alpha}"> </color-picker> </label> `);break;case"choice":{let r;o.push(ft` <label class="choices"><div>${n.label??""}</div> ${Object.entries(n.choices).map((([t,o])=>{const a=!o.disabled&&(1===Object.values(n.choices).filter((e=>!e.disabled)).length||i?.[s]===(o.value??t)||n.default===(o.value??t));return a&&(r=t),ft` <label ?disabled="${o.disabled}" class="choice"><input @change="${this.formInputChanger(this.featureTemplate??e,i)}" type="radio" name="${s}" ?disabled="${o.disabled}" ?autofocus="${n.autofocus}" value="${t}" ?checked="${a}" .checked="${!!a}">${o.label??t}</label> `}))} </label> `),this.renderFormFields(n.choices[i?.[s]??Object.keys(n.choices)[0]].template,t[s]?.[r],i).forEach((e=>o.push(e)));break}case"boolean":{const t=s in i?!!i[s]:!!n.default;o.push(ft` <label class="boolean"><input @change="${this.formInputChanger(this.featureTemplate??e,i)}" type="checkbox" name="${s}" ?autofocus="${n.autofocus}" ?checked="${t}" .checked="${!!t}">${n.label??s}</label> `);break}case"booleanSection":{const e=s in i?!!i[s]:!!n.default;o.push(ft` <div class="section ${s}"> <label ?disabled="${n.disabled}" class="booleanSection"> <input type="checkbox" name="${s}" ?autofocus="${n.autofocus}" .checked="${e}" ?checked="${e}" ?disabled="${n.disabled}"> <div>${n.label??s}</div> </label> <div class="children"> ${n.template&&i[s]?ft` ${this.renderFormFields(n.template,t[s],i[s])} `:""} </div> </div> `);break}case"section":o.push(ft` <div class="section ${n.name}"> ${this.renderFormFields(n.template,t[s],n.name&&i[n.name]?i[n.name]:i)} </div> `);break;case"button":o.push(ft` <button ?disabled="${n.disabled}" @click="${this.buttonHandler(s)}" class="${s}" title="${n.tooltip}"> ${n.label??s} </button> `);break;case"anchorButton":{const e={[s]:!0,anchorButton:!0};o.push(ft` <a @click="${this.anchorButtonHandler(s)}" class="${hr(e)}" title="${n.tooltip}">${n.icon?br(n.icon,"17px"):""}${n.label??s}</a> `)}}return o}}wr(xr,"styles",vr),wr(xr,"properties",{recentColors:Array});var Cr,Sr=Object.defineProperty;class _r extends(Xt(ur)(xr)){constructor(){super(),this.select=this.createSelectors()}createSelectors(){const e=Bs((e=>e.game.present.puzzle)),t=Li([e.featureItem],(e=>e?.positions?.map((e=>te(this.size,e,"rncn"===this.settings.cellNameStyle)))));return{...e,...Pi,...qs,featureCellNames:t}}stateChanged(e){this.puzzle=this.select.puzzle(e),this.size=this.select.size(e),this.featureCellNames=this.select.featureCellNames(e),this.featureName=this.select.featureName(e),this.feature=this.select.feature(e),this.revertItem=this.select.revertItem(e),this.mode=this.select.mode(e),this.recentColors=this.select.recentColors(e),this.settings=this.select.settings(e)}updated(e){super.updated(e)}revertFeatureItem(e){ur.dispatch({type:"REVERT_FEATURE_ITEM"}),e.preventDefault(),e.stopPropagation()}saveFeatureItem(e){const t=e.target.closest("form");if(t.checkValidity()&&this.featureTemplate){const e=Object.fromEntries([...new FormData(t)]),i=Object.entries(this.featureTemplate),o=this.featureItem;i.every((([i,o])=>this.checkValidity(o,i,t,e[i])))&&(ur.dispatch(ki(o,e.defaultStyle)),this.objectUpdated(this.featureTemplate,o,this.feature.defaults,e,t),ur.dispatch((e=>({type:"SAVE_FEATURE_ITEM",item:e}))(o)),t.reset(),t.blur())}e.preventDefault(),e.stopPropagation()}deleteFeatureItem(e){const t=e.target.closest("form");ur.dispatch({type:"DELETE_FEATURE_ITEM"}),t.reset(),t.blur(),e.preventDefault(),e.stopPropagation()}formInputChanger(e,t){return this.formChanger(e,t)}formChanger(e,t){return t=>{const i=t.target.closest("form"),o=Object.fromEntries([...new FormData(i)]),s=this.featureItem;this.objectUpdated(e,s,this.feature.defaults,o,i)&&ur.dispatch(ki(s))}}renderFeatureForm(e,t={}){if("edit"===this.mode&&this.featureName){const i=Object.fromEntries(Object.entries(Hs(this.puzzle)).map((([e,t])=>[e,t.label?.()])))[this.featureName]??"",o=this.renderFormFields(e,this.feature?.defaults,t),s=ft`${e.type?ft`type "${e.type.choices[t.type]?.label??e.type.choices[e.type.default]?.label}"`:""}`,n=ft`${s?ft`${s} `:""}${i.endsWith("y")?i.replace(/y$/,"ie"):i}${i.match(/[xs]$/)?"e":""}s`,r=t._creating||JSON.stringify(t)!==JSON.stringify({...this.revertItem,_editing:!0}),a=!this.settings.hideEditTips&&e.tip?ft` <div class="tip">${e.tip}</div> `:"";return ft` <form id="featureItemForm" @submit="${this.saveFeatureItem}" class="featureEditForm" @change="${this.formChanger(e,t)}" autocomplete="off"> <fieldset> <legend>${t._creating?"New ":"Edit "}${i}</legend> ${a} ${o} <label><input type="checkbox" name="defaultStyle" @change="${this.featureDefaultStyle}">default style for ${n}</label> <button autofocus ?disabled="${!r}" type="submit">Save</button> ${t._editing?ft`<button autofocus @click="${this.revertFeatureItem}">${r?"Revert":"Cancel"}</button>`:""} <button @click="${this.deleteFeatureItem}" type="reset">${t._creating?"Cancel":"Delete"}</button> </fieldset> </form>`}}render(){return this.renderFeatureForm(this.featureTemplate,this.featureItem)}createRenderRoot(){return this}}((e,t,i)=>{t in e?Sr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(_r,"symbol"!=typeof(Cr="properties")?Cr+"":Cr,{mode:String,featureItem:Object,featureTemplate:Object,featureCellNames:String,featureName:String,feature:Object,size:Number,puzzle:Object,recentColors:Array,settings:Object}),customElements.define("sudoku-feature-item-form",_r);var Er=ie((function(e){var t=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={};function s(e,t){if(!o[e]){o[e]={};for(var i=0;i<e.length;i++)o[e][e.charAt(i)]=i}return o[e][t]}var n={compressToBase64:function(e){if(null==e)return"";var i=n._compress(e,6,(function(e){return t.charAt(e)}));switch(i.length%4){default:case 0:return i;case 1:return i+"===";case 2:return i+"==";case 3:return i+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:n._decompress(e.length,32,(function(i){return s(t,e.charAt(i))}))},compressToUTF16:function(t){return null==t?"":n._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:n._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=n.compress(e),i=new Uint8Array(2*t.length),o=0,s=t.length;o<s;o++){var r=t.charCodeAt(o);i[2*o]=r>>>8,i[2*o+1]=r%256}return i},decompressFromUint8Array:function(t){if(null==t)return n.decompress(t);for(var i=new Array(t.length/2),o=0,s=i.length;o<s;o++)i[o]=256*t[2*o]+t[2*o+1];var r=[];return i.forEach((function(t){r.push(e(t))})),n.decompress(r.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":n._compress(e,6,(function(e){return i.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),n._decompress(e.length,32,(function(t){return s(i,e.charAt(t))})))},compress:function(t){return n._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,i){if(null==e)return"";var o,s,n,r={},a={},l="",c="",u="",d=2,p=3,h=2,f=[],m=0,g=0;for(n=0;n<e.length;n+=1)if(l=e.charAt(n),Object.prototype.hasOwnProperty.call(r,l)||(r[l]=p++,a[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(r,c))u=c;else{if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(o=0;o<h;o++)m<<=1,g==t-1?(g=0,f.push(i(m)),m=0):g++;for(s=u.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1}else{for(s=1,o=0;o<h;o++)m=m<<1|s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s=0;for(s=u.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1}0==--d&&(d=Math.pow(2,h),h++),delete a[u]}else for(s=r[u],o=0;o<h;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1;0==--d&&(d=Math.pow(2,h),h++),r[c]=p++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(a,u)){if(u.charCodeAt(0)<256){for(o=0;o<h;o++)m<<=1,g==t-1?(g=0,f.push(i(m)),m=0):g++;for(s=u.charCodeAt(0),o=0;o<8;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1}else{for(s=1,o=0;o<h;o++)m=m<<1|s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s=0;for(s=u.charCodeAt(0),o=0;o<16;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1}0==--d&&(d=Math.pow(2,h),h++),delete a[u]}else for(s=r[u],o=0;o<h;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1;0==--d&&(d=Math.pow(2,h),h++)}for(s=2,o=0;o<h;o++)m=m<<1|1&s,g==t-1?(g=0,f.push(i(m)),m=0):g++,s>>=1;for(;;){if(m<<=1,g==t-1){f.push(i(m));break}g++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:n._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,i,o){var s,n,r,a,l,c,u,d=[],p=4,h=4,f=3,m="",g=[],v={val:o(0),position:i,index:1};for(s=0;s<3;s+=1)d[s]=s;for(r=0,l=Math.pow(2,2),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=i,v.val=o(v.index++)),r|=(a>0?1:0)*c,c<<=1;switch(r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=i,v.val=o(v.index++)),r|=(a>0?1:0)*c,c<<=1;u=e(r);break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=i,v.val=o(v.index++)),r|=(a>0?1:0)*c,c<<=1;u=e(r);break;case 2:return""}for(d[3]=u,n=u,g.push(u);;){if(v.index>t)return"";for(r=0,l=Math.pow(2,f),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=i,v.val=o(v.index++)),r|=(a>0?1:0)*c,c<<=1;switch(u=r){case 0:for(r=0,l=Math.pow(2,8),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=i,v.val=o(v.index++)),r|=(a>0?1:0)*c,c<<=1;d[h++]=e(r),u=h-1,p--;break;case 1:for(r=0,l=Math.pow(2,16),c=1;c!=l;)a=v.val&v.position,v.position>>=1,0==v.position&&(v.position=i,v.val=o(v.index++)),r|=(a>0?1:0)*c,c<<=1;d[h++]=e(r),u=h-1,p--;break;case 2:return g.join("")}if(0==p&&(p=Math.pow(2,f),f++),d[u])m=d[u];else{if(u!==h)return null;m=n+n.charAt(0)}g.push(m),d[h++]=n+m.charAt(0),n=m,0==--p&&(p=Math.pow(2,f),f++)}}};return n}();null!=e&&(e.exports=t)}));class zr extends Error{}const $r=(e,t=9)=>{const{row:i,col:o}=e.match(/R(?<row>\d)C(?<col>\d)/).groups;return ve(t,i-1,o-1)},Tr=(e,i=9)=>{const{row:o,col:s}=t(i,e);return[Ri(s+.5),Ri(o+.5)]},Or=e=>{switch(e.length){case 4:return m(m(Tr($r(e[0])),Tr($r(e[1]))),m(Tr($r(e[2])),Tr($r(e[3]))));case 2:return m(Tr($r(e[0])),Tr($r(e[1])));case 1:{let t=e[0],i=0,o=0;t.match(/R0|R10|C0|C10/)&&(t.match(/R0/)?(o=-100,t=t.replace(/R0/,"R1")):t.match(/R10/)&&(o=100,t=t.replace(/R10/,"R9")),t.match(/C0/)?(i=-100,t=t.replace(/C0/,"C1")):t.match(/C10/)&&(i=100,t=t.replace(/C10/,"C9")));const s=Tr($r(t));return s[0]+=i,s[1]+=o,s}}},Ir=e=>Er.decompressFromBase64(e),Ar=e=>Er.compressToBase64(e),Mr=t=>{const i=e=>$r(e,t.size),s={size:9,constraints:{row:{},column:{},box:{}}},n={};for(let[r,a]of Object.entries(t))switch(r){case"size":if(9!=~~a)throw new zr("puzzle size != 9");s.size=a;break;case"title":s.name=a;break;case"author":s.setter=a;break;case"highlightConflicts":s.disableViolationChecking=!0;break;case"ruleset":s.rules=a?.replace("Exported from sudokulab.net\n\n","");break;case"grid":s.givens=a.flatMap((e=>e.map((e=>e.given?e.value:0)))),n.values=a.flatMap((e=>e.map((e=>e.value??0)))),n.corners=a.flatMap((e=>e.map((e=>e.cornerPencilMarks?.join("")??"")))),n.centers=a.flatMap((e=>e.map((e=>e.centerPencilMarks?.join("")??"")))),s.constraints.rectangle=s.constraints.rectangle??{items:[]},a.forEach(((e,t)=>e.forEach(((e,i)=>{e.c&&s.constraints.rectangle.items.push({positions:[],point:[100*i,100*t],sizes:[100,100],stroke:"none",fill:e.c+"7F"})})))),a.some((e=>e.some((e=>"region"in e))))&&(delete s.constraints.box,s.constraints.region=s.constraints.region??{items:[]},s.constraints.region.items=a.reduce(((e,t,i)=>t.reduce(((e,t,o)=>{const n=Math.sqrt(s.size),r="region"in t?t.region:~~(i/n)*n+~~(o/n);return e[r]=e[r]??{},e[r].positions=e[r].positions??[],e[r].positions.push(ve(s.size,i,o)),e}),e)),s.constraints.region.items));break;case"diagonal+":s.constraints.diagonal=s.constraints.diagonal??{},s.constraints.diagonal.orientation="\\"===s.constraints.diagonal.orientation?"both":"/";break;case"diagonal-":s.constraints.diagonal=s.constraints.diagonal??{},s.constraints.diagonal.orientation="/"===s.constraints.diagonal.orientation?"both":"\\";break;case"antiknight":a&&(s.constraints.knightsmove={});break;case"antiking":a&&(s.constraints.kingsmove={});break;case"disjointgroups":a&&(s.constraints.disjointgroups={});break;case"nonconsecutive":a&&!t.negative?.includes("ratio")&&(s.constraints.consecutive={});break;case"extraregion":s.constraints.region=s.constraints.region??{items:[]},s.constraints.region.items=[...s.constraints.region.items,...a.map((e=>({positions:e.cells.map(i)})))];break;case"odd":s.constraints.oddeven=s.constraints.oddeven??{items:[]},a.forEach((e=>{s.constraints.oddeven.items.push({positions:[$r(e.cell)]})}));break;case"even":s.constraints.oddeven=s.constraints.oddeven??{items:[]},a.forEach((e=>{s.constraints.oddeven.items.push({type:"even",positions:[$r(e.cell)]})}));break;case"thermometer":s.constraints.thermo={items:a.flatMap((e=>e.lines.map((e=>({positions:e.map(i)})))))};break;case"palindrome":s.constraints.palindrome={items:a.flatMap((e=>e.lines.map((e=>({positions:e.map(i)})))))};break;case"killercage":s.constraints.killercage={items:a.map((e=>({sum:e.value?~~e.value:void 0,positions:e.cells.map(i)})))};break;case"littlekillersum":s.constraints.littlekiller={items:a.map((e=>({sum:e.value?~~e.value:void 0,positions:e.cells.map(i)})))};break;case"sandwichsum":s.constraints.sandwichsum={items:a.map((t=>({sum:t.value?~~t.value:void 0,positions:t.cell.includes("R0")?e(s.size,(e=>`R${e+1}C${t.cell[3]}`)).map(i):t.cell.includes(`R${s.size+1}`)?e(s.size,(e=>`R${s.size-e}C${t.cell.slice(-1)[0]}`)).map(i):t.cell.includes("C0")?e(s.size,(e=>`R${t.cell[1]}C${e+1}`)).map(i):t.cell.includes(`C${s.size+1}`)?e(s.size,(e=>`R${t.cell[1]}C${s.size-e}`)).map(i):void 0})))};break;case"difference":s.constraints.kropki=s.constraints.kropki??{items:[]},a.forEach((e=>{if(e.value&&1!=~~e.value)throw new zr("kropki dot with difference != 1");s.constraints.kropki.items.push({type:"consecutive",positions:e.cells.map(i)})}));break;case"ratio":s.constraints.kropki=s.constraints.kropki??{items:[]},a.forEach((e=>{if(e.value&&2!=~~e.value)throw new zr("kropki dot with ratio != 2");s.constraints.kropki.items.push({positions:e.cells.map(i)})}));break;case"negative":if(a.includes("ratio")){if(!t.nonconsecutive)throw new zr("negative kropki with no nonconsecutive constraint");s.constraints.kropki=s.constraints.kropki??{items:[]},s.constraints.kropki.negativeConstraint=!0}a.includes("xv")&&(s.constraints.xv=s.constraints.xv??{items:[]},s.constraints.xv.negativeConstraint=!0);break;case"clone":throw new zr("clones");case"arrow":if(a.some((e=>e.cells.length>1)))throw new zr("arrow with sum > 9");s.constraints.arrow={items:a.flatMap((e=>e.lines.map((e=>({positions:e.map(i)})))))};break;case"betweenline":s.constraints.betweenline={items:a.map((e=>({positions:e.lines.flatMap((e=>e.map(i)))})))};break;case"minimum":s.constraints.minmax=s.constraints.minmax??{items:[]},a.forEach((e=>{s.constraints.minmax.items.push({positions:[i(e.cell)]})}));break;case"maximum":s.constraints.minmax=s.constraints.minmax??{items:[]},a.forEach((e=>{s.constraints.minmax.items.push({type:"max",positions:[i(e.cell)]})}));break;case"xv":s.constraints.xv=s.constraints.xv??{},s.constraints.xv.items=a.map((e=>({type:"V"===e.value?"v":void 0,positions:e.cells.map(i)})));break;case"quadruple":s.constraints.quadruple={items:a.map((e=>({values:e.values.map((e=>`${e}`)),positions:e.cells.map(i)})))};break;case"text":s.constraints.text={items:a.filter((e=>e.value)).map((e=>({positions:[],point:Or(e.cells),size:100*e.size,color:e.fontC??"black",text:e.value??"",rotation:e.angle??void 0})))},a.find((e=>e.cells.some((e=>e.match(/R0|R10|C0|C10/)))))&&(s.constraints.gutter={});break;case"circle":s.constraints.ellipse={items:a.map((e=>({positions:[],point:Or(e.cells),sizes:[50*e.width,50*e.height],stroke:e.outlineC??"darkgrey",fill:e.baseC??"none",rotation:e.angle??void 0})))},s.constraints.text=s.constraints.text??{items:[]},a.filter((e=>e.value)).forEach((e=>{s.constraints.text.items.push({positions:[],point:Or(e.cells),fontSize:e.width/e.value.length+"px",text:e.value,stroke:e.fontC??"black",rotation:e.angle??void 0})})),a.find((e=>e.cells.some((e=>e.match(/R0|R10|C0|C10/)))))&&(s.constraints.gutter={});break;case"rectangle":s.constraints.rectangle={items:a.map((e=>{const t=Or(e.cells);return{positions:[],point:[t[0]-50*e.width,t[1]-50*e.height],sizes:[100*e.width,100*e.height],stroke:e.outlineC??"darkgrey",fill:e.baseC??"none",rotation:e.angle??void 0}}))},s.constraints.text=s.constraints.text??{items:[]},a.filter((e=>e.value)).forEach((e=>{s.constraints.text.items.push({positions:[],point:Or(e.cells),fontSize:e.width/e.value.length+"px",text:e.value,stroke:e.fontC??"black",rotation:e.angle??void 0})})),a.find((e=>e.cells.some((e=>e.match(/R0|R10|C0|C10/)))))&&(s.constraints.gutter={});break;case"line":s.constraints.path=s.constraints.path??{items:[]},a.forEach((e=>e.lines.map((t=>{s.constraints.path.items.push({positions:[],points:t.map((e=>Tr($r(e)))),stroke:e.outlineC,strokeWidth:50*e.width})}))));break;case"cage":s.constraints.path=s.constraints.path??{items:[]},a.forEach((e=>{const t=o(e.cells.map(i),.06,s.size).map((e=>e.map((([e,t])=>[Ri(e),Ri(t)]))));t.forEach((t=>{s.constraints.path.items.push({positions:[],points:t,closed:!0,stroke:e.outlineC,strokeDasharray:"8 4",strokeWidth:2.5})}))})),s.constraints.text=s.constraints.text??{items:[]},a.filter((e=>e.value)).forEach((e=>{const t=Tr(e.cells.map(i).sort(((e,t)=>e-t))[0]);t[0]-=40-4.5*e.value.length,t[1]-=30,s.constraints.text.items.push({positions:[],point:t,size:"16",text:e.value,stroke:e.fontC??"black"})}))}const{text:r,...a}=s.constraints;return r&&(s.constraints={...a,text:r}),s.setter&&!s.name&&(s.name="Untitled"),{puzzle:s,grid:n}},Lr=(e,t)=>{if(t&&t[e])return[...t[e]].map((e=>~~e))},Pr=(i,o={})=>{const s=i.size,n={size:s,title:i.name,author:i.setter,highlightConflicts:!i.disableViolationChecking&&void 0,ruleset:i.rules?.replace("Imported from f-puzzles.\n\n","")??`${Object.values(Ws.rules({game:{present:{puzzle:i}}})).join("\n\n")}\n\nExported from sudokulab.net`,grid:e(s,(t=>e(s,(e=>{const n=t*s+e,{palette:r,index:a}=o.cellColors[n]?.match(/(?<palette>.+)-(?<index>\d+)$/)?.groups??{},l=r?Vn[r][a-1].toString(16).padStart(6,0).toUpperCase():void 0;return{value:i.givens[n]||o.values?.[n]||void 0,given:!!i.givens[n]||void 0,centerPencilMarks:Lr(n,o.centerMarks),cornerPencilMarks:Lr(n,o.cornerMarks),c:l?`#${l}`:void 0}}))))},r=e=>te(s,e,!0).toUpperCase(),a=e=>{const t=e.map(ji).map((e=>e-.5)),i=t.map(Math.round);if(i[0]<0||i[0]>=s||i[1]<0||i[1]>=s)return[`R${i[1]+1}C${i[0]+1}`];{const e=[];return t[1]<i[1]?(e.push([i[0],i[1]-1]),t[0]<i[0]?(e.push([i[0]-1,i[1]]),e.push([i[0]-1,i[1]-1])):(e.push([i[0]+1,i[1]]),e.push([i[0]+1,i[1]-1]))):(e.push([i[0],i[1]+1]),t[0]<i[0]?(e.push([i[0]-1,i[1]]),e.push([i[0]-1,i[1]+1])):(e.push([i[0]+1,i[1]]),e.push([i[0]+1,i[1]+1]))),[[i,[i]],[m(i,e[0]),[i,e[0]]],[m(i,e[1]),[i,e[1]]],[m(i,e[2]),[i,...e]]].sort((([e],[i])=>re(t[0]-e[0],t[1]-e[1])-re(t[0]-i[0],t[1]-i[1])))[0][1].map((([e,t])=>`R${Math.round(t+1)}C${Math.round(e+1)}`))}};for(let[o,l]of Object.entries(i.constraints))switch(l=Q(l),l.items&&(l.items=l.items.filter((e=>!e._creating))),o){case"row":case"column":case"box":break;case"region":i.constraints.box?n.extraregion=l.items.map((({positions:e})=>({cells:e.map(r)}))):(l.items.forEach((({positions:e},i)=>{e.forEach((e=>{const{row:o,col:r}=t(s,e);n.grid[o][r].region=i}))})),l.items.length===s-1&&l.items.every((e=>e.positions.length===s))&&e(s**2).filter((e=>param.items.every((t=>!t.positions.includes(e))))).forEach((e=>{const{row:i,col:o}=t(s,e);n.grid[i][o].region=s-1})));break;case"diagonal":n["diagonal+"]="\\"!==l.orientation,n["diagonal-"]="/"!==l.orientation;break;case"knightsmove":n.antiknight=!0;break;case"kingsmove":n.antiking=!0;break;case"disjointgroups":n.disjointgroups=!0;break;case"consecutive":n.nonconsecutive=!0;break;case"oddeven":l.items.forEach((({type:e="odd",positions:t})=>{n[e]=n[e]??[],n[e].push({cell:r(t[0])})}));break;case"thermo":n.thermometer=l.items.map((({positions:e})=>({lines:[e.map(r)]})));break;case"palindrome":n.palindrome=l.items.map((({positions:e})=>({lines:[e.map(r)]})));break;case"killercage":n.killercage=l.items.map((({sum:e,positions:t})=>({value:`${e||""}`||void 0,cells:t.map(r).sort()})));break;case"littlekiller":n.littlekillersum=l.items.map((({sum:e,positions:i})=>{if(i.length>1){const{row:o,col:n}=t(s,i[0]),a=k(i[0]-i[1]).on((e=>-10===e),(e=>"DR")).on((e=>-8===e),(e=>"DL")).on((e=>10===e),(e=>"UL")).otherwise((e=>"UR"));return{value:`${e}`,cell:`R${o+1+(a.includes("D")?-1:1)}C${n+1+(a.includes("R")?-1:1)}`,direction:a,cells:i.map(r)}}switch(i[0]){case 0:return{value:`${e}`,cell:"R2C0",direction:"UR",cells:i.map(r)};case 8:return{value:`${e}`,cell:"R2C10",direction:"UL",cells:i.map(r)};case 72:return{value:`${e}`,cell:"R8C0",direction:"DR",cells:i.map(r)};case 80:return{value:`${e}`,cell:"R8C10",direction:"DL",cells:i.map(r)}}}));break;case"sandwichsum":n.sandwichsum=l.items.map((({sum:e,positions:i})=>{const{row:o,col:n}=t(s,i[0]),r=k(i[0]-i[1]).on((e=>-1===e),(e=>[-1,0])).on((e=>1===e),(e=>[1,0])).on((e=>-9===e),(e=>[0,-1])).otherwise((e=>[0,1]));return{value:`${e}`,cell:`R${o+1+r[1]}C${n+1+r[0]}`}}));break;case"kropki":if(l.negativeConstraint&&(n.negative=n.negative??[],n.negative.push("ratio"),n.nonconsecutive=!0),l.items){const e={double:"ratio",consecutive:"difference"};l.items.forEach((({type:t="double",positions:i})=>{const o=e[t];n[o]=n[o]??[],n[o].push({cells:i.map(r)})}))}break;case"arrow":n.arrow=l.items.map((({positions:e})=>({cells:[r(e[0])],lines:[e.map(r)]})));break;case"betweenline":n.betweenline=l.items.map((({positions:e})=>({lines:[e.map(r)]})));break;case"minmax":{const e={min:"minimum",max:"maximum"};l.items.forEach((({type:t="min",positions:i})=>{const o=e[t];n[o]=n[o]??[],n[o].push({cell:r(i[0])})}));break}case"xv":if(l.negativeConstraint&&(n.negative=n.negative??[],n.negative.push("xv")),l.items){const e={x:"X",v:"V"};l.items.forEach((({type:t="x",positions:i})=>{const o=e[t];n[o]=n[o]??[],n[o].push({cells:i.map(r)})}))}break;case"quadruple":n.quadruple=l.items.map((({values:e,positions:t})=>({values:e.map((e=>~~e)),cells:t.map(r).sort()})));break;case"text":n.text=n.text??[],l.items.forEach((e=>{n.text.push({size:((e.size??40)/100).toFixed(2),cells:a(e.point),fontC:ps.get(e.color)??e.color,value:e.text,angle:e.rotation??void 0})}));break;case"ellipse":n.circle=l.items.map((e=>({cells:a(e.point),width:e.sizes[0]/50,height:(e.sizes?.[1]??e.sizes[0])/50,outlineC:ps.get(e.stroke)??e.stroke,baseC:ps.get(e.fill)??e.fill,angle:e.rotation})));break;case"rectangle":n.rectangle=l.items.map((e=>{const t=~~e.sizes[0],i=~~(e.sizes?.[1]??e.sizes[0]);return{cells:a([~~e.point[0]+t/2,~~e.point[1]+i/2]),width:ji(t),height:ji(i),outlineC:ps.get(e.stroke)??e.stroke,baseC:ps.get(e.fill)??e.fill,angle:e.rotation}}));break;case"path":n.line=n.line??[],l.items.forEach((e=>{const t=e.points.map((e=>a(e)[0]));e.closed&&t.push(t[0]),n.line.push({lines:[t],outlineC:ps.get(e.stroke)??e.stroke,width:(e.strokeWidth??3)/50})}));break;case"renban":case"whispers":n.highlightConflicts=!1,n.line=n.line??[],l.items.forEach((e=>{n.line.push({lines:[e.positions.map(r)],outlineC:ps.get(e.stroke)??e.stroke??ps.get("lightgrey"),width:(e.strokeWidth??10)/50})}));break;case"inequality":n.highlightConflicts=!1,n.text=n.text??[],l.items.forEach((e=>{n.text.push({size:.6,cells:e.positions.map(r),fontC:ps.get(e.color)??e.color,value:">",angle:k(e.positions[0]-e.positions[1]).on((e=>-1===e),(e=>0)).on((e=>1===e),(e=>180)).on((e=>-9===e),(e=>90)).otherwise((e=>270))})})),n.inequality=l.items.map((e=>({cells:e.positions.map(r)})));break;case"magicsquare":n.highlightConflicts=!1,l.items.forEach((e=>{n.grid.forEach(((t,o)=>{t.forEach(((t,s)=>{const n=o*i.size+s;e.positions.includes(n)&&(t.c="#A8A8A8")}))}))})),n.magicsquare=l.items.map((e=>({cells:e.positions.map(r)})))}return n};var Nr=Object.defineProperty,Rr=(e,t,i)=>(((e,t,i)=>{t in e?Nr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class jr extends(Xt(ur)(xr)){constructor(){super(),this.addEventListener("keydown",(e=>{be(e.target)&&e.stopPropagation()})),this.select=this.createSelectors()}createSelectors(){return{...qs,...Pi,...Ws,...Gs}}stateChanged(e){this.rules=this.select.rules(e),this.defaultRules=this.select.defaultRules(e),this.labels=this.select.labels(e),this.grid=this.select.grid(e),this.puzzle=this.select.puzzle(e)}get template(){const t=Object.entries(ye).reduce(((e,[t,i])=>(e[i]={label:t,type:"booleanSection",disabled:!(["negativekropki","negativexv"].includes(i)||ke.get(i)?.enabled(this.puzzle)),template:ke.get(i)?.featureTemplate?.(this.puzzle)},e)),{});return{name:{label:"title",type:"text",optional:!0},setter:{type:"text",optional:!0},givens:{type:"array",optional:!0,onchange:!1,converters:{from:e=>e.map((e=>0===e?".":e)).join(""),to:t=>e(this.puzzle.size**2,(e=>Number(t[e])||0))}},buttons:{type:"section",name:"buttons",template:{clear:{type:"button",tooltip:"Clear puzzle."},editRules:{label:"rules",type:"button",tooltip:"Edit puzzle rules."},screenshot:{type:"anchorButton",tooltip:"Download a screenshot."},shortenurl:{label:location.search?.includes("pzl=")?"long url":"short url",type:"button",tooltip:"Create a short url."},ctc:{icon:"export",label:"ctc",type:"anchorButton",tooltip:"Open puzzle on Cracking the Cryptic website."},fpuzzles:{icon:"export",label:"f-puzzles",type:"anchorButton",tooltip:"Open puzzle on f-puzzles website."}}},constraints:{name:"constraints",type:"section",template:Object.entries(t).reduce(((e,[t,i],o,s)=>(e[o<s.length/2?"left":"right"].template[t]=i,e)),{left:{type:"section",template:{}},right:{type:"section",template:{}}})}}}buttonHandler(e){return t=>{switch(e){case"clear":ur.dispatch({type:"CLEAR_PUZZLE"}),t.preventDefault(),t.stopPropagation();break;case"shortenurl":{if(location.search?.includes("pzl=")){ur.dispatch(ti({...this.puzzle,alias:{}})),t.preventDefault(),t.stopPropagation();break}const e=ir(we(this.puzzle)),i="?puzzle="+e;fetch("https://api-ssl.bitly.com/v4/shorten",{method:"POST",headers:{Authorization:"Bearer a53f6cf70ecdf6c3eb3d1725b46c84ebc0bfa114","Content-Type":"application/json"},body:JSON.stringify({long_url:`https://sudokulab.net/${i}`})}).then((e=>e.json())).then((t=>{const i=`_${t.id.replace(/[^\/]+\//,"")}`,o=`?pzl=${i}`;ur.dispatch(ti({...this.puzzle,alias:{[i]:e}})),history.replaceState({},"",o),this.pzlurl=location.href.replace(/\?.*$/,o),navigator.clipboard.writeText(`${this.pzlurl}`).then((e=>{this.notification="pzl",this.pzlNotificationClipboard=!0})).catch((e=>{this.notification="pzl",this.pzlNotificationClipboard=!1}))})),t.preventDefault(),t.stopPropagation();break}case"editRules":this.notification="rules",t.preventDefault(),t.stopPropagation();break;default:super.buttonHandler(e)(t)}}}anchorButtonHandler(e){return t=>{switch(e){case"fpuzzles":{const e=JSON.stringify(Pr(this.puzzle,this.grid));t.target.href=`https://f-puzzles.com/?load=${Ar(e)}`,t.target.target="_blank";break}case"ctc":{const e=JSON.stringify(Pr(this.puzzle,this.grid));t.target.href=`https://app.crackingthecryptic.com/sudoku/?puzzleid=fpuzzles${encodeURIComponent(Ar(e))}`,t.target.target="_blank";break}case"download":{const e=[...we(this.puzzle)].map((e=>String.fromCharCode(e))).join("");t.target.href=`data:application/octet-stream;base64,${btoa(e)}`,t.target.download=(this.puzzle.name?this.puzzle.name.replace(/ /g,"_"):"untitled")+".slab",this.downloadFilename=t.target.download,this.notification="download";break}case"screenshot":{let{name:e}=this.puzzle;t.preventDefault(),t.stopPropagation(),document.querySelector("sudoku-lab").shadowRoot.querySelector("sudoku-grid").renderScreenshot().then((t=>{const i=document.createElement("a");i.href=t,i.download=(e?e.replace(/ /g,"_"):"untitled")+".png",this.screenshotFilename=i.download,this.notification="screenshot",i.click()}));break}default:super.anchorButtonHandler(e)(t)}}}ruleResetter(e){return t=>{ur.dispatch({type:"RESET_RULE",constraint:e}),t.preventDefault(),t.stopPropagation()}}ruleSetter(e){return t=>{ur.dispatch({type:"SET_RULE",constraint:e,rule:t.target.value}),t.preventDefault(),t.stopPropagation()}}setViolationChecking(e){if(e.target.checked)ur.dispatch(ti({...this.puzzle,disableViolationChecking:!0}));else{const{disableViolationChecking:e,...t}=this.puzzle;ur.dispatch(ti(t))}e.preventDefault(),e.stopPropagation()}renderRulesNotification(){return"rules"===this.notification?ft` <form @change="${e=>e.preventDefault()}" class="notification rulesEditor"> <label><input @change="${this.setViolationChecking}" type="checkbox" name="disableViolationCheck" .checked="${this.puzzle.disableViolationChecking}"> Disable rule violation checks</label> ${Object.entries(this.rules).map((([e,t])=>{const i=this.defaultRules[e];return ft` <div class="heading"> <h4>${"box"===e?"Normal Sudoku":"fpuzzles"===e?"f-puzzles":this.labels[e]} Rules</h4> <button @click="${this.ruleResetter(e)}" ?disabled="${t===i}" name="reset">Reset</button> </div> <textarea @change="${this.ruleSetter(e)}" .value="${t.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")}"></textarea> `}))} </form> <div @click="${this.closeNotification}" class="close">${br("close","24px")}</div> `:""}renderPzlNotification(){return"pzl"===this.notification?ft` <div class="notification pzl"> Your short url is here: <div class="url"><a href="${this.pzlurl}">${this.pzlurl}</a></div> You can also find it in your browser's address bar${this.pzlNotificationClipboard?" and it has been copied into your clipboard":""}. <div @click="${this.closeNotification}" class="close">${br("close","24px")}</div> </div> `:""}renderDownloadNotification(){return"download"===this.notification?ft` <div class="notification download"> Your puzzle has been downloaded as: <div class="filename">${this.downloadFilename}</div> Your browser may alter the filename to avoid overwriting an existing file. To load your puzzle, just drag it anwhere onto sudokulab. <div @click="${this.closeNotification}" class="close">${br("close","24px")}</div> </div> `:""}renderScreenshotNotification(){return"screenshot"===this.notification?ft` <div class="notification"> Your screenshot has been downloaded as: <div class="filename">${this.screenshotFilename}</div> Your browser may alter the filename to avoid overwriting an existing file. <div @click="${this.closeNotification}" class="close">${br("close","24px")}</div> </div> `:""}closeNotification(e){this.notification=!1,e.preventDefault(),e.stopPropagation()}formChanger(){return e=>this.updatePuzzle(e)}formInputChanger(){return e=>this.updatePuzzle(e)}updatePuzzle(e){const t=e.target.closest("form"),i=Object.fromEntries([...new FormData(t)]),o="negativekropki"in i,s="negativexv"in i,n={constraints:Q(this.puzzle.constraints),givens:Q(this.puzzle.givens)};delete i.negativekropki,delete i.negativexv,this.objectUpdated(this.template,n,{},i,t)&&(o?(n.constraints.kropki=n.constraints.kropki||{},n.constraints.kropki.negativeConstraint=!0):n.constraints.kropki&&(delete n.constraints.kropki.negativeConstraint,n.constraints.kropki.items&&0!==n.constraints.kropki.items.length||delete n.constraints.kropki),s?(n.constraints.xv=n.constraints.xv||{},n.constraints.xv.negativeConstraint=!0):n.constraints.xv&&(delete n.constraints.xv.negativeConstraint,n.constraints.xv.items&&0!==n.constraints.xv.items.length||delete n.constraints.xv),t.checkValidity()&&ur.dispatch(ti(n)))}renderPuzzleForm(){const e={negativekropki:this.puzzle.constraints.kropki?.negativeConstraint,negativexv:this.puzzle.constraints.xv?.negativeConstraint},t=this.renderFormFields(this.template,{},{...this.puzzle,constraints:{...this.puzzle.constraints,...e}});return ft` <form @submit="${this.updatePuzzle}" class="puzzleForm" @change="${this.updatePuzzle}" autocomplete="off"> ${t} ${this.renderRulesNotification()} ${this.renderPzlNotification()} ${this.renderDownloadNotification()} ${this.renderScreenshotNotification()} </form> `}render(){return this.renderPuzzleForm()}createRenderRoot(){return this}}Rr(jr,"properties",{puzzle:Object,grid:Object,options:Object,notification:Boolean,rules:Object,defaultRules:Object,labels:Object}),Rr(jr,"styles",vr),customElements.define("puzzle-form",jr);var Dr=Object.defineProperty,Ur=(e,t,i)=>(((e,t,i)=>{t in e?Dr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class Fr extends(Xt(ur)(Zt)){constructor(){super(),this.select=this.createSelectors()}updated(){this.querySelector("tr.highlight")?.scrollIntoViewIfNeeded?.()}createSelectors(){const e=Bs((e=>e.game.present.puzzle));return{...Pi,...e,...qs,...Ks}}stateChanged(e){this.puzzle=this.select.puzzle(e),this.options=e.ui.options,this.settings=e.ui.settings,this.size=this.puzzle.size,this.featureName=this.select.featureName(e),this.featureItem=this.select.featureItem(e),this.featureCellNames=this.select.featureCellNames(e),this.featureTemplate=this.select.featureTemplate(e),this.revertItem=this.select.revertItem(e),this.highlightFeatureName=this.select.highlightFeatureName(e),this.highlightFeatureItemIndex=this.select.highlightFeatureItemIndex(e),this.mode=this.select.mode(e),this.gridIteration=this.select.gridIteration(e)}renderTableFields(e,t){const i=[];for(const[o,s]of Object.entries(e))if(o in t||"choice"===s.type&&e[o].default){const n=[],r=t[o];switch(s.type){case"positions":n.push(ft` <div class="field positions"> <label>${s.label??o}: </label> ${r.map((e=>te(this.size,e,"rncn"===this.settings.cellNameStyle))).join(",")} </div> `);break;case"number":case"text":n.push(ft` <div class="field ${s.type}"> <label>${s.label??o}: </label> ${r} </div> `);break;case"color":n.push(ft` <div class="field color"> <label>${s.label??o}: </label> <div class="swatch" style="background-color:${r}"></div> ${hs.get(r.toLowerCase())??r.toLowerCase()} </div> `);break;case"choice":{const i=r||e[o].default;n.push(ft` <div class="field choice"> <label>${s.label??o}: </label> ${i} </div> ${s.choices[i].template?ft` ${this.renderTableFields(s.choices[i].template,t)} `:""} `);break}case"array":{const e=ge(r,s.delimiter??"");n.push(ft` <div class="field array"> <label>${s.label??o}: </label> ${e} </div> `);break}}i.push(n)}return i}renderFeatureTableItem(e,t,i,o){const s=t.template;return ft` <td>${this.renderTableFields(s,i)}</td> `}moveFeatureUp(e){return t=>{const i=Object.keys(this.puzzle.constraints).filter((e=>!["row","column","box"].includes(e))),o=i.indexOf(e),s=i[o-1];ur.dispatch(Ei(e,s))}}moveFeatureDown(e){return t=>{const i=Object.keys(this.puzzle.constraints).filter((e=>!["row","column","box"].includes(e))),o=i.indexOf(e),s=i[o+1];ur.dispatch(Ei(e,s))}}renderFeatureTable(){const e=Object.fromEntries(Object.entries(Hs(this.puzzle)).map((([e,t])=>[e,{label:t.label?.(),template:t.itemTemplate?.()}]))),t=Object.keys(this.puzzle.constraints).filter((e=>!["row","column","box"].includes(e)));let i=xe(t.map((e=>this.puzzle.constraints[e].items?.filter((e=>!e._creating)).length??0)));return ft` <div class="featureTable"> <fieldset> <legend>Puzzle Configuration</legend> <puzzle-form .options="${this.options}"></puzzle-form> <h4>Puzzle Elements</h4> <div class="tablescroll"> <table> <tbody> ${0===i?ft` <tr> <td class="noelements">There are no puzzle elements. You can add some using the keypad.</td> </tr> `:ft` ${t.map(((o,s)=>{const n=this.puzzle.constraints[o].items?.filter((e=>!e._creating));return n?(i+=n.length,n.map(((i,n)=>{const r={highlight:this.highlightFeatureName===o&&this.highlightFeatureItemIndex===n};return[0===n?ft` <tr> <th class="sticky"> ${e[o].label} ${t.length>1?ft` <div class="move"> <button @click="${this.moveFeatureUp(o)}" ?disabled="${0===s}" class="up"> ${br("up",30)}</button><button @click="${this.moveFeatureDown(o)}" ?disabled="${s===t.length-1}" class="down"> ${br("down",30)} </button> </div> `:""} </th> </tr> `:"",ft` <tr class="${hr(r)}" @click="${this.featureItemSelector(o,n)}" @mouseenter="${this.featureItemHighlighter(o,n)}" @mouseleave="${this.unhighlightFeatureItem}"> ${this.renderFeatureTableItem(o,e[o],i._editing?this.revertItem:i,n)} </tr> `]}))):[]}))} `} </tbody> </table> </div> </fieldset> </div> `}featureItemHighlighter(e,t){return i=>{this.highlightFeatureItemIndex===t&&this.highlightFeatureName===e||ur.dispatch(xi(e,t))}}unhighlightFeatureItem(e){this.highlightFeatureName&&void 0!==this.highlightFeatureItemIndex&&ur.dispatch({type:"UNHIGHLIGHT_FEATURE_ITEM"})}featureItemSelector(e,t){return i=>{ur.dispatch(wi(e,t))}}render(){return this.renderFeatureTable()}createRenderRoot(){return this}}Ur(Fr,"properties",{mode:String,options:Object,settings:Object,featureItem:Object,featureTemplate:Object,featureCellNames:String,size:Number,puzzle:Object}),Ur(Fr,"styles",vr),customElements.define("sudoku-feature-table",Fr);const Hr=Rt`form,input{font-size:18px;font-family:Helvetica}label{position:relative;display:block;text-transform:capitalize;height:27px;max-width:max-content}label[disabled]{color:#a9a9a9}label div{display:inline-block;width:100px;text-align:right}label:not(.choices) div::after{content:':'}label input[type="checkbox"] ~ div::after{content:''}label .info{position:absolute;right:-22px;fill:grey;bottom:0}label.choice{display:inline-block}input{outline:0;border:0;appearance:none;-webkit-appearance:none;border-bottom:1px solid #a9a9a9;text-overflow:ellipsis;background-color:transparent;position:relative}input[disabled]::before,input[type="checkbox"][disabled]::before,input[type="radio"][disabled]::before{border-color:#ddd}input[type="checkbox"][disabled]:checked::before,input[type="radio"][disabled]:checked::before{background-color:#ddd}input:focus{border-color:#06d}input[type="radio"]{border:0}input[type="radio"]::before{content:"";width:8px;height:8px;display:inline-block;position:relative;top:1px;border:2px solid #a9a9a9;border-radius:10px;padding:2px;margin-right:1px}input[type="radio"]:focus::before{border-color:#06d}input[type="radio"]:checked::before{box-shadow:#fff 0 0 0 2px inset;background-color:#000}input[type="checkbox"]{border:0}input[type="checkbox"]::before{content:"";width:8px;height:8px;display:inline-block;position:relative;top:1px;border:2px solid #a9a9a9;border-radius:2px;padding:2px;margin-right:2px}input[type="checkbox"]:focus::before{border-color:#06d}input[type="checkbox"]:checked::before{box-shadow:#fff 0 0 0 2px inset;background-color:#000}input[type="number"]::-webkit-inner-spin-button{-webkit-appearance:none}input:not([type="radio"]):not([type="checkbox"]){min-width:100px}button:not(.colorPickerButton){height:28px;font-size:18px;margin-top:10px}a.anchorButton,button{appearance:none;-webkit-appearance:none;outline:0;border:1px solid #a9a9a9;border-radius:3px;background-color:#eee;cursor:pointer;white-space:nowrap}a.anchorButton{color:unset;text-decoration:none;padding:2px 8px 3.5px;margin-left:1px}a.anchorButton[disabled],button[disabled]{background-color:#eeeEEE5F}button[disabled] svg path{fill:#a9a9a9}a.anchorButton:focus,button:focus{border:1px solid #06d}.anchorButton svg{margin-bottom:-3px;margin-right:2px}.colorPickerButton{display:inline-block;position:absolute;width:30px;height:21px;right:5px;border-radius:2px;border-width:1px;vertical-align:bottom;cursor:pointer;outline-offset:3px;outline-color:#06d}color-picker{position:absolute;width:max-content;height:max-content;top:-340px;right:0;z-index:1;box-shadow:0 2px 3px rgba(0,0,0,.5)}color-picker[alpha]{right:-50px;top:-350px}`
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,Br=dr(class extends pr{constructor(e){var t;if(super(e),1!==e.type||"style"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,i)=>{const o=e[i];return null==o?t:t+`${i=i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${o};`}),"")}update(e,[t]){const{style:i}=e.element;if(void 0===this.vt){this.vt=new Set;for(const e in t)this.vt.add(e);return this.render(t)}this.vt.forEach((e=>{null==t[e]&&(this.vt.delete(e),e.includes("-")?i.removeProperty(e):i[e]="")}));for(const e in t){const o=t[e];null!=o&&(this.vt.add(e),e.includes("-")?i.setProperty(e,o):i[e]=o)}return gt}}),Wr=Rt`*{box-sizing:border-box}:host{position:relative;display:block;--base-unit:1vw}.keypad{position:relative;height:100%;display:grid;place-items:center;grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(5,1fr);font-weight:400;gap:calc(var(--base-unit) * .5)}.key{font-family:Helvetica;display:inline-flex;position:relative;width:100%;height:100%;padding:1px 0;align-items:center;justify-content:center;border:1px solid grey;border-radius:calc(var(--base-unit) * .25);font-size:calc(var(--base-unit) * 2.8);text-transform:lowercase;background-color:#eee;outline:0;cursor:pointer}.keypad div{text-align:center;font-size:calc(var(--base-unit) * .7)}.key:active:not([disabled]),.key[active]:not([disabled]){color:#000;background-color:#fff;box-shadow:inset 0 0 calc(var(--base-unit) * .1) #000}.key:active:focus:not([disabled]),.key:focus,.key:focus svg,.key[active]:focus:not([disabled]){border-color:#06d}:host([mode="play"][keyMode="corners"]) .key.digit{font-size:calc(var(--base-unit) * 1.3);padding-left:8px;padding-right:8px}:host([keyMode="centers"]) .key.digit{font-size:calc(var(--base-unit) * 1.8)}:host([keyMode="corners"]) .key[value="1"],:host([keyMode="corners"]) .key[value="4"],:host([keyMode="corners"]) .key[value="7"]{justify-content:flex-start}:host([keyMode="corners"]) .key[value="3"],:host([keyMode="corners"]) .key[value="6"],:host([keyMode="corners"]) .key[value="9"]{justify-content:flex-end}:host([keyMode="corners"]) .key[value="1"],:host([keyMode="corners"]) .key[value="2"],:host([keyMode="corners"]) .key[value="3"]{padding-bottom:calc(var(--base-unit) * 2.3)}:host([keyMode="corners"]) .key[value="7"],:host([keyMode="corners"]) .key[value="8"],:host([keyMode="corners"]) .key[value="9"]{padding-top:calc(var(--base-unit) * 2.3)}:host([keyMode="colors"]:not([mode="edit"])) .key.digit{color:transparent}.key.feature,.key:not(.digit){display:flex;flex-direction:column}.key.digit .description,.key.keyMode .description{bottom:0}.key.digit .icon{height:calc(var(--base-unit) * 2.5);width:calc(var(--base-unit) * 2.5);position:relative;margin:auto}.key.digit .icon img{height:calc(var(--base-unit) * 2.6);width:calc(var(--base-unit) * 2.6)}.key .icon svg{height:calc(var(--base-unit) * 2.3);width:calc(var(--base-unit) * 2.3)}.key[disabled] .icon svg path{fill:#a9a9a9}.key.keyMode .icon{height:calc(var(--base-unit) * 2.3);width:calc(var(--base-unit) * 2.3);position:relative}.key.keyMode .icon img{position:relative;height:calc(var(--base-unit) * 2);width:100%;display:block}:host([mode="edit"]) .key.keyMode .icon{border:0}.key.keyMode[value="colors"] .icon .red{background-color:#dc143c}.key.keyMode[value="colors"] .icon .green{background-color:#90ee90}.key.keyMode[value="colors"] .icon .blue{background-color:#00bfff}.key.keyMode[value="colors"] .icon .yellow{background-color:#ff0}@media (orientation:portrait){:host{--base-unit:1.8vw}}`;var Vr=Object.defineProperty,Gr=(e,t,i)=>(((e,t,i)=>{t in e?Vr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class qr extends(Xt(ur)(Zt)){constructor(){super(),this.select=this.createSelectors()}createSelectors(){return{...Pi,...Ws,...qs,...Vs,...Ks}}stateChanged(e){this.options=this.select.options(e),this.mode=this.select.mode(e),this.keyMode=this.select.keyMode(e),this.selectedCells=this.select.selectedCells(e),this.values=this.select.values(e),this.givens=this.select.givens(e),this.undoDisabled=0===e.game.past.length,this.redoDisabled=0===e.game.future.length,this.featureName=this.select.featureName(e),this.featureItem=this.select.featureItem(e),this.puzzle=this.select.puzzle(e),this.size=this.select.size(e),this.candidates=this.select.candidates(e),this.cellColors=this.select.cellColors(e),this.cornerMarks=this.select.cornerMarks(e),this.centerMarks=this.select.centerMarks(e),this.palette=this.select.palette(e),this.nextPalette=this.select.nextPalette(e),this.prevPalette=this.select.prevPalette(e)}undo(e){ur.dispatch(on.undo())}redo(e){ur.dispatch(on.redo())}paletteSetter(e){return t=>{ur.dispatch((e=>({type:"SET_PALETTE",offset:e}))(e))}}keyModeSetter(e){return t=>ur.dispatch(mi(e))}keyModeToggler(e){return t=>ur.dispatch(mi(this.keyMode===e?"values":e))}digitKey(e){return t=>{switch(this.mode){case"play":{if(!this.selectedCells.length)return;const t=this.selectedCells.filter((e=>0===this.puzzle.givens[e]));switch(this.keyMode){case"values":ur.dispatch(ii(t,e,this.puzzle,this.options));break;case"centers":ur.dispatch(pi(t,e));break;case"corners":ur.dispatch(ui(t,e,this.options.autoCandidates&&this.candidates,this.puzzle));break;case"colors":ur.dispatch(gi(this.selectedCells,`${this.palette}-${e}`,this.puzzle))}break}case"edit":switch(this.keyMode){case"values":ur.dispatch(si(this.selectedCells,e));break;case"centers":case"corners":case"colors":ur.dispatch({type:"TOGGLE_FEATURE_NAME",featureName:e})}}}}clearCell(e){switch(this.mode){case"edit":case"solve":switch(this.keyMode){case"values":{const e=this.selectedCells.some((e=>0!==this.puzzle.givens[e])),t=this.selectedCells.some((e=>0!==this.values[e]&&0===this.puzzle.givens[e])),i=this.selectedCells.some((e=>this.options.autoCandidates?""!==this.candidates[e]:""!==this.cornerMarks[e])),o=this.selectedCells.some((e=>""!==this.centerMarks[e])),s=this.selectedCells.some((e=>0!==this.cellColors[e]));e?ur.dispatch(ni(this.selectedCells,this.puzzle,this.options)):"corners"===this.keyMode||i&&!t?ur.dispatch(di(this.selectedCells,this.options.autoCandidates&&this.candidates,this.puzzle)):"centers"===this.keyMode||o&&!t?ur.dispatch(hi(this.selectedCells,this.puzzle)):"colors"===this.keyMode||s&&!t?ur.dispatch(vi(this.selectedCells,this.puzzle)):ur.dispatch(oi(this.selectedCells,this.puzzle,this.options));break}case"corners":case"centers":case"colors":ur.dispatch({type:"DELETE_FEATURE_ITEM"})}break;case"play":{if(!this.selectedCells.length)return;const e=this.selectedCells.filter((e=>0===this.puzzle.givens[e])),t=this.selectedCells.some((e=>0!==this.values[e]&&0===this.puzzle.givens[e])),i=this.selectedCells.some((e=>this.options.autoCandidates?""!==this.candidates[e]:""!==this.cornerMarks[e])),o=this.selectedCells.some((e=>""!==this.centerMarks[e])),s=this.selectedCells.some((e=>0!==this.cellColors[e]));"corners"===this.keyMode?ur.dispatch(di(e,this.options.autoCandidates&&this.candidates,this.puzzle)):"centers"===this.keyMode?ur.dispatch(hi(e,this.puzzle)):"colors"===this.keyMode?ur.dispatch(vi(this.selectedCells,this.puzzle)):t?ur.dispatch(oi(e,this.puzzle,this.options)):i?ur.dispatch(di(e,this.options.autoCandidates&&this.candidates,this.puzzle)):o?ur.dispatch(hi(e,this.puzzle)):s&&ur.dispatch(vi(this.selectedCells,this.puzzle))}}}deleteCellsSetValue(e){ur.dispatch(Oi(this.selectedCells))}addCellsSetValue(e){ur.dispatch(Ti(this.selectedCells))}isDigitDisabled(e){const t="values"===this.keyMode&&this.values.filter((t=>t==e)).length===this.size;return"values"===this.keyMode&&e>this.size||t}renderDigits(){if("play"===this.mode||"values"===this.keyMode){const t=e=>"colors"===this.keyMode?{backgroundColor:`var(--cell-color-${this.palette}-${e+1})`}:{};return e(9,(e=>ft` <button ?disabled="${this.isDigitDisabled(e+1)}" class="key digit" style="${Br(t(e))}" @click="${this.digitKey(e+1)}" value="${e+1}"> ${e+1} </button> `))}if("edit"===this.mode){const t=[...Fs[this.keyMode].entries()].map((([e,t],i)=>ft` <button ?disabled="${this.isDigitDisabled(i+1)}" class="key digit feature" feature="${t}" ?active="${this.featureName===t}" @click="${this.digitKey(t)}"> <div class="icon"><img src="${Us.get(t).icon()}"></div> <div class="description">${e}</div> </button> `)),i=(9-t.length)%9;return[...t,...e(i,(e=>ft`<button class="key" disabled="disabled"></button>`))]}}render(){const e=this.selectedCells.some((e=>0===this.values[e]||"play"!==this.mode||0===this.givens[e]||this.cornerMarks[e].length||this.centerMarks[e].length||0!==this.cellColors[e])),t=k(this.mode).on((e=>"play"===e),(t=>!e)).on((e=>"edit"===e),(t=>"values"===this.keyMode?!e:!this.featureName&&!this.featureItem)).otherwise((e=>!0)),i=localStorage.getItem("SET coloring")&&"play"===this.mode&&"colors"===this.keyMode,o="colors"===this.keyMode;return ft` <div class="keypad"> ${this.renderDigits()} <button class="key" ?disabled="${!o&&(i?!this.selectedCells.length:this.undoDisabled)}" title="Undo" @click="${o?this.paletteSetter(-1):i?this.addCellsSetValue:this.undo}" value="undo"> <div class="icon">${br(o?"prev":i?"plus":"undo","20px")}</div> <div class="description">${o?`${this.prevPalette}`:i?"SET":"Undo"}</div> </button> <button class="key" title="Delete" @click="${this.clearCell}" ?disabled="${t}" value="delete"> <div class="icon">${br("delete","20px")}</div> <div class="description">Delete</div> </button> <button class="key" ?disabled="${!o&&(i?!this.selectedCells.length:this.redoDisabled)}" title="Redo" @click="${o?this.paletteSetter(1):i?this.deleteCellsSetValue:this.redo}" value="redo"> <div class="icon">${br(o?"next":i?"minus":"redo","20px")}</div> <div class="description">${o?`${this.nextPalette}`:i?"SET":"Redo"}</div> </button> <button class="key keyMode" @click="${this.keyModeToggler("corners")}" ?active="${"corners"===this.keyMode}" value="corners"> <div class="icon"> ${"edit"===this.mode?ft` <img style="top:10%" src="${Us.get("arrow").icon()}"> `:br("corners","20px")} </div> <div class="description">${"edit"===this.mode?"cell elems":"Corners"}</div> </button> <button class="key keyMode" @click="${this.keyModeToggler("centers")}" ?active="${"centers"===this.keyMode}" value="centers"> <div class="icon"> ${"edit"===this.mode?ft` <img height="43" width="43" src="${Us.get("kropki").icon()}"> `:br("centers","20px")} </div> <div class="description">${"edit"===this.mode?"grid elems":"Centers"}</div> </button> <button class="key keyMode" @click="${this.keyModeToggler("colors")}" ?active="${"colors"===this.keyMode}" value="colors"> <div class="icon">${"edit"===this.mode?ft` <img src="${Us.get("path").icon()}"> `:br("palette","20px")}</div> <div class="description">${"edit"===this.mode?"cosmetics":"Colors"}</div> </button> </div> `}}Gr(qr,"properties",{mode:{type:String,reflect:!0},keyMode:{type:String,reflect:!0},values:Array,givens:Array,options:Object,size:Number,puzzle:Object,featureName:String,featureItem:Object,selectedCells:Array,undoDisabled:Boolean,redoDisabled:Boolean,candidates:Array,cornerMarks:Array,centerMarks:Array,cellColors:Array,palette:String,nextPalette:String,prevPalette:String}),Gr(qr,"styles",Wr),customElements.define("sudoku-keypad",qr);var Kr=Object.defineProperty;const Yr=e=>{var t;return t=class extends e{constructor(){super()}firstUpdated(e){super.firstUpdated(e),this.filterInput=(this.shadowRoot??this).querySelector("input.filter"),this.filterableItems=[...(this.shadowRoot??this).querySelectorAll(".filterable")],this.filterableSections=[...new Set([...(this.shadowRoot??this).querySelectorAll(".filterableSection")])]}filterItems(){if(!this.filter?.trim())return this.filterableItems.forEach((e=>e.classList.remove("filterHidden"))),void this.filterableSections.forEach((e=>e.classList.remove("filterHidden")));this.filterableItems.forEach((e=>e.classList.add("filterHidden"))),this.filterableSections.forEach((e=>e.classList.add("filterHidden")));const e=[...new Set(this.filter.matchAll(/(['"])(?<quoted>[^\1]+)\1|\b(?<unquoted>\w+)\b/g))].map((({groups:e})=>e.quoted??e.unquoted)),t=new RegExp(e.map((e=>`(${e})`)).join("|"),"gi");[...this.filterableItems].filter((i=>new Set(i.textContent.toLowerCase().match(t)).size===e.length)).forEach((e=>{e.classList.remove("filterHidden")})),this.filterableItems.filter((e=>!e.classList.contains("filterHidden"))).forEach((e=>{let t=e.closest(".filterableSection");for(;t;)t.classList.remove("filterHidden"),t=t.parentElement.closest(".filterableSection")}))}updateFilter(e){this.filter!==e.target.value&&(this.filter=e.target.value)}updated(e){super.updated(e),this.filterableSections.length,this.filterItems()}},((e,t,i)=>{((e,t,i)=>{t in e?Kr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,t+"",{sections:Array,items:Array,filter:String})})(t,"properties"),t},Zr=Rt`:host{position:relative;width:100%;margin-top:0;margin-bottom:0}.settings{position:relative;overflow-y:hidden;padding-bottom:40px;height:calc(100vh - 150px)}.settingsContainer{overflow-y:auto;min-height:0;height:calc(100vh - 300px)}.settings fieldset{margin-bottom:10px}.settings h2{margin-top:0}.settings h4{margin-bottom:10px}.settings label{position:relative}.settings label div{width:165px;margin-right:10px}.settings label input:not([type="checkbox"]):not([type="radio"]){width:200px}.settings .filterableSection.filterHidden,.settings label.filterHidden{display:none}.filter{width:100%;height:24px;padding:0 0 0 20px}.icon.search{position:relative;fill:grey;top:-24px;left:-2px;width:20px;height:24px}.filter:focus ~ .icon.search{fill:#06d}custom-dropdown[name="cellNameStyle"]{text-transform:initial}.colorPickerButton{right:0;top:0}`;var Jr=Object.defineProperty,Xr=(e,t,i)=>(((e,t,i)=>{t in e?Jr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class Qr extends(Xt(ur)(Yr(Zt))){constructor(){super(),this.addEventListener("keydown",(e=>{be(e.target)&&e.stopPropagation()})),this.select=this.createSelectors()}stateChanged(e){this.options=this.select.options(e),this.puzzle=this.select.puzzle(e),this.settings=this.select.settings(e),this.recentColors=this.select.recentColors(e)}createSelectors(){return{...qs,...Ws}}optionToggler(e){return t=>{ur.dispatch(zi({...this.settings,[e]:!this.settings[e]}))}}settingsUpdater(e){return t=>{ur.dispatch(zi({...this.settings,[e]:t.target.checked||t.target.value})),t.preventDefault(),t.stopPropagation()}}solveSettingsUpdater(e){return t=>{ur.dispatch(zi({...this.settings,solutionCount:{...this.settings.solutionCount,[e]:"checked"in t.target?t.target.checked:t.target.value}})),t.preventDefault(),t.stopPropagation()}}colorPickerToggler(e,t){return i=>{const o=i.target.parentElement.querySelector("color-picker"),s=i.target.parentElement.querySelector("input"),n=s.closest("form"),r=me(s.parentElement,(i=>{o.close();const s=hs.get(o.color)??o.color;s!==e&&s!==t&&ur.dispatch(_i(s)),r()}));o.addEventListener("change:color",(e=>{const t=e.detail.color;s.value=1!==t.alpha?t.hex8String:hs.get(t.hexString)??t.hexString;var i=document.createEvent("HTMLEvents");i.initEvent("change",!1,!0),n?n.dispatchEvent(i):s.dispatchEvent(i)})),[...this.querySelectorAll("color-picker")].filter((e=>e!==o)).forEach((e=>e.close())),o.toggle(),i.preventDefault(),i.stopPropagation()}}render(){const e={givenBackgroundColor:{backgroundColor:this.settings.givenBackgroundColor},outlineColor:{backgroundColor:this.settings.selectionOutlineColor},selectionColor:{backgroundColor:this.settings.selectionColor}};return ft` <div class="settings"> <h2>Settings</h2> <input @input="${this.updateFilter}" class="filter" type="text" placeholder="Filter settings by name or value"> ${br("search","24px")} <div class="settingsContainer"> <fieldset class="playSettings filterableSection"> <legend>Play</legend> ${Ce({autoCandidates:"Automatic corner marks",autoClearMarks:"Automatically clear marks",staticCorners:"Static corner mark positioning",shadePeers:"Shade peers of selected cells",showConflicts:"Show rule violations",hideTimer:"Hide timer",autoCheck:"Automatically check grid when filled",dimColors:"Desaturate color of puzzle elements"},((e,t)=>ft` <label class="filterable"> <input type="checkbox" @click="${this.optionToggler(t)}" ?checked="${this.options[t]}"> ${e} </label> `))} <div class="filterableSection"> <h4>Digit key modifiers</h4> ${Ce({cornersModifier:"Corner marks",centersModifier:"Center marks",colorsModifier:"Colors"},((e,t)=>ft` <label class="filterable"><div>${e}</div> <custom-dropdown name="${t}" @change="${this.settingsUpdater(t)}" value="${this.settings[t]}"> <datalist> <option value="altKey">Alt key</option> <option value="ctrlKey">Control key</option> <option value="shiftKey">Shift key</option> <option value="none">none</option> </datalist> </custom-dropdown></label> `))} <label class="filteable"><input type="checkbox" ?checked="${this.settings.zxcvkeys}" @click="${this.optionToggler("zxcvkeys")}">F-Puzzles style ZXCV key modes</label> </div> <div class="filterableSection"> <h4>Cell selection key modifiers</h4> ${Ce({addRemoveModifier:"Add/Remove cells",rowModifier:"Select row",columnModifier:"Select column",boxModifier:"Select box"},((e,t)=>ft` <label class="filterable"><div>${e}</div> <custom-dropdown name="${t}" @change="${this.settingsUpdater(t)}" value="${this.settings[t]}"> <datalist> <option value="altKey">Alt key</option> <option value="ctrlKey">Control key</option> <option value="shiftKey">Shift key</option> ${navigator.platform.includes("Mac")?ft`<option value="metaKey">Cmd key</option>`:""} <option value="none">None</option> </datalist> </custom-dropdown></label> `))} </div> <div class="filterableSection"> <h4>Cell color settings</h4> <label class="filterable"> <div>Given background</div> <input @change="${this.settingsUpdater("givenBackgroundColor")}" type="text" class="color" name="givenBackgroundColor" spellcheck="false" value="${hs.get(this.settings.givenBackgroundColor)??this.settings.givenBackgroundColor}" .value="${hs.get(this.settings.givenBackgroundColor)??this.settings.givenBackgroundColor}"> <button type="button" style="${Br(e.givenBackgroundColor)}" class="colorPickerButton" @click="${this.colorPickerToggler(this.settings.givenBackgroundColor,this.settings.givenBackgroundColor)}"></button> <color-picker alpha color="${ps.get(this.settings.givenBackgroundColor)??this.settings.givenBackgroundColor}" .recentColors="${this.recentColors??[]}"></color-picker>  </label> <label class="filterable"> <div>Selection color</div> <input @change="${this.settingsUpdater("selectionColor")}" type="text" class="color" name="selectionColor" spellcheck="false" value="${hs.get(this.settings.selectionColor)??this.settings.selectionColor}" .value="${hs.get(this.settings.selectionColor)??this.settings.selectionColor}"> <button type="button" style="${Br(e.selectionColor)}" class="colorPickerButton" @click="${this.colorPickerToggler(this.settings.selectionColor,this.settings.selectionColor)}"></button> <color-picker alpha color="${ps.get(this.settings.selectionColor)??this.settings.selectionColor}" .recentColors="${this.recentColors??[]}"></color-picker>  </label> <label class="filterable"> <input type="checkbox" @click="${this.optionToggler("outlineSelection")}" ?checked="${this.options.outlineSelection}"> Outline cell selection </label> ${this.options.outlineSelection?ft` <label class="filterable"> <div>Outline Color</div> <input @change="${this.settingsUpdater("selectionOutlineColor")}" type="text" class="color" name="selectionOutlineColor" spellcheck="false" value="${hs.get(this.settings.selectionOutlineColor)??this.settings.selectionOutlineColor}" .value="${hs.get(this.settings.selectionOutlineColor)??this.settings.selectionOutlineColor}"> <button type="button" style="${Br(e.outlineColor)}" class="colorPickerButton" @click="${this.colorPickerToggler(this.settings.selectionOutlineColor,this.settings.selectionOutlineColor)}"></button> <color-picker alpha color="${ps.get(this.settings.selectionOutlineColor)??this.settings.selectionOutlineColor}" .recentColors="${this.recentColors??[]}"></color-picker>  </label> <label class="filterable"> <div>Outline Width</div> <input type="number" min="1" max="10" @input="${this.settingsUpdater("selectionOutlineSize")}" .value="${this.settings.selectionOutlineSize}"> </label> `:""} </div> </fieldset> <fieldset class="editSettings filterableSection"> <legend>Edit</legend> ${Ce({autoSolve:"Automatically count solutions when editing",hideEditTips:"Hide editor tips"},((e,t)=>ft` <label class="filterable"> <input type="checkbox" @click="${this.optionToggler(t)}" ?checked="${this.options[t]}"> ${e} </label> `))} <br> <label class="filterable"><div>Cell naming style</div><custom-dropdown name="cellNameStyle" @change="${this.settingsUpdater("cellNameStyle")}" value="${this.settings.cellNameStyle}"> <datalist> <option value="j9">A1 ... J9</option> <option value="rncn">r1c1 ... r9c9</option> </datalist> </custom-dropdown></label> </fieldset> <fieldset class="solveSettings filterableSection"> <legend>Solve</legend> <label class="filterable"> <div>Time limit</div> <custom-dropdown name="timeLimitMs" @change="${this.solveSettingsUpdater("timeLimitMs")}" value="${this.settings.solutionCount.timeLimitMs}"> <datalist> <option value="60000">1 Minute</option> <option value="600000">10 Minutes</option> <option value="3600000">1 Hour</option> <option value="Infinity">Never Give Up</option> </datalist> </custom-dropdown> </label> <label class="filterable"> <div>Solution limit</div> <custom-dropdown name="solutionLimit" @change="${this.solveSettingsUpdater("solutionLimit")}" value="${this.settings.solutionCount.solutionLimit}"> <datalist> <option value="1">1</option> <option value="100">100</option> <option value="1000">1,000</option> <option value="1000000">1,000,000</option> <option value="Infinity">Never Surrender</option> </datalist> </custom-dropdown> </label> <label class="filterable"><input @change="${this.solveSettingsUpdater("givensOnly")}" name="givensOnly" type="checkbox" .checked="${this.settings.solutionCount.givensOnly}" ?disabled="${this.givensOnly}"> Use givens only</label> <label class="filterable"><input @change="${this.solveSettingsUpdater("randomize")}" name="randomize" type="checkbox" .checked="${this.settings.solutionCount.randomize}"> Randomize search</label> <label class="filterable"><input @change="${this.solveSettingsUpdater("solutions")}" name="solutions" type="checkbox" .checked="${this.settings.solutionCount.solutions}"> Show solution${1===this.solutionCount?"":"s"}</label> <label class="filterable"><input @change="${this.solveSettingsUpdater("heatmap")}" name="heatmap" type="checkbox" .checked="${this.settings.solutionCount.heatmap}"> Show heatmap</label> <label class="filterable"><input @change="${this.solveSettingsUpdater("stats")}" name="stats" type="checkbox" .checked="${this.settings.solutionCount.stats}"> Show more stats</label> </fieldset> </div> </div> `}}Xr(Qr,"styles",[Hr,vr,Zr]),Xr(Qr,"properties",{options:Object,puzzle:Object,settings:Object,recentColors:Array}),customElements.define("sudoku-settings",Qr);const ea=Rt`*{box-sizing:border-box;font-family:Helvetica}:host{position:relative;display:inline-block;cursor:pointer}input.value{display:inline-block;cursor:pointer;min-width:0;width:100%}.arrow{position:absolute;top:2px;right:0}.choices{position:absolute;overflow:hidden;top:24px;left:0;width:100%;transform:scaleY(0);font-size:18px;background-color:#fff;z-index:1;box-shadow:0 0 2px rgba(0,0,0,.5);opacity:0;transform-origin:top left}.choices.open{opacity:1;transform:scaleY(1);transition:opacity 50ms ease-out,transform 25ms ease-in}.choice{padding:2px 4px}.choice:hover{background-color:#eee}.check{display:inline-block;width:14px}`;var ta=Object.defineProperty,ia=(e,t,i)=>(((e,t,i)=>{t in e?ta(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class oa extends Zt{constructor(){super(),this.choices=[]}disconnectedCallback(){super.disconnectedCallback(),this.clickOutsideListenerRemover()}firstUpdated(e){super.firstUpdated(e);try{if(this._internals=this.attachInternals(),this.form=this._internals.form,!this.form)throw new Error("no internals form")}catch(e){if(this.form=this.closest("form"),this.form){const e=document.createElement("input");e.style.display="none",e.name=this.name,e.value=this.value,this.hiddenInput=e,this.form.append(e)}}const t=this.querySelector("datalist");t&&(this.choices=Object.fromEntries([...t.querySelectorAll("option")].map((e=>[e.attributes.value.value,e.textContent])))),this.value&&this.choices&&(this.selection=Object.keys(this.choices).findIndex((e=>e===this.value)),this.label=Object.values(this.choices)[this.selection]),this.clickOutsideListenerRemover=me(this,(e=>{this.open=!1}))}toggleOpen(e){this.open=!this.open}selectChoice(e){return t=>{if(this.selection=e,this.value=Object.keys(this.choices)[e],this.label=Object.values(this.choices)[e],this.open=!1,this._internals?.setFormValue)this._internals.setFormValue(this.value);else if(this.hiddenInput){this.hiddenInput.value=this.value;let e=document.createEvent("HTMLEvents");e.initEvent("input",!0,!0),e.detail={value:this.value},this.hiddenInput.dispatchEvent(e),e=document.createEvent("HTMLEvents"),e.initEvent("change",!0,!0),e.detail={value:this.value},this.hiddenInput.dispatchEvent(e)}let i=document.createEvent("HTMLEvents");i.initEvent("input",!0,!0),i.detail={value:this.value},this.dispatchEvent(i),i=document.createEvent("HTMLEvents"),i.initEvent("change",!0,!0),i.detail={value:this.value},this.dispatchEvent(i),t.preventDefault(),t.stopPropagation()}}render(){return ft` <input @click="${this.toggleOpen}" class="value" type="text" .value="${this.label}" readonly="readonly"> <div @click="${this.toggleOpen}" class="arrow">${br(this.open?"collapse":"expand","20px")}</div> <div class="${hr({choices:!0,open:this.open})}"> ${Object.entries(this.choices).map((([e,t],i)=>ft` <div @click="${this.selectChoice(i)}" class="${hr({choice:!0,selected:i===this.selection})}" index="${i}" value="${e}"> <span class="check">${i===this.selection?br("check","14px"):""}</span>${t} </div> `))} </div> `}}ia(oa,"properties",{name:{type:String},value:{type:String},label:{type:String},selection:{type:Number},choices:{type:Object},open:{type:Boolean},form:{type:Object}}),ia(oa,"formAssociated",!0),ia(oa,"styles",[Hr,ea]),customElements.define("custom-dropdown",oa);const sa=Rt`:host{position:relative;width:100%;display:grid;grid-template-rows:350px auto;grid-auto-flow:rows;gap:10px}.bruteforceContainer{display:grid;grid-auto-flow:column;justify-content:space-between;grid-template-columns:repeat(2,1fr);overflow-y:hidden}.bruteforce legend,.logicalForm legend{font-size:20px;font-weight:700}.bruteforce form{display:flex;flex-flow:column;height:310px;width:300px}.bruteforce form > *{flex-grow:0;flex-shrink:0}.bruteforce form label{height:27px}.bruteforce form label div{width:120px}.bruteforce h4{margin:20px 0 10px 0}.bruteforce .browser{height:26px;line-height:1.3;vertical-align:middle;font-size:20px;border:1px solid #d3d3d3;display:grid;grid-template-columns:12% 12% auto 12% 12%;border-radius:4px}.bruteforce .browseSolutions button{position:relative;margin:0;top:-1px}.bruteforce .prev{border-radius:0;left:-2px}.bruteforce .next{border-radius:0;right:-2px}.bruteforce .download{left:-1px;border-radius:4px 0 0 4px}.bruteforce .play{right:-1px;border-radius:0 4px 4px 0}.bruteforce .solutionIndexContainer{text-align:center;margin:auto}.bruteforce input.solutionIndex{display:inline-block;width:53px;min-width:0}.solutionCountStats{width:280px;height:min-content}.solutionCountStats tr{height:26px}.solutionCountStats th{text-align:right;font-weight:400;width:155px}.solutionCountStats th::after{content:':';padding-right:10px}.solutionCountStats td{width:115px}custom-dropdown{height:27px;width:160px}button.solve{width:140px}.solutionSteps{margin-top:0;margin-bottom:0;padding-left:40px;overflow-y:auto;height:calc(100vh - 575px)}.substeps{margin-top:0;margin-bottom:0;list-style-type:lower-alpha;padding-left:20px}.step{padding:5px;cursor:pointer}.step:hover .rowCol{color:#00f}.step:hover .rowCol.impacted{color:#dc143c}.capitalize{text-transform:capitalize}@keyframes ellipsis{0%{content:'...'}8%{content:' ..'}16%{content:' \\a0 .'}24%{content:''}32%{content:' \\a0 .'}40%{content:' ..'}48%{content:'...'}54%{content:'..'}62%{content:'.'}70%{content:''}76%{content:''}84%{content:'.'}92%{content:'..'}100%{content:'...'}}fieldset{border-width:4px;border-style:outset;position:relative}fieldset.showing{border-width:4px;border-style:inset}.caret{position:relative;display:none}fieldset.showing .caret{position:absolute;top:10px;left:-19px;display:block}.caret:before{content:'';position:absolute;top:0;left:0;border-right:19px solid #6c6c6c;border-top:19px solid transparent;border-bottom:19px solid transparent}.caret:after{content:'';position:absolute;left:6px;top:6px;border-right:13px solid #fff;border-top:13px solid transparent;border-bottom:13px solid transparent}@media (orientation:portrait){fieldset.showing .caret{position:absolute;left:calc(50% - 14px);top:-29px;display:block}.caret:before{content:'';position:absolute;top:0;left:0;border-top:0;border-bottom:19px solid #6c6c6c;border-left:19px solid transparent;border-right:19px solid transparent}.caret:after{content:'';position:absolute;left:6px;top:6px;border-top:0;border-bottom:13px solid #fff;border-left:13px solid transparent;border-right:13px solid transparent}}.logicalForm .solving{display:inline}.logicalForm .solving::after,.solutionCountStats .counting::after{content:'...';animation:ellipsis .9s linear infinite;width:20px}`;var na=Object.defineProperty,ra=(e,t,i)=>(((e,t,i)=>{t in e?na(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class aa extends(Xt(ur)(Zt)){constructor(){super(),this.select=this.createSelectors(),this.addEventListener("keydown",(e=>{be(e.target)&&e.stopPropagation()}))}stateChanged(e){this.mode=this.select.mode(e),this.options=this.select.options(e),this.size=this.select.size(e),this.puzzle=this.select.puzzle(e),this.solutionCount=this.select.solutionCount.stats.count(e),this.solutionIndex=this.select.solutionCount.index(e),this.solutionCountStats=this.select.solutionCount.stats(e),this.counting=this.select.solutionCount.counting(e),this.solutionCountIdle=this.select.solutionCount.idle(e),this.solutionCountAbandoned=this.select.solutionCount.abandoned(e),this.solutionCountCancelled=this.select.solutionCount.cancelled(e),this.solutionCountCompleted=this.select.solutionCount.completed(e),this.solutionCountExhausted=this.select.solutionCount.exhausted(e),this.solutionCountEndTime=this.select.solutionCount.endTime(e),this.solutionCountStartTime=this.select.solutionCount.startTime(e),this.solutionCountRequirementCount=this.select.solutionCount.requirementCount(e),this.solutionCountRestrictionCount=this.select.solutionCount.restrictionCount(e),this.solutionCountOptionCount=this.select.solutionCount.optionCount(e),this.steps=this.select.logical.steps(e),this.settings=this.select.settings(e),this.givensOnly=this.select.givensOnly(e),this.showingSolutionType=this.select.showingSolutionType(e),this.logicalSolutionStep=this.select.logical.step(e),this.logicalSolutionSubstep=this.select.logical.substep(e),this.solving=this.select.logical.solving(e)}createSelectors(){return{...Pi,...Ws,...qs,...Vs,...Gs,givensOnly:Li([Ws.givens,Pi.values],((e,t)=>t.every(((t,i)=>0===t||0!==e[i]))))}}updated(e){super.updated(e),"steps"in Object.fromEntries([...e])&&(this.shadowRoot.querySelector(".solutionSteps").scrollTop=1e5)}cancelSolutionCount(e){ur.dispatch({type:"CANCEL_SOLUTION_COUNT"}),e.preventDefault(),e.stopPropagation()}updateSearchParams(e){const t=Object.fromEntries([...new FormData(e.target.closest("form"))]);ur.dispatch(zi({solutionCount:{heatmap:"heatmap"in t,givensOnly:"givensOnly"in t,randomize:"randomize"in t,solutions:"solutions"in t,stats:"stats"in t,timeLimitMs:t.timeLimit,solutionLimit:t.solutionLimit}})),this.bruteForceTimeLimit=t.timeLimit,this.bruteForceSolutionLimit=t.solutionLimit,this.bruteForceGivensOnly="givensOnly"in t,e.preventDefault(),e.stopPropagation()}requestSolutionCount(e){this.solutionsPlaying&&(clearInterval(this.solutionsPlaying),this.solutionsPlaying=!1),ur.dispatch({type:"REQUEST_SOLUTION_COUNT"}),e.preventDefault(),e.stopPropagation()}showLogicalSolution(e){"LOGICAL"!==this.showingSolutionType&&ur.dispatch($i("LOGICAL"))}showBruteForceSolution(e){"BRUTEFORCE"!==this.showingSolutionType&&ur.dispatch($i("BRUTEFORCE"))}downloadSolutions(e){ur.dispatch({type:"DOWNLOAD_SOLUTIONS"}),e.preventDefault(),e.stopPropagation()}solutionStepUpdater(e,t){return i=>{this.logicalSolutionStep===e&&this.logicalSolutionSubstep===t||ur.dispatch(((e,t)=>({type:"UPDATE_SOLUTION_STEP",step:e,substep:t}))(e,t)),i.preventDefault(),i.stopPropagation()}}computeElapsedTime(){const e=Date.now();let t;switch(this.solutionCountStats.status){case le:case W:t=0;break;case V:t=0===this.solutionCountStartTime?0:e-this.solutionCountStartTime;break;default:t=this.solutionCountEndTime-this.solutionCountStartTime}return t<0&&(t=0),t}renderElapsedTime(e){return`${(""+~~(e/6e4)).padStart(2,"0")}:${(""+~~(e/1e3)%60).padStart(2,"0")}.${(""+e%1e3).padEnd(3,"0")}`}renderBruteForceSolveForm(){const e=k(this.solutionCountStats.status).on((e=>e===W),(e=>"idle")).on((e=>e===le),(e=>"initializing")).on((e=>e===V),(e=>"counting")).on((e=>e===q),(e=>"cancelled")).on((e=>e===G),(e=>"timed out")).on((e=>e===K),(e=>"limit reached")).on((e=>e===Y),(e=>"completed")).otherwise((e=>"Unknown")),{deadends:t,depth:i,maxDepth:o,requirements:s,restrictions:n,options:r}=this.solutionCountStats,a=this.computeElapsedTime(),l=this.renderElapsedTime(a),c=[K,q,G].includes(this.solutionCountStats.status)?"≥ ":"",u={bruteforce:!0,showing:"BRUTEFORCE"===this.showingSolutionType};return ft` <fieldset class="${hr(u)}" @click="${this.showBruteForceSolution}" @focusin="${this.showBruteForceSolution}"> <legend>Brute Force Solver</legend> <div class="bruteforceContainer"> <form @submit="${e=>!1}" @input="${this.updateSearchParams}"> <label> <div>Time limit</div> <custom-dropdown name="timeLimit" @input="${this.updateSearchParams}" value="${this.settings.solutionCount.timeLimitMs}"> <datalist> <option value="60000">1 Minute</option> <option value="600000">10 Minutes</option> <option value="3600000">1 Hour</option> <option value="Infinity">Never Give Up</option> </datalist> </custom-dropdown> </label> <label> <div>Solution limit</div> <custom-dropdown name="solutionLimit" value="${this.settings.solutionCount.solutionLimit}"> <datalist> <option value="1">1</option> <option value="100">100</option> <option value="1000">1,000</option> <option value="1000000">1,000,000</option> <option value="Infinity">Never Surrender</option> </datalist> </custom-dropdown> </label> <label><input name="givensOnly" type="checkbox" .checked="${this.settings.solutionCount.givensOnly}" ?disabled="${this.givensOnly}"> Use givens only</label> <label><input name="randomize" type="checkbox" .checked="${this.settings.solutionCount.randomize}"> Randomize search</label> <label><input name="solutions" type="checkbox" .checked="${this.settings.solutionCount.solutions}"> Show solution${1===this.solutionCount?"":"s"}</label> <label><input name="heatmap" type="checkbox" .checked="${this.settings.solutionCount.heatmap}"> Show heatmap</label> <label><input name="stats" type="checkbox" .checked="${this.settings.solutionCount.stats}"> Show more stats</label> <button @click="${this.counting?this.cancelSolutionCount:this.requestSolutionCount}" class="solve">${this.counting?"Cancel":"Count solutions"}</button> ${"BRUTEFORCE"===this.showingSolutionType&&!this.counting&&this.settings.solutionCount.solutions&&this.solutionCount>0?ft` <div class="browseSolutions"> ${this.solutionCount>1?ft` <h4>Browse ${this.solutionCount>25e3?ft`last 25,000`:ft`${this.solutionCount}`} Solutions</h4> <div class="browser"> <button @click="${this.downloadSolutions}" class="download">${br("download","24px")}</button> <button ?disabled="${1===this.solutionCount}" @click="${this.prevSolution}" class="prev">${br("prev","24px")}</button> <div class="solutionIndexContainer"> Solution <input ?disabled="${!!this.solutionsPlaying||1===this.solutionCount}" class="solutionIndex" @input="${this.updateSolutionIndex}" .value="${this.solutionIndex+1}"> </div> <button ?disabled="${1===this.solutionCount}" @click="${this.nextSolution}" class="next">${br("next","24px")}</button> <button ?disabled="${1===this.solutionCount}" class="play" @click="${this.playSolutions}">${br(this.solutionsPlaying?"pause":"play","24px")}</button> </div> `:ft` <h4>1 Solution</h4> <button @click="${this.downloadSolutions}">${br("download","24px")}</button> `} </div> `:""} </form> <table class="solutionCountStats"> <tr><th>Status</th><td><div class="${hr({counting:this.counting})}">${e}</div></td></tr> <tr><th>Elapsed Time</th><td>${l}</td></tr> <tr><th>Solutions</th><td>${c}${this.solutionCount.toLocaleString()}</td></tr> ${this.settings.solutionCount.stats?ft` <tr> <th>Solutions/ms</th> <td>${0===a?"0":(this.solutionCount/a).toFixed(3).toLocaleString()}</td> </tr> <tr> <th>Dead Ends</th> <td>${t.toLocaleString()}</td> </tr> <tr> <th>Dead Ends/ms</th> <td>${0===a?"0":(t/a).toFixed(3).toLocaleString()}</td> </tr> <tr> <th>Current Depth</th> <td>${i} / 81</td> </tr> <tr> <th>Max Depth</th> <td>${o} / 81</td> </tr> <tr> <th>Requirements</th> <td>${s} / ${this.solutionCountRequirementCount}</td> </tr> <tr> <th>Restrictions</th> <td>${s+n} / ${this.solutionCountRequirementCount+this.solutionCountRestrictionCount}</td> </tr> <tr> <th>Options</th> <td>${r} / ${this.solutionCountOptionCount}</td> </tr> `:""} </table> </div> <div class="caret"></div> </fieldset> `}playSolutions(e){this.solutionsPlaying?(clearInterval(this.solutionsPlaying),this.solutionsPlaying=!1):this.solutionsPlaying=setInterval((e=>{ur.dispatch(Si((this.solutionIndex+1)%Math.min(this.solutionCount,25e3)))}),200),e.preventDefault(),e.stopPropagation()}updateSolutionIndex(e){const t=e.target.value.replace(/,./g);Number.isNaN(Number(t))||ur.dispatch(Si(Math.max(0,t-1)%Math.min(this.solutionCount-1,24999))),e.preventDefault(),e.stopPropagation()}nextSolution(e){ur.dispatch(Si((this.solutionIndex+1)%Math.min(this.solutionCount,25e3))),e.preventDefault(),e.stopPropagation()}prevSolution(e){ur.dispatch(Si(0===this.solutionIndex?Math.min(this.solutionCount-1,24999):this.solutionIndex-1)),e.preventDefault(),e.stopPropagation()}stepHighlighter(e,t,i,o){return s=>{ur.dispatch(((e,t,i,o)=>({type:"HIGHLIGHT_POSITIONS",index:e,subindex:t,positions:i,impactedPositions:o}))(e,t,i,o))}}unhighlightStep(e){ur.dispatch({type:"UNHIGHLIGHT_POSITIONS"})}renderRowCol(e,t){const i={rowCol:!0,impacted:t},o=Math.trunc(e/this.size);if("rncn"===this.settings.cellNameStyle){const t=e%this.size;return ft`<span class="${hr(i)}">r${o+1}c${t+1}</span>`}{const t=String.fromCharCode(65+(8===o?9:o));return ft`<span class="${hr(i)}">${t}${e%this.size+1}</span>`}}renderUnits(e){return this.renderCommaSeparated(e.map((([e,t])=>e+" "+(t+1))))}renderRowCols(e,t){return this.renderCommaSeparated(e.map((e=>this.renderRowCol(e,t))))}renderCommaSeparated(e){return e.map(((t,i)=>[t,0===i&&2===e.length?ft` and `:i===e.length-2&&e.length>2?ft`, and `:i<e.length-1?ft`, `:""]))}renderValues(e,t){return this.renderCommaSeparated(e.map((i=>i+(t||1!==e.length?"s":""))))}renderStep(e,t,i){const o={[$e]:"Naked",[ze]:"Hidden"},s=[void 0,"Single","Pair","Triple","Quadruple","Quintuple","Sextuple","Septuple","Octuple","Nonuple"],n=e=>s[e]??`${e}-tuple`,r=[void 0,"Box Line Reduction","X-Wing","Swordfish","Jellyfish","Squirmbag","Whale","Leviathan"],{type:a,n:l,values:c,positions:u,units:d,impactedPositions:p,impactedUnits:h}=i;switch(a){case"SUDOKU_SOLVER_STEP":{const o=Object.entries(i.assignments??{}).reduce(((e,[t,i])=>(i.forEach((i=>{e[i]=e[i]??[],e[i].push(t)})),e)),{}),s=Object.entries(i.eliminations??{}).reduce(((e,[t,i])=>(i.forEach((i=>{e[i]=e[i]??[],e[i].push(t)})),e)),{});return ft` <li @mouseover="${this.stepHighlighter(e,t,o,s)}" @mouseout="${this.unhighlightStep}" tabindex="0" class="step"> ${i.description} </li> `}case Z:return ft`<li @mouseover="${this.solutionStepUpdater(e)}" tabindex="0" class="step">Solution Complete</li>`;case J:return ft`<li @mouseover="${this.solutionStepUpdater(e)}" tabindex="0" class="step">Solution Incomplete</li>`;case Oe:{const o=Object.entries(i.constraints).reduce(((e,[t,i])=>Object.entries(i).reduce(((e,[t,i],o)=>i.reduce(((e,i)=>(e[i]=e[i]?e[i]+t:`${t}`,e)),e)),e)),{});return ft` <li tabindex="0" class="step" @mouseover="${this.stepHighlighter(e,t,[],o)}" @mouseout="${this.unhighlightStep}"> ${Object.entries(i.constraints).map((([e,t])=>ft` <span class="capitalize">${e}</span> constraint removed ${this.renderCommaSeparated(Object.entries(t).map((([e,t],i)=>ft` candidate ${this.renderValues([e])} from ${this.renderRowCols(t,!0)}`)))}. `))} </li> `}case Te:{const o=u.reduce(((e,t)=>(e[t]=c,e)),{});return ft` <li tabindex="0"> <div class="step" @mouseover="${this.stepHighlighter(e,t,[],o)}" @mouseout="${this.unhighlightStep}"> Contradiction found by placing ${this.renderValues(c)} in ${this.renderRowCols(u,!0)}. ${this.renderCommaSeparated(h.map((([e,t,i])=>ft`<span class="capitalize">${this.renderUnits([[e,t]])}</span> has no ${this.renderValues([...i],!0)}`)))}. ${p.length?ft`${this.renderRowCols(p,!0)} ha${p.length>1?"ve":"s"} no candidates.`:""} Removing candidate ${this.renderValues(c)} from ${this.renderRowCols(u,!0)}. </div> ${i.steps?.length?ft` <ol class="substeps"> ${i.steps.map(((t,i)=>this.renderStep(e,i,t)))} <li class="step" tabindex="0" @mouseover="${this.solutionStepUpdater(e,i.steps.length)}"> Contradiction: ${this.renderCommaSeparated(h.map((([e,t,i])=>ft`<span class="capitalize">${this.renderUnits([[e,t]])}</span> has no ${this.renderValues([...i],!0)}`)))}. ${p.length?ft`${this.renderRowCols(p,!0)} ha${p.length>1?"ve":"s"} no candidates.`:""} </li> </ol> `:""} </li> `}case $e:{const i=u.reduce(((e,t)=>(e[t]=c,e)),{}),s=[...u,...p].reduce(((e,t)=>(e[t]=c,e)),{});return ft` <li tabindex="0" class="step" @mouseover="${this.stepHighlighter(e,t,i,s)}" @mouseout="${this.unhighlightStep}"> ${o[a]} ${n(l)} ${l>1?"of":""} ${this.renderValues(c)} in ${this.renderUnits(d)} (at ${this.renderRowCols(u)}) ${p.length?ft`means ${this.renderValues(c)} ${l>1?"are no longer candidates":"is no longer a candidate"} at ${this.renderRowCols(p,!0)}`:""} </li> `}case ze:{const i=u.reduce(((e,t)=>(e[t]=c,e)),{}),s=[...u,...p].reduce(((e,t)=>(e[t]=c,e)),{});return ft` <li tabindex="0" class="step" @mouseover="${this.stepHighlighter(e,t,i,s)}" @mouseout="${this.unhighlightStep}"> ${o[a]} ${n(l)} ${l>1?"of":""} ${this.renderValues(c)} in ${this.renderUnits(d)} (at ${this.renderRowCols(u)}) means no other values are possible here ${p.length?ft`and ${this.renderValues(c)} ${l>1?"are no longer candidates":"is no longer a candidate"} at ${this.renderRowCols(p,!0)}`:""} </li> `}case Ee:{const i=h&&(l>1||h[0][0].match(/box/))?r[l]:`Pointing ${n(u.length)}`,o=u.reduce(((e,t)=>(e[t]=c,e)),{}),s=p.reduce(((e,t)=>(e[t]=c,e)),{});return ft` <li tabindex="0" class="step" @mouseover="${this.stepHighlighter(e,t,o,s)}" @mouseout="${this.unhighlightStep}"> ${i} of ${this.renderValues(c)}s in ${this.renderUnits(d)} (at ${this.renderRowCols(u)})${p.length?ft` means ${c[0]} can be eliminated from consideration ${h?ft`elsewhere in ${this.renderUnits(h)} at `:`at their mutual peer${1===p.length?"":"s"} `} ${this.renderRowCols(p,!0)}.`:""} </li> `}case _e:{const i=u.reduce(((e,t)=>(e[t]="",e)),{}),o=p.reduce(((e,t)=>(e[t]=c,e)),{});return ft` <li tabindex="0" class="step" @mouseover="${this.stepHighlighter(e,t,i,o)}" @mouseout="${this.unhighlightStep}"> ${this.renderRowCols(u,!0)} has ${c[0]} candidate but sees ${this.renderRowCols(p,!0)} which have the same color. </li> `}case Se:{const i=u.reduce(((e,t)=>(e[t]=c,e)),{}),o=p.reduce(((e,t)=>(e[t]=c,e)),{});return ft` <li tabindex="0" class="step" @mouseover="${this.stepHighlighter(e,t,i,o)}" @mouseout="${this.unhighlightStep}"> ${this.renderRowCols(u)} have different colors for candidate ${c[0]} but they ${2===u.length?"both":"all"} see ${this.renderRowCols(p,!0)} which means ${c[0]} can be eliminated from consideration from ${this.renderRowCols(p,!0)}. </li> `}}}requestLogicalSolve(){ur.dispatch({type:"REQUEST_LOGICAL_SOLVE"})}cancelLogicalSolve(){ur.dispatch({type:"CANCEL_LOGICAL_SOLVE"})}renderLogicalSolveForm(){const e={logicalForm:!0,showing:"LOGICAL"===this.showingSolutionType};return ft` <fieldset class="${hr(e)}" @click="${this.showLogicalSolution}" @focusin="${this.showLogicalSolution}"> <legend>Logical Solver</legend> <button @click="${this.solving?this.cancelLogicalSolve:this.requestLogicalSolve}">${this.solving?"Cancel":"Solve"}</button> ${this.solving?ft`<div class="solving">Solving</div>`:""} <ol class="solutionSteps"> ${this.steps.map(((e,t)=>this.renderStep(t,0,e)))} </ol> <div class="caret"></div> </fieldset> `}render(){return[this.renderBruteForceSolveForm(),this.renderLogicalSolveForm()]}}ra(aa,"properties",{mode:String,options:Object,size:Number,puzzle:Object,solutionCountStats:Object,counting:Boolean,solutionCountAbandoned:Boolean,solutionCountMaxFound:Boolean,solutionCountCompleted:Boolean,solutionIndex:Number,steps:Array,bruteForceGivensOnly:Boolean,bruteForceSolutionLimit:Number,bruteForceTimeLimit:Number,settings:Object,solutionCountEndTime:Number,solutionCountStartTime:Number,solutionCountRequirementCount:Number,solutionCountRestrictionCount:Number,solutionCountOptionCount:Number,solutionsPlaying:Number,givensOnly:Boolean,showingSolutionType:String,logicalSolutionStep:Number,logicalSolutionSubstep:Number,solving:Boolean}),ra(aa,"styles",[Hr,sa]),customElements.define("sudoku-solve",aa);var la=Object.defineProperty,ca=(e,t,i)=>(((e,t,i)=>{t in e?la(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class ua extends(Xt(ur)(Zt)){constructor(){super(),this.select=this.createSelectors()}createSelectors(){return{...Ws,...Pi,...Vs,...qs,...Gs,...Ks}}stateChanged(e){this.options=this.select.options(e),this.settings=this.select.settings(e),this.mode=this.select.mode(e),this.keyMode=this.select.keyMode(e),this.selectedCells=this.select.selectedCells(e),this.startTime=this.select.startTime(e),this.paused=this.select.paused(e),this.pauseTime=this.select.pauseTime(e),this.stopped=this.select.stopped(e),this.values=this.select.values(e),this.undoDisabled=0===e.game.past.length,this.redoDisabled=0===e.game.future.length,this.conflicts=this.select.conflicts(e),this.duplicates=this.select.duplicates(e),this.duplicatesByConstraint=this.select.duplicatesByConstraint(e),this.size=this.select.size(e),this.puzzle=this.select.puzzle(e),this.rules=this.select.rules(e),this.gutter=this.select.gutter(e),this.featureName=this.select.featureName(e),this.featureItem=this.select.featureItem(e),this.featureCellNames=this.select.featureCellNames(e),this.featureTemplate=this.select.featureTemplate(e),this.revertItem=this.select.revertItem(e),this.showCheckResults&&(this.showCheckResults=this.gridIteration===this.select.gridIteration(e)),this.gridIteration=this.select.gridIteration(e),this.puzzleIteration=this.select.puzzleIteration(e),this.solutionCount=this.select.solutionCount.stats.count(e),this.counting=this.select.solutionCount.counting(e),this.solutionCountAbandoned=this.select.solutionCount.abandoned(e),this.solutionCountCancelled=this.select.solutionCount.cancelled(e),this.solutionCountCompleted=this.select.solutionCount.completed(e),this.solutionCountExhausted=this.select.solutionCount.exhausted(e),this.unfilledCellCount=this.select.unfilledCellCount(e),this.filledCellCount=this.select.filledCellCount(e),this.options.autoCheck&&0===this.unfilledCellCount&&(this.showCheckResults=!0)}dispatch(e,t=!0){if(!this.paused||!t)return ur.dispatch(e)}conflictHighlighter(e){return t=>{if(this.options.showConflicts&&!this.puzzle.disableViolationChecking&&t.target.closest(".violation")){const t=[...new Set(e.flatMap((e=>this.duplicatesByConstraint[e])))];t.length&&this.dispatch((e=>({type:"HIGHLIGHT_CONFLICTS",positions:e}))(t))}}}unhighlightConflicts(e){e.target.closest(".violation")&&this.dispatch({type:"UNHIGHLIGHT_CONFLICTS"})}optionToggler(e){return t=>{this.dispatch(updateSettings({...this.settings,[e]:!this.settings[e]}))}}renderRulesContent(){const e=Object.entries(this.rules),t=e.find((([e])=>"box"===e))??e.find((([e])=>"region"===e));t?e.unshift(t):e.unshift(["box",`Place the digits 1 through ${this.puzzle.size} in each empty cell. Digits must not repeat within the same row or column.`]);const i=e.find((([e])=>"fpuzzles"===e)),o=i?{["Imported from f-puzzles.\n\n"+i[1]]:["fpuzzles"]}:e.filter(((e,i)=>0===i||e!==t)).reduce(((e,[t,i])=>(e[i]?e[i].push(t):e[i]=[t],e)),{});return ft` <ul> ${Object.entries(o).map((([e,t])=>{(t.includes("box")||t.includes("region")&&!Object.keys(this.puzzle.constraints).includes("box"))&&(t=[...t,"row","column"]);const i=!this.puzzle.disableViolationChecking&&t.some((e=>this.duplicatesByConstraint[e]));return ft` <li @mouseover="${this.conflictHighlighter(t)}" @mouseout="${this.unhighlightConflicts}" class="${i?"violation":""}" constraints="${t.join(" ")}"> ${e} </li>`}))} </ul> `}renderCheckResults(){const e=xe(this.conflicts.flatMap((e=>Object.values(e).map((e=>e.length))))),t=xe(this.duplicates.map((e=>e.length)))/2,i=e+t;let o;const s=this.puzzle.disableViolationChecking?"":ft` <p> <label> <input type="checkbox" @click="${e=>ur.dispatch(updateSettings({...this.settings,showConflicts:!this.settings.showConflicts}))}" ?checked="${this.settings.showConflicts}"> Show rules violations </label> </p> <p>You can always find this setting on the settings page.</p> `;if(0===this.unfilledCellCount)this.puzzle.disableViolationChecking||0!==i||this.stopped||ur.dispatch({type:"STOP_TIMER"}),o=ft`<p> ${this.puzzle.disableViolationChecking?ft` Rule violation checking has been disabled for this puzzle by the setter. `:0===i?ft` You did it! Everything looks correct. Great job! `:ft` There ${1===i?"is a":"are"} rules violation${1===i?"":"s"}. Would you like to see ${1===i?"it":"them"}? ${s} `} </p>`;else{const e=this.filledCellCount+this.unfilledCellCount;o=ft`<p> You've filled ${this.filledCellCount} of ${e} empty cell${1===e?"":"s"}${this.puzzle.disableViolationChecking?ft`. Rule violation checking has been disabled for this puzzle by the setter.`:0===i?ft` without violating any rules so far. `:ft` but there ${1===i?"is a":"are some"} rules violation${1===i?"":"s"}. Would you like to see ${1===i?"it":"them"}? ${s} `} </p>`}return ft`<fieldset class="checkResults"> <legend>${0===this.unfilledCellCount?"Results":"Progress"}</legend> ${o} </fieldset>`}cancelSolutionCount(){ur.dispatch({type:"CANCEL_SOLUTION_COUNT"})}requestSolutionCount(){ur.dispatch({type:"REQUEST_SOLUTION_COUNT"})}renderSolutions(){const e=`${this.solutionCount?.toLocaleString()} solution${1===this.solutionCount?"":"s"}`,t=`≥ ${Math.max(0,this.solutionCount-1).toLocaleString()} solution${1===this.solutionCount?"":"s"}`;return ft` <button @click="${this.counting?this.cancelSolutionCount:this.requestSolutionCount}" class="solve"> ${this.counting?"Cancel":"Count solutions"} </button> ${this.solutionCount&&this.counting?ft` <div class="solutionCount counting">${e}</div> `:this.solutionCountCompleted?ft` <div class="solutionCount">${e} (count completed)</div> `:this.solutionCount&&this.solutionCountExhausted?ft` <div class="solutionCount">${t} (limit reached)</div> `:this.solutionCountAbandoned?ft` <div class="solutionCount">${t} (timed out)</div> `:this.solutionCountCancelled?ft` <div class="solutionCount">${t} (cancelled)</div> `:this.counting&&0===this.solutionCount?ft` <div class="solutionCount counting">Counting solutions</div> `:""} `}renderControls(){return ft` <div class="leftPane"> <sudoku-keypad></sudoku-keypad> ${"play"!==this.mode||this.options.hideTimer?"":ft` <sudoku-timer .checkResults="${e=>this.showCheckResults=!0}"></sudoku-timer> `} <div class="solutions">${this.renderSolutions()}</div> </div> <div class="rightPane"> <div class="puzzleInfo"> <fieldset class="rules"> <legend>Rules</legend> ${this.renderRulesContent()} </fieldset> ${this.showCheckResults?ft`${this.renderCheckResults()}`:""} </div> <sudoku-feature-table></sudoku-feature-table> <sudoku-feature-item-form class="featureItemForm" .featureItem="${this.featureItem}" .featureTemplate="${this.featureTemplate}"> </sudoku-feature-item-form> </div> `}renderPuzzles(){return ft`<sudoku-puzzles></sudoku-puzzles>`}renderSolve(){return ft`<sudoku-solve></sudoku-solve>`}renderSettings(){return ft`<sudoku-settings></sudoku-settings>`}render(){return ft` <div class="controls" keyMode="${this.keyMode}"> ${"puzzles"===this.mode?this.renderPuzzles():"settings"===this.mode?this.renderSettings():"solve"===this.mode?this.renderSolve():this.renderControls()} </div> `}}ca(ua,"styles",[Hr,vr]),ca(ua,"properties",{options:{type:Object,reflect:!0,converter:Ie},settings:Object,puzzle:Object,gutter:{type:Boolean,reflect:!0},mode:{type:String,reflect:!0},keyMode:{type:String,reflect:!0},selectedCells:Array,values:Array,undoDisabled:Boolean,redoDisabled:Boolean,size:Number,startTime:Number,paused:{type:Boolean,reflect:!0},pauseTime:Number,stopped:Boolean,elapsedMs:Number,featureName:{type:String,reflect:!0},featureItem:Object,featureCellNames:Object,featureTemplate:Object,showCheckResults:Boolean,gridIteration:Number,puzzleIteration:Number,solutionCount:Number,counting:Boolean,solutionCountAbandoned:Boolean,solutionCountMaxFound:Boolean,solutionCountCompleted:Boolean}),customElements.define("sudoku-controls",ua);const da=[854151,1050504,1247113,1443722,1640076,1771149,1902222,2098831,2229904,2360977,2491793,2622866,2753939,2885012,3016085,3081622,3212695,3343767,3474584,3605657,3671194,3802266,3933339,4064412,4129948,4261021,4391838,4457374,4588447,4719519,4785056,4916129,4981409,5112482,5243554,5309091,5440163,5571236,5636516,5767588,5833125,5964197,6029734,6160806,6291878,6357159,6488231,6553767,6684839,6750376,6881448,6946984,7078056,7209128,7274664,7405736,7471528,7602600,7668136,7799208,7864744,7996072,8061608,8192936,8258472,8389800,8455335,8586663,8652199,8783526,8849318,8915110,9046437,9112229,9243557,9309348,9375140,9506467,9572259,9703586,9769377,9835425,9966752,10032543,10098335,10229662,10295453,10361245,10492572,10558363,10624410,10690202,10821529,10887320,10953111,11018902,11150229,11216020,11282068,11347859,11413650,11544977,11610768,11676559,11742350,11808397,11874188,11939979,12005770,12071561,12202888,12268680,12334471,12400518,12466309,12532100,12597891,12663682,12729473,12795264,12861055,12927102,12992893,13058684,13124475,13190266,13256058,13321849,13387640,13388151,13453942,13519733,13585524,13651315,13717106,13782897,13848945,13914736,13980527,13980782,14046573,14112364,14178155,14243946,14309994,14310249,14376040,14441831,14507622,14573413,14573924,14639715,14705507,14771298,14837089,14837344,14903391,14969182,15034973,15035229,15101020,15167067,15167322,15233113,15298904,15299159,15365207,15430998,15431253,15497044,15563091,15563346,15629137,15694929,15695440,15761231,15761486,15827277,15827788,15893579,15959371,15959882,16025673,16025928,16091975,16092230,16158021,16158532,16224324,16224579,16225090,16290881,16291136,16357183,16357438,16357950,16423741,16423996,16424507,16490298,16490809,16491064,16556856,16557367,16557622,16558133,16558388,16624435,16624691,16625202,16625457,16625968,16626223,16626735,16626990,16693037,16693292,16693804,16694059,16694570,16694826,16695337,16630313,16630568,16631079,16631335,16631847,16632358,16632614,16567589,16567845,16568357,16568869,16503588,16504100,16504612,16439332,16439844,16374820,16375077,16310053,16310565,16245285,16245797,16180774,16181286,16116006,16116519,16051495,15986215,15986727,15921703,15856678,15856933,15791908,15792417];v(Date.now());const pa=e=>{const{row:t,column:i}=e.match(/r(?<row>\d+)c(?<column>\d+)/);return 9*(t-1)+(i-1)},ha=e=>[...e.matchAll(/r\d+c\d+/g)].map((([e])=>e)).map(pa),fa={nakedSingle:e=>{const t=[pa(e.cell)],{name:i,value:o}=e;return{type:"NAKED_TUPLE",n:1,values:[o],positions:t}},hiddenSingle:e=>{const t=[pa(e.cell)],{name:i,value:o}=e;return{type:"HIDDEN_TUPLE",n:1,values:[o],positions:t}},fish:e=>{const t=(e=>{const t=[...e.matchAll(/r(?<row>\d+)|c(?<column>\d+)/g)],i=[];for(const{groups:e}of t)if(e.row)for(let t=0;t<9;++t)i.push(9*(e.row-1)+t);else if(e.column)for(let t=0;t<9;++t)i.push(9*t+(e.column-1));return i})(e.cellspec),i=ha(e.impactedcells),{value:o}=e;return{type:"FISHWINGS",n:e.cellspec.match(/[a-z]/g).length,values:[o],positions:t,impactedPositions:i}},tuple:e=>{const t=ha(e.cells),i=e.values.split(/, ?/),{unittype:o,unitnumber:s}=e,n=[o,s];return{type:"HIDDEN_TUPLE",n:i.length,values:i,units:n,impactedPositions:t}},solutionFound:e=>({type:"SOLUTION_COMPLETE"}),noSolution:e=>({type:"SOLUTION_INCOMPLETE"}),invalid:e=>({type:"SOLUTION_INCOMPLETE"})};new Map(Object.entries({nakedSingle:/^(?<name>Naked Single): (?<cell>r\d+c\d+) = (?<value>\d+)/,hiddenSingle:/^(?<name>Hidden single) (?<value>\d+) in (?<unittype>\w+) (?<unitnumber>\d+) (?<cell>r\d+c\d+)/,fish:/^(?<name>[-\w]+) on (?<cellspec>(?:r\d+)*(?:c\d+)*) for value (?<value>\d+), removing that value from (?<impactedcells>r\d+c\d+(?:, r\d+c\d+)*)/,feature:/^(?:Ratio|Difference|Thermo|Arrow at ): (?<cell>r\d+c\d+) cannot have values? (?<value>\d+(?:,\d+)*) as it would remove all candidates (?:\d+(?:,\d+)*) from (?<impactedcells>r\d+c\d+(?:, r\d+c\d+)*)/,tuple:/^(?<unittype>\w+) (?<unitnumber>\d+) has tuple (?<values>\d(?:,\d)*), removing those values from (?<cells>(?:r\d+c\d+(?:, r\d+c\d+)*))/,limited:/^(?<digit>\d+) is limited to (?<cells>(?:r\d+c\d+(?:, r\d+c\d+)*)) in (?<unittype>\w+) (?<unitnumber>\d+), which removes that value from (?<impactedcells>r\d+c\d+(?:, r\d+c\d+)*)/,solutionFound:/solution found/i,invalidPuzzle:/invalid/i,noSolution:/no logical steps/i}).map((([e,t])=>[t,fa[e]])));const ma="SharedArrayBuffer"in self,ga=e=>{let t,i,o,s,n,r,a,l=0,c=0,u=0,d=0,p=0,h=0,f=0,m=0;const g={header:8,solutions:25e3},v={...Ws,...Pi,...Vs,...qs,...Gs,...Ks},b=Ae()?new Worker("chunks/worker-b57f6349.chunk.js",{type:"module"}):new Worker("chunks/worker-iife-81e9e7cb.chunk.js"),y=e===Me&&"true"===localStorage.getItem("SudokuSolverConsole"),k=[],w=e=>k.includes(e)?void 0:k.push(e);w((e=>"CONNECT"===e.type?console.log("SudokuSolverConsole connected."):"CLOSED"===e.type?console.log("SudokuSolverConsole disconnected."):void 0));const x=y?((e,t)=>{let i,o=0;const s=[],n=e=>s.includes(e)?void 0:s.push(e),r=e=>s.splice(s.indexOf(e),1),a=e=>s.forEach((t=>t({type:"MESSAGE",payload:e}))),l=e=>s.forEach((t=>t({type:"ERROR",payload:e}))),c=e=>s.forEach((e=>e({type:"CLOSED"}))),u=e=>s.forEach((e=>e({type:"CONNECT"})));return n(t),{addListener:n,removeListener:r,connect:()=>(o=0,new Promise(((e,t)=>{if(i&&1===i.readyState)e();else try{i=new WebSocket("ws://localhost:4545"),i.addEventListener("message",a),i.addEventListener("error",l),i.addEventListener("close",c),i.addEventListener("open",(t=>{e(),u()}))}catch(e){t(e),l(e)}}))),solve(e,t,s){const n=Ar(JSON.stringify(Pr(e)));if(i&&1===i.readyState)try{return i.send(`fpuzzles:${o++}:solvepath:${n}`),!0}catch(e){l(e)}return!1},stepSolve(e,s,a){let c=!0;for(const[e,t]of a.entries())a[e]=s[e]?"":t;const u=i=>{if("MESSAGE"===i.type){const o=((e,t,i,o)=>{let s,n=!0;const r=/^(?<nonce>\d+):(?<candidates>[^:]+):(?<description>[\s\S]*)$/;if(e.match(/^\d+:Invalid/))s={description:"invalid puzzle"},n=!1;else{const{nonce:a,candidates:l,description:c}=e.match(r).groups;if(c.match(/No logical steps found/))s={description:"No logical steps found."},n=!1;else if(c.match(/Solution found!/))s={description:"Solution found!"},n=!1;else{const e=l.match(new RegExp(`.{${t.size}}`,"g")).map((e=>[...new Set([...e.replace(/\./,"")])].join(""))),n=e.reduce(((e,t,o)=>{if(!i[o]&&1===t.length){const i=~~t;e[i]=e[i]??[],e[i].push(o)}return e}),{}),r=e.reduce(((e,t,i)=>{if(t&&o[i]&&t!==o[i]){const s=[...o[i].replace(new RegExp(`[${t}]`,"g"),"")];for(const t of[...s])"."!==t&&(e[t]=e[t]??[],e[t].push(i))}return e}),{});s={assignments:n,eliminations:r,description:c},i=i.map(((t,i)=>t||(1===e[i].length?~~e[i]:0))),o=o.map(((t,o)=>0===i[o]?e[o]:void 0))}}return{proceed:n,step:s,puzzle:t,values:i,marks:o}})(i.payload.data,e,s,a);c=o.proceed,e=o.puzzle,s=o.values,a=o.marks,t({type:"SUDOKU_SOLVER_STEP",data:o.step}),c?d(e,s,a):r(u)}};n(u);const d=(e,t,s)=>{const n=Ar(JSON.stringify(Pr(e,{values:t,centerMarks:s})));if(i&&1===i.readyState)try{i.send(`fpuzzles:${o++}:step:${n}`)}catch(e){l(e)}};d(e,s,a)},step(e,t,s){const n=Ar(JSON.stringify(Pr(e,{values:t,centerMarks:s})));if(i&&1===i.readyState)try{return i.send(`fpuzzles:${o++}:step:${n}`),!0}catch(e){l(e)}return!1},disconnect(){i.close(),i.removeEventListener("message",a),i.removeEventListener("error",l),i.removeEventListener("close",c),i.removeEventListener("connect",u),c(),i=void 0}}})(0,(e=>k.forEach((t=>t(e))))):void 0;if(x?.connect(),e===Le){const t=new(ma?self.SharedArrayBuffer:ArrayBuffer)(4*g.header+324+81*g.solutions);let i=0;n=new Int32Array(t,i,g.header),i+=n.byteLength,r=new Uint32Array(t,i,81),i+=r.byteLength,a=new Uint8Array(t,i,81*g.solutions),b.postMessage({workerType:e,type:Pe,bufferParams:g,buffer:ma?t:void 0});let o={};setInterval((e=>{let t=!1;const i=Object.fromEntries(Ne.map(((e,t)=>[e,Atomics.load(n,t)])));o&&JSON.stringify(o)!==JSON.stringify(i)&&(t=!0),o=i,t&&ur.dispatch(Ci(0,{stats:i}))}),110)}b.addEventListener("message",(e=>{switch(e.data.type){case Ue:ur.dispatch(bi(e.data.type,e.data.data));break;case J:case Z:e.data.gridIteration===l&&ur.dispatch(bi(e.data.type,[{type:e.data.type}]));break;case X:ur.dispatch(bi(e.data.type,[{type:e.data.type}]));break;case De:ur.dispatch({type:"SEARCH_INITIATED",searchInitiation:e.data.data});break;case Re:if(e.data.gridIteration===l){if(!ma){let t=0;const i=new Uint32Array(e.data.buffer,0,g.header);t+=i.byteLength;const o=new Uint32Array(e.data.buffer,t,81);t+=o.byteLength;const s=new Uint8Array(e.data.buffer,t),l=s.length/81,u=c%g.solutions,d=(u+l)%g.solutions;a.set(s.slice(0,d<u?81*(g.solutions-u):void 0),81*u),d<u&&a.set(s.slice(81*(l-u))),r.set(o),Atomics.store(n,je[B.STATUS],i[je[B.STATUS]]),Atomics.store(n,je[B.COUNT],i[je[B.COUNT]]),Atomics.store(n,je[B.DEADENDS],i[je[B.DEADENDS]]),Atomics.store(n,je[B.DEPTH],i[je[B.DEPTH]]),Atomics.store(n,je[B.MAXDEPTH],i[je[B.MAXDEPTH]]),Atomics.store(n,je[B.REQUIREMENTS],i[je[B.REQUIREMENTS]]),Atomics.store(n,je[B.RESTRICTIONS],i[je[B.RESTRICTIONS]]),Atomics.store(n,je[B.OPTIONS],i[je[B.OPTIONS]])}ur.dispatch(Ci(e.data.type,e.data.data))}}}));const C=ur.subscribe((n=>(n=>{c=v.solutionCount.stats.count(n);const r=d!==v.logical.iteration(n),g=p!==v.logical.cancelIteration(n),k=u!==v.puzzleIteration(n),C=h!==v.solutionCount.iteration(n),S=f!==v.solutionCount.cancelIteration(n),_=m!==v.solutionCount.requestDownloadIteration(n);if(l=v.gridIteration(n),u=v.puzzleIteration(n),d=v.logical.iteration(n),p=v.logical.cancelIteration(n),h=v.solutionCount.iteration(n),f=v.solutionCount.cancelIteration(n),m=v.solutionCount.requestDownloadIteration(n),t=v.puzzle(n),k&&b.postMessage({type:Fe,workerType:e,puzzle:t,units:v.units(n),peers:v.peers(n),values:v.values(n)}),_&&e===Le){const e=[];for(let i=0,o=0;i<c*t.size**2;i+=t.size**2,++o)e[o]=a.slice(i,i+t.size**2).join("");const{name:i}=t,o=document.createElement("a");o.download=(i?i.replace(/ /g,"_"):"sudokulab")+"_solutions.txt",o.href=`data:text/plain,${e.join("\n")}`,o.click()}if(r?y?(w((e=>{"SUDOKU_SOLVER_STEP"===e.type&&ur.dispatch(bi(e.type,[{type:e.type,...e.data}]))})),x.connect().then((e=>x.stepSolve(t,v.values(n),v.candidates(n))))):(ur.dispatch({type:"CLEAR_STEPS"}),b.postMessage({type:He,workerType:e,values:v.values(n),displayedCandidates:v.displayedCandidates(n),candidates:v.candidates(n),gridIteration:v.gridIteration(n)})):g&&b.postMessage({type:Be,workerType:e,gridIteration:v.gridIteration(n)}),v.settings(n).autoSolve&&k)ur.dispatch({type:"REQUEST_SOLUTION_COUNT"});else if(C){const r=v.settings(n).solutionCount;s=r.givensOnly?v.givens(n):v.values(n),t=v.puzzle(n),i=v.peers(n),o=v.constraints(n),b.postMessage({type:Fe,workerType:e,puzzle:t,units:v.units(n),peers:v.peers(n),values:v.values(n)}),b.postMessage({type:We,workerType:e,values:s,peers:i,puzzle:t,constraints:o,settings:v.settings(n).solutionCount,gridIteration:v.gridIteration(n),puzzleIteration:v.puzzleIteration(n)})}S&&b.postMessage({type:Ve,workerType:e})})(ur.getState())));return{headerBuffer:n,heatmapBuffer:r,solutionBuffer:a,unsupervise:C}};var va=Object.defineProperty;class ba extends Zt{cornerMarkClasses(e,t){const i=[["tl",1],["tc",5],["tr",2],["ml",7],["mc",9],["mr",8],["bl",3],["bc",6],["br",4]].filter((([e,i])=>i<=t.length)).map((([e])=>e)),o=t.indexOf(e+1);return!this.value&&this.cornerMarks.includes(e+1)?`showing ${i[o]}`:""}render(){const t={};if(this.setValue){const e=255-(this.setValue>0?46*this.setValue:0),i=255-48*Math.abs(this.setValue),o=255-(this.setValue>0?0:48*-this.setValue);t.backgroundColor=`#${e.toString(16).padStart(2,0)}${i.toString(16).padStart(2,0)}${o.toString(16).padStart(2,0)}7f`}else this.cellColor&&(t.backgroundColor=`var(--cell-color-${this.cellColor})`);return ft` <div style="${Br(t)}" class="${hr({background:!0})}"></div> <div class="value">${0===this.value?"":this.value}</div> <div class="centerMarks" count="${this.centerMarks.length}"> ${this.value?"":[...this.centerMarks].map((e=>ft`<span class="mark" value="${e}">${e}</span>`))} </div> <div class="cornerMarks"> ${e(9,(e=>ft` <div value="${e+1}" class="mark ${this.cornerMarkClasses(e,this.cornerMarks)}">${e+1}</div> `))} </div> `}createRenderRoot(){return this}}((e,t,i)=>{t in e?va(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(ba,"properties",{value:Number,given:Boolean,selected:Boolean,cornerMarks:Array,centerMarks:String,cellColor:String,setValue:Number,conflict:{type:Boolean,reflect:!0},impacted:Boolean,impactedValues:{type:String,reflect:!0},options:Object,position:Number}),customElements.define("sudoku-cell",ba);const ya=Rt`sudoku-cell{--base-font-size:min(7vh, 3.7vw);position:relative;font-family:helvetica;cursor:pointer;text-shadow:1px 1px 2px #fff}@media (orientation:portrait){sudoku-cell{--base-font-size:min(5vh, 8vw)}}sudoku-cell[given]{color:#373737}sudoku-cell[given] .background{background-image:linear-gradient(var(--given-background-color),var(--given-background-color))}sudoku-cell[selected] .background{filter:brightness(105%);background-image:linear-gradient(var(--selection-background-color),var(--selection-background-color))}sudoku-cell[selected][given] .background{background-image:linear-gradient(var(--given-background-color),var(--given-background-color)),linear-gradient(var(--selection-background-color),var(--selection-background-color))}sudoku-cell .background.color-1{background-color:var(--cell-color-1)}sudoku-cell .background.color-2{background-color:var(--cell-color-2)}sudoku-cell .background.color-3{background-color:var(--cell-color-3)}sudoku-cell .background.color-4{background-color:var(--cell-color-4)}sudoku-cell .background.color-5{background-color:var(--cell-color-5)}sudoku-cell .background.color-6{background-color:var(--cell-color-6)}sudoku-cell .background.color-7{background-color:var(--cell-color-7)}sudoku-cell .background.color-8{background-color:var(--cell-color-8)}sudoku-cell .background.color-9{background-color:var(--cell-color-9)}:host([mode = "edit"][keyMode="values"][options ~= "shadePeers"]) sudoku-cell[shaded] .background,:host([mode = "play"][options ~= "shadePeers"]) sudoku-cell[shaded] .background,:host([mode = "settings"][options ~= "shadePeers"]) sudoku-cell[shaded] .background,:host([mode = "solve"][options ~= "shadePeers"]) sudoku-cell[shaded] .background{background-image:repeating-linear-gradient(45deg,#bbb 3px,#bbb 1px,transparent 8px)}:host([mode = "edit"]) sudoku-cell[highlighted] .background{background-color:rgba(255,255,127,.15)}:host([options ~= "showConflicts"]) sudoku-cell[error]{color:#dc143c}:host([options ~= "showConflicts"]) sudoku-cell[conflict] .background{box-shadow:inset 0 0 .3vw .3vw #dc143c}sudoku-cell .mark{transition:opacity 150ms ease-out}:host([mode="solve"]) sudoku-cell[dimMarks] .mark,:host([mode="solve"]) sudoku-cell[impacted] .mark,:host([mode="solve"]) sudoku-cell[step] .mark{opacity:.5}:host([mode="solve"]) sudoku-cell[impacted] .value{border:6px solid rgba(220,20,60,.5)}:host([mode="solve"]) sudoku-cell[step] .value{border:6px solid rgba(0,0,255,.5)}:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="1"] .mark[value="1"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="2"] .mark[value="2"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="3"] .mark[value="3"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="4"] .mark[value="4"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="5"] .mark[value="5"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="6"] .mark[value="6"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="7"] .mark[value="7"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="8"] .mark[value="8"],:host([mode="solve"]) sudoku-cell[impacted][impactedValues*="9"] .mark[value="9"]{opacity:1;color:#dc143c;font-weight:700}:host([mode="solve"]) sudoku-cell[step][impactedValues*="1"] .mark[value="1"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="2"] .mark[value="2"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="3"] .mark[value="3"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="4"] .mark[value="4"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="5"] .mark[value="5"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="6"] .mark[value="6"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="7"] .mark[value="7"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="8"] .mark[value="8"],:host([mode="solve"]) sudoku-cell[step][impactedValues*="9"] .mark[value="9"]{opacity:1;color:#00f;font-weight:700}:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="1"]) .mark[value="1"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="2"]) .mark[value="2"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="3"]) .mark[value="3"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="4"]) .mark[value="4"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="5"]) .mark[value="5"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="6"]) .mark[value="6"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="7"]) .mark[value="7"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="8"]) .mark[value="8"],:host([mode="solve"]) sudoku-cell[step][impacted]:not([impactedValues*="9"]) .mark[value="9"]{opacity:1;color:#dc143c;font-weight:700}.background{position:absolute;width:100%;height:100%;z-index:-1}.value{position:absolute;display:inline-flex;height:100%;width:100%;align-items:center;justify-content:center}.cornerMarks{position:absolute;display:grid;grid-template-columns:repeat(3,1fr);grid-template-areas:'tl tc tr' 'ml mc mr' 'bl bc br';padding:4px;width:100%;height:100%;font-size:calc(var(--base-font-size) * .3);font-weight:200;color:rgba(0,0,255,.6);justify-content:flex-start}.mark.tl{grid-area:tl}.mark.tc{grid-area:tc}.mark.tr{grid-area:tr}.mark.ml{grid-area:ml}.mark.mc{grid-area:mc}.mark.mr{grid-area:mr}.mark.bl{grid-area:bl}.mark.bc{grid-area:bc}.mark.br{grid-area:br}:host([options~="staticCorners"]) .mark{grid-area:unset}.cornerMarks .mark{margin:auto;visibility:hidden}.cornerMarks .mark.showing{visibility:visible}.centerMarks{position:absolute;display:inline-flex;width:100%;height:100%;align-items:center;justify-content:center;font-size:calc(var(--base-font-size) * .34);font-weight:200;color:rgba(0,0,255,.6)}.centerMarks[count="6"]{font-size:calc(var(--base-font-size) * .31)}.centerMarks[count="7"]{font-size:calc(var(--base-font-size) * .28)}.centerMarks[count="8"]{font-size:calc(var(--base-font-size) * .26)}.centerMarks[count="9"]{font-size:calc(var(--base-font-size) * .24)}`,ka=Rt`*{box-sizing:border-box}:host{--grid-size:min(100vh - 100px, 55vw - 60px);--padding-scaled:calc(4 * var(--grid-size) / 900);box-sizing:border-box;position:relative;top:0;left:0;width:var(--grid-size);height:var(--grid-size);margin:20px auto;padding:var(--padding-scaled);display:grid;grid-template-columns:repeat(9,1fr);font-size:min(7vh,3.7vw);font-weight:400;vertical-align:bottom;outline:0;user-select:none;transition-property:width,height,top,left;transition-duration:.3s;transition-timing-function:ease;z-index:-2;background-color:#fff;overflow:hidden;cursor:pointer}:host([size="4"]){grid-template-columns:repeat(4,1fr)}:host([size="6"]){grid-template-columns:repeat(6,1fr)}:host([size="16"]){grid-template-columns:repeat(16,1fr)}:host([paused]:not([mode="edit"]):not([mode="solve"])) svg>*:not(.grid){filter:url(#blur);opacity:.5}:host([paused]:not([mode="edit"]):not([mode="solve"])) sudoku-cell *{filter:blur(20px);opacity:.5}:host([gutter]){--grid-size:min(90vh - 100px, 50vw - 60px);top:3vw;overflow:visible}svg{position:absolute;left:calc(-10% + var(--padding-scaled));top:calc(-10% + var(--padding-scaled));width:calc(120% - calc(var(--padding-scaled) * 2));height:calc(120% - calc(var(--padding-scaled) * 2))}:host([mode="play"]) svg > g:not(.heatmap):not(.selectionOutline),:host([mode="settings"]) svg > g:not(.heatmap):not(.selectionOutline){filter:url(#svgSaturation)}@media (orientation:portrait){:host{--grid-size:min(99vmin, 70vh);top:0;font-size:min(5vh,8vw);margin:auto}:host([gutter]){--grid-size:min(84vmin, 59vh);left:0}svg{position:absolute;left:calc(-10% + 2px);top:calc(-10% + 2px);width:calc(120% - 4px);height:calc(120% - 4px)}}sudoku-cell *,svg > *{transition:none}svg *{pointer-events:visiblePainted}:host([mode="edit"]) svg g.killercage:hover{stroke-width:3}:host([mode="edit"]) svg > g[index]:not(.grid):not(.ghost):hover{filter:drop-shadow(0 4px 3px rgba(0,0,0,.5))}svg g.ghost *{pointer-events:none;display:none}:host([mode="edit"]) svg g.ghost *{display:block}:host([mode="edit"]) svg g.selected{filter:drop-shadow(0 3px 3px rgba(0,0,0,.5))}:host([mode="edit"]) sudoku-cell,:host([mode="edit"]) sudoku-cell *{pointer-events:none}:host([editing]){cursor:default}`;var wa=Object.defineProperty,xa=(e,t,i)=>(((e,t,i)=>{t in e?wa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class Ca extends(Xt(ur)(Zt)){constructor(){super(),setInterval((e=>this.requestUpdate("paused",!0)),333)}stateChanged(e){this.startTime=e.ui.startTime,this.pauseTime=e.ui.pauseTime,this.stopTime=e.ui.stopTime,this.paused=e.ui.paused,this.stopped=e.ui.stopped}elapsedTime(){const{startTime:e,pauseTime:t,stopTime:i,paused:o,stopped:s}=this,n=Date.now(),r=n-e-(s?n-i:o?n-t:0);return{hours:~~(r/36e5),minutes:(""+~~(r/6e4)%60).padStart(2,"0"),seconds:(""+~~(r/1e3)%60).padStart(2,"0")}}pausePlay(e){ur.dispatch({type:"TOGGLE_PAUSE"},!1)}render(){const{hours:e,minutes:t,seconds:i}=this.elapsedTime();return ft` <button class="pausePlay" ?disabled="${this.stopped}" @click="${this.pausePlay}" value="${this.paused?"Play":"Pause"}"> ${br(this.paused?"play":"pause","24px")} </button> <div class="elapsedTime"><span class="hours">${e}</span>:<span class="minutes">${t}</span>:<span class="seconds">${i}</span></div> <button class="check" @click="${this.checkResults}">${br("check","26px")}</button> `}}xa(Ca,"properties",{startTime:Number,pauseTime:Number,paused:{type:Boolean,reflect:!0},stopped:Boolean,stopTime:Number,checkResults:{attribute:!1}}),xa(Ca,"styles",Rt`*{box-sizing:border-box}:host{position:relative;height:100%;width:100%;display:block;font-weight:200;border:1px solid #a9a9a9;border-radius:3px}:host([paused]){color:#a9a9a9}.elapsedTime{position:relative;height:100%;width:100%;display:inline-block;text-align:center}button{margin:0;position:absolute;top:-1px;width:22%;height:calc(100% + 2px);border:0;border:1px solid #a9a9a9;padding:0;appearance:none;-webkit-appearance:none;outline:0}button svg{height:75%;width:75%}.pausePlay{left:-1px;border-radius:3px 0 0 3px;z-index:1}.check{right:-1px;border-radius:0 3px 3px 0}button:focus{border:1px solid #06d}button[disabled] svg path{fill:#a9a9a9}svg{padding-top:2px}`),customElements.define("sudoku-timer",Ca);var Sa=Object.defineProperty,_a=(e,t,i)=>(((e,t,i)=>{t in e?Sa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class Ea extends(Xt(ur)(Zt)){constructor(){super(),this.collectViewClasses=()=>Hs(this.puzzle);const{unsupervise:e}=ga(Me);this.unsuperviseLogicalWorker=e;const{headerBuffer:t,heatmapBuffer:i,solutionBuffer:o,unsupervise:s}=ga(Le);this.unsuperviseBruteForceWorker=s,this.headerBuffer=t,this.heatmapBuffer=i,this.solutionBuffer=o,this.addEventListener("contextmenu",(e=>e.preventDefault())),this.select=this.createSelectors(),this.latestPositionsHighlightedSvg=[],this.mouseOutListener=document.querySelector("sudoku-lab").shadowRoot.addEventListener("mousemove",(e=>{e.composedPath().includes(this)||(this.ghost=void 0)}),!0)}createSelectors(){const e=Li([qs.selectedCells,Vs.peers],((e,t)=>Array.from(new Set(t.filter(((t,i)=>e.includes(i))).flat())).filter((t=>!e.includes(t)))));return{...Pi,...Ws,...qs,...Gs,...Vs,...Ks,shadedCells:e}}disconnectedCallback(){super.disconnectedCallback(),this.unsuperviseLogicalWorker(),this.unsuperviseBruteForceWorker(),document.querySelector("sudoku-lab").shadowRoot.removeEventListener("mouseover",this.mouseOutListener,!0)}stateChanged(e){this.values=this.select.values(e),this.cells=this.select.cells(e),this.conflicts=this.select.conflicts(e),this.units=this.select.units(e),this.peers=this.select.peers(e),this.duplicates=this.select.duplicates(e),this.cornerMarks=this.select.cornerMarks(e),this.centerMarks=this.select.centerMarks(e),this.displayedCandidates=this.select.displayedCandidates(e),this.candidates=this.select.candidates(e),this.cellColors=this.select.cellColors(e),this.stepCount=this.select.logical.stepCount(e),this.latestEditPosition=this.select.latestEditPosition(e),this.cursor=this.select.cursor(e),this.selectingCells=this.select.selectingCells(e),this.selectedCells=this.select.selectedCells(e),this.tentativelySelectedCells=this.select.tentativelySelectedCells(e),this.shadedCells=this.select.shadedCells(e),this.highlightedConflicts=this.select.highlightedConflicts(e),this.highlightedPositions=this.select.logical.highlightedPositions(e),this.impactedPositions=this.select.logical.impactedPositions(e),this.mode=this.select.mode(e),this.keyMode=this.select.keyMode(e),this.paused=this.select.paused(e),this.puzzle=this.select.puzzle(e),this.size=this.select.size(e),this.options=this.select.options(e),this.featureName=this.select.featureName(e),this.featureItem=this.select.featureItem(e),this.featureItemIndex=this.select.featureItemIndex(e),this.highlightFeatureName=this.select.highlightFeatureName(e),this.highlightFeatureItemIndex=this.select.highlightFeatureItemIndex(e),this.featureItemSelectionTemplate=this.select.featureItemSelectionTemplate(e),this.gutter=this.select.gutter(e),this.settings=this.select.settings(e),this.solutionIndex=this.select.solutionCount.index(e),this.counting=this.select.solutionCount.counting(e),this.solutionCountStats=this.select.solutionCount.stats(e),this.solutionCount=this.select.solutionCount.stats.count(e),this.showingSolutionType=this.select.showingSolutionType(e),this.logicalSolutionValues=this.select.logicalSolutionValues(e),this.logicalSolutionCandidates=this.select.logicalSolutionCandidates(e),this.dimColors=this.select.settings(e).dimColors,this.editing=!!this.featureName,this.cellSetValues=this.select.cellSetValues(e)}updated(e){super.updated(e);const t=Object.fromEntries([...e]);("dimColors"in t&&void 0!==t.dimColors||this.dimColors&&"mode"in t&&(![void 0,"play","settings"].includes(t.mode)||!["play","settings"].includes(this.mode)))&&this.shadowRoot.querySelector("#svgSaturationMatrix animate").beginElement()}dispatch(e,t=!0){this.paused&&t||ur.dispatch(e)}cellSelectionStarter(e){return t=>{this.focus(),(1===t.buttons||"touchstart"==t.type&&1===t.touches.length)&&(this.dispatch(ri(e,t[this.settings.addRemoveModifier],this.peers)),this.tentativelySelectCells(t),t.preventDefault(),t.stopPropagation())}}cellSelector(e){return t=>{if(this.focus(),this.latestMouseOverCell=e,1===t.buttons||"touchmove"==t.type&&1===t.touches.length){if("touchmove"==t.type){const i=t.changedTouches[0],o=this.shadowRoot.elementFromPoint(i.clientX,i.clientY);e=o.closest("sudoku-cell").position}this.dispatch(ai(e,!0,this.peers)),this.tentativelySelectCells(t),t.stopPropagation(),t.preventDefault()}}}tentativelySelectCells(e){const t=e[this.settings.columnModifier]?"column":e[this.settings.rowModifier]?"row":e[this.settings.boxModifier]?"box":void 0;if(t){const e=this.cells[this.latestMouseOverCell]?.[t],i=this.cells.map(((i,o)=>i[t]===e?o:void 0)).filter((e=>void 0!==e)),o=i.filter((e=>!this.selectedCells.includes(e)));this.dispatch(li(o,!0))}}cellSelectionEnder(e){return e=>{this.dispatch({type:"END_CELL_SELECTION"}),e.stopPropagation(),e.preventDefault()}}similarCellSelector(e){return t=>{const i="values"===this.keyMode?this.values:"colors"===this.keyMode?this.cellColors:"centers"===this.keyMode?this.centerMarks.map(((e,t)=>this.values[t]?"":e)):this.cornerMarks.map(((e,t)=>this.values[t]||this.centerMarks[t]?"":e));this.dispatch(ci(e,i,t[this.settings.addRemoveModifier]))}}cellIsHighlighted(e){return this.stepCount>0&&(this.impactedPositions[e]||this.highlightedPositions[e])}svgMouseToGridCoords(e){const t=e.target.closest("svg"),i=t.createSVGPoint();i.x=e.clientX,i.y=e.clientY;const o=i.matrixTransform(t.getScreenCTM().inverse()),s=Math.floor(o.y/100),n=Math.floor(o.x/100),r=3*Math.floor(s/3)+~~(n/3),a=9*s+n,[l,c]=[100*n+50,100*s+50],[u,d]=[l-o.x,c-o.y];return{point:o,row:s,col:n,box:r,position:a,radialhit:re(u,d)<=45}}svgMouseDown(e){if("edit"===this.mode){const{row:t,col:i,position:o,radialhit:s,point:n}=this.svgMouseToGridCoords(e);if(this.featureName){const t={x:n.x/100,y:n.y/100};return ur.dispatch(yi(o,t,Ge(e))),e.preventDefault(),void e.stopPropagation()}const r=e.target.closest("g[index]");if(!r&&t>=0&&t<=8&&i>=0&&i<=8)return ur.dispatch(mi("values")),ur.dispatch(ri(o,e[this.settings.addRemoveModifier])),void(this.lastSelectCellPosition=o);const a=Object.keys(this.puzzle.constraints),l=[...r?.classList].find((e=>a.includes(e)));if(!l)return;const c=r.attributes.index?.value;c&&(ur.dispatch(wi(l,~~c)),e.preventDefault(),e.stopPropagation())}}svgMouseMove(e){if("edit"===this.mode){const{row:t,col:i,position:o,radialhit:s,point:n}=this.svgMouseToGridCoords(e),r={x:n.x/100,y:n.y/100},a=e.target.closest("g[index]");if(this.selectingCells&&this.lastSelectCellPosition!==o)return ur.dispatch(ai(o,!0)),void(this.lastSelectCellPosition=o);if(1===e.buttons&&Object.values(p).includes(this.featureItemSelectionTemplate))this._dragging=!0,this.ghost={position:o,point:r,modifiers:Ge(e)};else if(this.featureName&&(t>=0&&t<=8&&i>=0&&i<=8||Object.values(p).includes(this.featureItemSelectionTemplate)))(o!==this.latestEditPosition||Object.values(p).includes(this.featureItemSelectionTemplate))&&(1===e.buttons&&s?(this.ghost={position:o,point:r,modifiers:Ge(e)},ur.dispatch(yi(o,r,Ge(e)))):this.featureName&&(this.ghost={position:o,point:r,modifiers:Ge(e)}));else if(this.featureName||!a||this.highlightFeatureName)!a&&this.highlightFeatureName&&(ur.dispatch({type:"UNHIGHLIGHT_FEATURE_ITEM"}),e.preventDefault(),e.stopPropagation());else{this.ghost=void 0;const t=Object.keys(this.puzzle.constraints),i=[...a.classList].find((e=>t.includes(e))),o=a.attributes.index.value;if(!i)return;ur.dispatch(xi(i,o)),e.preventDefault(),e.stopPropagation()}}}svgMouseUp(e){if("edit"===this.mode){if(this.selectingCells)return ur.dispatch({type:"END_CELL_SELECTION"}),void(this.lastSelectCellPosition=void 0);if(this._dragging&&Object.values(p).includes(this.featureItemSelectionTemplate)&&this.featureItem?._set_sizes){const{row:t,col:i,position:o,radialhit:s,point:n}=this.svgMouseToGridCoords(e),r={x:n.x/100,y:n.y/100};ur.dispatch(yi(o,r,Ge(e)))}this._dragging=!1}}renderGhost(){if(this.ghost&&this.featureName&&this.featureItem){const{position:i,modifiers:o,point:s}=this.ghost,n={...(e=this.puzzle,t=this.featureName,Object.entries(e.constraints).map((([e,t])=>[Us.get(e),e,t])).filter((([e,i])=>!!e&&i===t)).map((([t,i,o])=>new t(e,o)))[0]).params(this.featureItem),...Bn(this.featureName,this.featureItem,this.size,i,this.latestEditPosition,s,o)},r=Us.get(this.featureName);return mt` <g opacity="0.33" class="ghost"> ${new r(this.puzzle,{items:[n]}).renderSvg()} <defs> <style>svg g[index]{pointer-events:none!important;filter:none!important;cursor:default!important}svg g.${this.featureName}[index="${this.featureItemIndex}"]{opacity:.67}</style> </defs> </g> `}var e,t}renderHeatMap(){if("solve"===this.mode&&this.settings.solutionCount.heatmap&&"BRUTEFORCE"===this.showingSolutionType){const e=[],t=[];let i=Math.min(...this.heatmapBuffer),o=Math.max(...this.heatmapBuffer)-i;this.heatmapBuffer.forEach(((e,s)=>{t[s]=Math.floor(255*(e-i)/o)}));for(const[i,o]of t.entries()){const t=i%9,s=~~(i/9),n=`#${da[4+~~(.9*o)].toString(16).padStart(6,"0")}`,r=[n+"bf",n+"7f",n+"00"],a=`url('#gr${i}')`,l=`gr${i}`;e.push(mt` <defs> <radialGradient id="${l}"> <stop offset="0%" stop-color="${r[0]}"></stop> <stop offset="50%" stop-color="${r[1]}"></stop> <stop offset="100%" stop-color="${r[2]}"></stop> </radialGradient> </defs> <circle cx="${100*t+60}" cy="${100*s+60}" r="100" fill="${a}"></circle> `)}return mt` <g class="heatmap"> <defs> <clipPath id="clippy"> <rect x="2" y="2" width="896" height="896"> </clipPath> </defs> <g style="clip-path:url(#clippy)">${e}</g> </g> `}return""}renderGivens(){return Di("givens",this.puzzle.givens.map(((e,t)=>{if(0===e)return[];const i=t%this.size*100,o=100*~~(t/this.size);return[Hi([i,o],100,100,{fill:this.settings.givenBackgroundColor}),Ui([i+50,o+57],e,{dominantBaseline:"middle",textAnchor:"middle",stroke:"none",fill:"#373737"})]})),{style:"font-family: helvetica; font-weight: 400; font-size: 68px"})}renderSelectionOutline(){const e=[],t=this.settings.selectionOutlineColor,i=this.settings.selectionOutlineSize,s=ji(i)/2;if((["solve","play","settings"].includes(this.mode)||"edit"===this.mode&&"values"===this.keyMode)&&this.options.outlineSelection){const n=o([...new Set([...this.selectedCells,...this.tentativelySelectedCells])],s,this.size);for(const o of n)e.push(Fi(o.map((([e,t])=>[100*e,100*t])).map((([e,t],i,o)=>`${0===i?"M":"L"}${e} ${t}${i===o.length-1?"Z":""}`)).join(""),{stroke:t,strokeWidth:i,fill:"none"}))}return Di("selectionOutline grid",e)}renderSvgContent(e=!1,t=!0){let i=!1;return mt` ${this.renderHeatMap()} ${e?this.renderGivens():""} ${(o=this.puzzle,s=t=>e||2!==t.constructor.layer()||i||!this.options.outlineSelection?t.renderSvg(this.puzzle.disableViolationChecking?{...this.options,showConflicts:!1}:this.options,this.conflicts):(i=!0,[this.renderSelectionOutline(),t.renderSvg(this.puzzle.disableViolationChecking?{...this.options,showConflicts:!1}:this.options,this.conflicts)]),((e,t,i)=>N((e=>Object.fromEntries(Object.entries(e.constraints).map((([e,t])=>[Us.get(e),e,t])).filter((([e])=>!!e)).sort((([e],[t])=>e.layer()-t.layer())).map((([t,i,o])=>[i,new t(e,o)]))))(e),((e,t,i,o)=>(e.push(s(t)),e)),[]))(o)).flat().flat()} ${i||e||!this.options.outlineSelection?"":this.renderSelectionOutline()} ${this.highlightFeatureName?mt` <style>g.${this.highlightFeatureName}[index="${this.highlightFeatureItemIndex}"]{filter:drop-shadow(0 4px 3px rgba(0,0,0,.5));cursor:pointer}</style> `:""} ${t&&this.ghost?mt` ${this.renderGhost()} `:""} `;var o,s}renderSvg(e){const t=`-${10*this.size} -${10*this.size} ${120*this.size} ${120*this.size}`,i=("play"===this.mode||"settings"===this.mode)&&this.dimColors,o=i?1:.2,s=i?.2:1;return ft` <svg @mousedown="${this.svgMouseDown}" @mousemove="${this.svgMouseMove}" @mouseup="${this.svgMouseUp}" style="position:absolute" width="100%" height="100%" viewBox="${t}"> <defs> <filter id="blur"> <feGaussianBlur stdDeviation="15"/> </filter> <filter id="svgSaturation"> <feColorMatrix id="svgSaturationMatrix" type="saturate" values="${s}"> <animate attributeName="values" from="${o}" to="${s}" begin="indefinite" dur="350ms" fill="freeze"></animate> </feColorMatrix> </filter> </defs> ${this.renderSvgContent(e)} </svg> `}renderScreenshot(){return new Promise((e=>{const t=`-${10*this.size} -${10*this.size} ${120*this.size} ${120*this.size}`,i=Gi(Di("screenshot",[this.renderSvgContent(!0,!1)],{style:"font-family: helvetica;"}),t),o=new Image;o.onload=t=>{const i=document.createElement("canvas");i.width=this.gutter?120*this.size:6+100*this.size,i.height=this.gutter?120*this.size:6+100*this.size;const s=i.getContext("2d");s.fillStyle="white",s.fillRect(0,0,i.width,i.height),s.drawImage(o,this.gutter?0:3+10*-this.size,this.gutter?0:3+10*-this.size,120*this.size,120*this.size),e(i.toDataURL())},o.src=i}))}renderCellValue(e,t){if("solve"===this.mode&&"LOGICAL"===this.showingSolutionType)return this.logicalSolutionValues[t]||e;if("solve"===this.mode&&"BRUTEFORCE"===this.showingSolutionType&&this.settings.solutionCount.solutions&&this.solutionCount>0){const i=this.counting?(this.solutionCount-1)%25e3:this.solutionIndex;return this.latestSolutionIndex=i,this.solutionBuffer[81*i+t]||e}return e}renderCornerMarks(e){return"solve"===this.mode&&"LOGICAL"===this.showingSolutionType?this.logicalSolutionCandidates[e]:this.options.autoCandidates||this.cellIsHighlighted(e)?this.displayedCandidates[e]:this.cornerMarks[e]}render(){return ft` ${this.renderSvg()} ${this.values.map(((e,t)=>{const i=this.renderCellValue(e,t),o=(["solve","play","settings"].includes(this.mode)||"edit"===this.mode&&"values"===this.keyMode)&&this.selectedCells.includes(t)||this.tentativelySelectedCells.includes(t);return ft` <sudoku-cell .position="${t}" ?given="${0!==this.puzzle.givens[t]}" ?selected="${o}" ?error="${!this.puzzle.disableViolationChecking&&(!!this.duplicates[t].length||Object.keys(this.conflicts[t]).length)}" ?shaded="${this.shadedCells.includes(t)}" ?conflict="${!this.puzzle.disableViolationChecking&&this.highlightedConflicts.includes(t)}" ?step="${this.stepCount&&this.highlightedPositions[t]?.length}" ?impacted="${this.stepCount&&this.impactedPositions[t]?.length}" .impactedValues="${this.highlightedPositions[t]||this.impactedPositions[t]}" .value="${i}" .cornerMarks="${this.renderCornerMarks(t)}" .centerMarks="${this.cellIsHighlighted(t)?"":this.centerMarks[t]}" .cellColor="${this.cellColors[t]}" .setValue="${this.cellSetValues?.[t]}" .options="${this.options}" ?dimMarks="${this.stepCount&&(Object.keys(this.highlightedPositions).length||Object.keys(this.impactedPositions).length)&&!this.cellIsHighlighted(t)}" @dblclick="${this.similarCellSelector(t)}" @touchstart="${this.cellSelectionStarter(t)}" @mousedown="${this.cellSelectionStarter(t)}" @touchend="${this.cellSelectionEnder(t)}" @mouseup="${this.cellSelectionEnder(t)}" @touchmove="${this.cellSelector(t)}" @mouseover="${this.cellSelector(t)}" @contextmenu="${e=>!1}"> </sudoku-cell> `}))} `}}_a(Ea,"properties",{puzzle:Object,size:{type:Number,reflect:!0},gutter:{type:Boolean,reflect:!0},cells:Array,values:Array,units:Array,peers:Array,duplicates:Array,conflicts:Array,cornerMarks:Array,centerMarks:Array,candidates:Array,editing:{type:Boolean,reflect:!0},selectingCells:Boolean,selectedCells:Number,tentativelySelectedCells:Array,shadedCells:Array,steps:Array,highlightedConflicts:Array,highlightedPositions:Array,impactedPositions:Array,cellColors:Array,mode:{type:String,attribute:!0,reflect:!0},keyMode:{type:String,reflect:!0},svg:Object,paused:{type:Boolean,reflect:!0},featureName:String,featureItem:Object,featureItemIndex:Number,featureItemSelectionTemplate:Object,latestEditPosition:Number,ghost:Object,settings:Object,solutionCountStats:Object,depth:Number,maxDepth:Number,solutionIndex:Number,counting:Boolean,options:{type:Object,reflect:!0,converter:Ie},showingSolutionType:String,logicalSolutionValues:Array,logicalSolutionCandidates:Array,dimColors:Boolean,cellSetValues:Array}),_a(Ea,"styles",[ka,ya]),customElements.define("sudoku-grid",Ea);const za=[{name:"Dandelion",setter:"patrick",size:9,givens:"000000080000400000000000000090000030080000000010000000000000000000002000000000900",constraints:{row:{},column:{},box:{},arrow:{items:[{positions:[40,41,42]},{positions:[40,50,51]},{positions:[40,50,59]},{positions:[40,49,58]},{positions:[40,48,57]},{positions:[40,48,47]},{positions:[40,39,38]},{positions:[40,30,29]},{positions:[40,30,21]},{positions:[40,31,22]},{positions:[40,32,23]},{positions:[40,32,33]}]},knightsmove:{}}},{name:"Hypnotic Arrows",setter:"Miky",size:9,constraints:{row:{},column:{},box:{},arrow:{items:[{positions:[9,1,11,19]},{positions:[17,25,15,7]},{positions:[50,40,30]},{positions:[65,73,63,55]},{positions:[69,61,71,79]}]},thermo:{items:[{positions:[35,34,43,52,51]},{positions:[45,46,37,28,29]},{positions:[57,47]}]},diagonal:{orientation:"\\"},kropki:{items:[{positions:[67,68],type:"consecutive"},{positions:[76,67],type:"consecutive"},{positions:[66,75],type:"consecutive"},{positions:[32,23],type:"consecutive"},{positions:[23,14],type:"consecutive"},{positions:[32,31],type:"consecutive"},{positions:[49,48],type:"consecutive"}]},killercage:{items:[{positions:[12,13,14],sum:13}]}}},{name:"Thermo Sudoku",setter:"Tom Snyder",size:9,constraints:{row:{},column:{},box:{},thermo:{items:[{positions:[1,0,9]},{positions:[5,14,13]},{positions:[6,7,16,17,26]},{positions:[25,24,23]},{positions:[25,24,15]},{positions:[25,24,33]},{positions:[40,31,32,41]},{positions:[40,49,48,39]},{positions:[22,21,30,29,38,37,46,45]},{positions:[59,50,51,42,43,34,35]},{positions:[71,80,79]},{positions:[75,66,67,58]},{positions:[65,56,47]},{positions:[65,56,57]},{positions:[65,56,55]},{positions:[54,63,64,73,74]}]}}},{name:"Thermo Sudoku",setter:"Mitchell Lee",constraints:{row:{},column:{},box:{},thermo:{items:[{positions:[1,11,19,9]},{positions:[14,4,12,22]},{positions:[17,25,15,7]},{positions:[42,34,44,52]},{positions:[39,49,41,31]},{positions:[36,28,38,46]},{positions:[65,73,63,55]},{positions:[68,58,66,76]},{positions:[61,71,79,69]}]}},givens:"000008000000000000000000000000000002000040000000000000000000000050000000000006",size:9},{name:"Black Maths",setter:"clover!",givens:[..."0000000000000000000000000000004"],size:9,constraints:{row:{},column:{},box:{},kropki:{items:[{positions:[1,0],type:"consecutive"},{positions:[9,0],type:"consecutive"},{positions:[36,27],type:"consecutive"},{positions:[37,36],type:"consecutive"},{positions:[29,28],type:"consecutive"},{positions:[29,38],type:"consecutive"},{positions:[39,40],type:"consecutive"},{positions:[31,40],type:"consecutive"},{positions:[3,4],type:"consecutive"},{positions:[13,4],type:"consecutive"},{positions:[21,12],type:"consecutive"},{positions:[21,22],type:"consecutive"},{positions:[7,6],type:"consecutive"},{positions:[15,6],type:"consecutive"},{positions:[17,26],type:"consecutive"},{positions:[26,25],type:"consecutive"},{positions:[65,74],type:"consecutive"},{positions:[74,73],type:"consecutive"},{positions:[51,50],type:"consecutive"},{positions:[50,59],type:"consecutive"},{positions:[60,61],type:"consecutive"},{positions:[69,60],type:"consecutive"},{positions:[53,52],type:"double"},{positions:[77,68],type:"double"}]},xv:{items:[{positions:[52,51],type:"x"},{positions:[59,68],type:"v"},{positions:[20,19],type:"v"}]}}},{name:"The Miracle",setter:"Mitchell Lee",size:9,givens:[..."0000000000000000000000000000000000000010000000000002"],constraints:{row:{},column:{},box:{rows:3,cols:3},kingsmove:{},knightsmove:{},consecutive:{}}},{name:"Knowlege Bomb: 5≠6",setter:"apiyo",size:9,constraints:{row:{},column:{},box:{rows:3,cols:3},knightsmove:{},arrow:{items:[{positions:[4,12,21]},{positions:[19,20,21,22]},{positions:[43,33,23,15,6]},{positions:[43,51,59]},{positions:[41,50,58]},{positions:[54,63,73]},{positions:[55,65,75]},{positions:[55,56,57,58]},{positions:[55,45]},{positions:[71,79,78]}]},thermo:{items:[{positions:[69,77]}]}}},{name:"Sum 41",setter:"Mr. Menace",size:9,constraints:{row:{},column:{},box:{rows:3,cols:3},littlekiller:{items:[{sum:28,positions:[5,15,25,35]},{sum:57,positions:[18,28,38,48,58,68,78]},{sum:41,positions:[45,37,29,21,13,5]},{sum:13,positions:[75,65,55,45]},{sum:41,positions:[62,52,42,32,22,12,2]},{sum:41,positions:[35,43,51,59,67,75]}]},arrow:{items:[{positions:[2,3,4]},{positions:[14,23,33,34]},{positions:[18,27,36]},{positions:[21,29]},{positions:[46,47,57,66]},{positions:[62,53,44]},{positions:[78,77,76]}]}}},{name:"The Ping Pong Cage",setter:"udukos",size:9,constraints:{row:{},column:{},box:{rows:3,cols:3},knightsmove:{},killercage:{items:[{sum:33,positions:[3,4,5,12,14]},{sum:24,positions:[15,16,25]},{sum:23,positions:[20,21,22,29,30,38]},{sum:17,positions:[27,28,36,45,46]},{sum:19,positions:[34,35,44,53,52]},{sum:13,positions:[55,64,65]},{sum:10,positions:[61,70,69]},{sum:33,positions:[66,75,76,77,68]}]}}},{name:"Hubble Deep Field Sudoku",setter:"Azerio",constraints:{row:{},column:{},box:{},thermo:{items:[{positions:[10,0,9,1]},{positions:[16,17,26,25,24,15]},{positions:[22,21,30,31]},{positions:[60,59,50,51,52,61,70]},{positions:[64,65,74,73]}],defaults:{strokeWidth:20}},arrow:{items:[{positions:[11,20,19,18]},{positions:[11,2,3,4]},{positions:[6,7,8]},{positions:[34,33,42]},{positions:[76,67,77]},{positions:[56,57,48,47,46]},{positions:[56,55,64,65,66]}]}},size:9},{name:"Skidoo 23",setter:"Charley Red",constraints:{row:{},column:{},region:{items:[{positions:[8,17,26,35,25,16,34,43,52]},{positions:[7,6,5,15,14,13,23,24,32]},{positions:[33,42,51,60,50,41,59,49,40]},{positions:[44,53,62,71,80,70,61,79,78]},{positions:[77,76,75,74,67,68,69,66,58]},{positions:[65,56,47,57,48,39,30,22,31]},{positions:[4,3,12,21,11,2,20,29,38]},{positions:[54,63,72,55,46,37,64,73,28]},{positions:[0,9,18,27,36,45,19,10,1]}]},knightsmove:{},kingsmove:{},consecutive:{},killercage:{items:[{positions:[40,49,58],sum:23}]}},size:9},{name:"Unique",setter:"Totally Normal Cat",constraints:{row:{},column:{},box:{},killercage:{items:[{positions:[1,0,9],sum:19},{positions:[20,19,28],sum:13},{positions:[36,37],sum:15},{positions:[45,54,55],sum:20},{positions:[63,64,73],sum:19},{positions:[65,74,75],sum:20},{positions:[38,39],sum:6},{positions:[21,30,29],sum:19},{positions:[6,5,14,23],sum:22},{positions:[15,24,25],sum:17},{positions:[7,8,17],sum:17},{positions:[26,35,34,33],sum:27},{positions:[43,44],sum:8},{positions:[53,52],sum:6},{positions:[49,58],sum:6},{positions:[67,76],sum:15},{positions:[69,78,79],sum:13}]}},size:9},{name:"Embraced",setter:"Qodec",constraints:{row:{},column:{},box:{},arrow:{items:[{positions:[12,22,30,20]},{positions:[29,19,11,21]},{positions:[24,34,42,32]},{positions:[41,31,23,33]}]},knightsmove:{}},givens:"0000000000000000060000000005000000000000000000000000000000000000000000000003",size:9},{name:"Classic Sudoku!",setter:"Rimu Takamura",size:9,givens:"000490000008020004060500070054000600000000000009000580030002090500080300000073000",constraints:{row:{},column:{},box:{}}},{name:"Tatooine Sunset",setter:"Philip Newman",constraints:{row:{},column:{},box:{}},givens:"000000000009800007080060050050040030007900002000000000002700009040050060300006200",size:9},{name:"The Miracle Sudoku 2",setter:"Ri Sa",constraints:{row:{},column:{},box:{},thermo:{items:[{positions:[13,3,11,21]},{positions:[22,12]},{positions:[15,23,31]},{positions:[24,34,42,32]},{positions:[51,61,69,59,49]},{positions:[60,68,58,50]}]},knightsmove:{}},givens:"0000000000009",size:9},{name:"The New Miracle",setter:"Aad van de Wetering",constraints:{row:{},column:{},box:{},kingsmove:{},knightsmove:{},consecutive:{}},givens:"000000000000000000000040000003",size:9},{name:"Antiknight Arrow Sudoku",setter:"Aad van de Wetering",constraints:{row:{},column:{},arrow:{items:[{positions:[37,27,19,11,3]},{positions:[13,22,30,38,46]},{positions:[43,53,61,69,77]},{positions:[67,58,50,42,34]},{positions:[15,7,16,26]},{positions:[32,40,41]},{positions:[72,63,64,74]}]},knightsmove:{},box:{}},givens:"00000000001000000000000000304",size:9},{name:"Sudoku X",setter:"Bastien Vial-Jaime",constraints:{row:{},column:{},box:{},diagonal:{}},givens:"00000008000000070600000102000006050000090500000803000008010000050700000009",size:9},{name:"Egg Trail",setter:"Shye",constraints:{row:{},column:{},box:{},thermo:{items:[{positions:[0,9]},{positions:[4,13,22]},{positions:[8,17,26]},{positions:[27,36,45,54]}]}},givens:"000000000000000000000900600008700500000040030000002001009500700000010020000003004",size:9},{name:"Little Killer Arrows",setter:"Phistomefel",size:9,constraints:{row:{},column:{},box:{rows:3,cols:3},littlekiller:{items:[{sum:15,positions:[18,10,2]},{sum:30,positions:[45,37,29,21,13,5]},{sum:21,positions:[5,15,25,35]},{sum:10,positions:[7,17]},{sum:29,positions:[26,34,42,50,58,66,74]},{sum:13,positions:[74,64,54]},{sum:18,positions:[75,65,55,45]}]},arrow:{items:[{positions:[1,9,18]},{positions:[2,12,21]},{positions:[6,14]},{positions:[7,17,26]},{positions:[61,53,44]},{positions:[73,63,54]},{positions:[74,66]},{positions:[78,68,58]},{positions:[79,71,62]}]}}},{name:"A Disjointed Killer",setter:"Jonny Kaufman",constraints:{row:{},column:{},box:{rows:3,cols:3},disjointgroups:{},killercage:{items:[{sum:26,positions:[0,1,9,10]},{sum:22,positions:[3,12,13,14]},{sum:5,positions:[4,5]},{sum:27,positions:[7,8,16,17]},{sum:22,positions:[20,21,29]},{sum:21,positions:[23,24,33]},{sum:7,positions:[27,36]},{sum:20,positions:[28,37,46,45]},{sum:18,positions:[30,31,39]},{sum:20,positions:[32,41,50,49]},{sum:5,positions:[34,35]},{sum:22,positions:[43,44,52,53]},{sum:22,positions:[51,60,59]},{sum:27,positions:[63,64,72,73]},{sum:22,positions:[66,75,76,77]},{sum:5,positions:[67,68]},{sum:26,positions:[70,71,79,80]},{_creating:!0,positions:[]}]},inequality:{items:[{positions:[16,7]}]}},size:9},{name:"Boxes",setter:"clover!",constraints:{row:{},column:{},box:{},killercage:{items:[{positions:[12,11,10,19,28],sum:22},{positions:[21,20,29],sum:11},{positions:[45,55,54,46],sum:0},{positions:[47,56,57],sum:20},{positions:[67,76],sum:12},{positions:[51,60,59],sum:17},{positions:[52,61,70,69,68],sum:21},{positions:[23,24,33],sum:14},{positions:[25,34,35,26],sum:0},{positions:[36,37],sum:12}]},quadruple:{items:[{positions:[12,13,4,3],values:[1,2,5,9]},{positions:[30,21,20,29],values:[3,4,5]},{positions:[24,23,32,33],values:[4,5,6]},{positions:[53,44,43,52],values:[1,2,5,9]},{positions:[50,59,60,51],values:[5,6,7]},{positions:[57,48,47,56],values:[6,7,8]}]}},size:9}],$a=Rt`*{box-sizing:border-box}:host{position:relative;height:100%;width:100%;overflow:hidden;margin:0;padding:0;box-sizing:border-box}fieldset.puzzles{position:relative;height:100%;width:100%;margin:0;padding:10px 15px 0 15px}fieldset.puzzles legend{text-align:right;margin-right:30px;font-size:25px;font-weight:700}.filter{width:100%;height:24px;padding:0 0 0 20px}.icon.search{position:absolute;fill:grey;left:12px;width:20px;height:24px}.filter:focus ~ .icon.search{fill:#06d}.filterHidden{display:none}.puzzleList{position:relative;font-size:20px;display:block;height:calc(100% - 24px);overflow-y:auto;outline:0}.puzzle{margin:20px 0;cursor:pointer}.puzzleName,.puzzleSetter{display:inline}.puzzleName{font-weight:800;font-size:20px}.puzzleFeature{display:inline;font-style:italic}.puzzleFeature::after{content:', '}.puzzleFeature:last-child::after{content:''}`;var Ta=Object.defineProperty,Oa=(e,t,i)=>(((e,t,i)=>{t in e?Ta(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);const Ia=new Map([...ke.entries()].map((([e,t])=>[e,t?.label?.()??e])));class Aa extends(Xt(ur)(Yr(Zt))){constructor(){super(),this.select={...qs},this.addEventListener("keydown",(e=>{be(e.target)&&e.stopPropagation()}))}stateChanged(e){this.options=this.select.options(e)}puzzleSelector(t){return i=>{const o={...t,givens:e(t.size**2,(e=>Number(t.givens?.[e]??0)))};ur.dispatch(ei(o)),ur.dispatch(fi("play"))}}renderPuzzleDetails(e){const t=["row","column","box","gutter","path","ellipse","rectangle"],i=Object.entries(e.constraints).filter((([e])=>!t.includes(e))).sort((([e],[t])=>Ia.get(e).localeCompare(Ia.get(t))));return ft` <div tabindex="0" @click="${this.puzzleSelector(e)}" class="filterable puzzle"> <div class="puzzleName">${e.name}</div> ${e.setter?ft`<div class="puzzleSetter">by ${e.setter}</div>`:""} <div class="puzzleFeatures"> ${0===i.length?ft` <div class="puzzleFeature">Classic</div> `:i.map((([e,t])=>ft` <div class="puzzleFeature">${Ia.get(e)}</div> `))} </div> </div> `}render(){return ft` <fieldset class="puzzles"> <legend>Puzzles</legend> <input @input="${this.updateFilter}" class="filter" type="text" placeholder="Filter puzzles by name, setter, or features"> ${br("search","28px")} <div tabindex="-1" class="puzzleList"> ${za.sort(((e,t)=>e.name.localeCompare(t.name)||e.setter.localeCompare(t.setter))).map(((e,t)=>this.renderPuzzleDetails(e)))} </div> </fieldset> `}}Oa(Aa,"styles",[Hr,$a]),Oa(Aa,"properties",{options:Object}),customElements.define("sudoku-puzzles",Aa);const Ma=Rt`*{box-sizing:border-box}:host{position:fixed;top:0;height:30px;margin:auto;width:100%;clip:rect(40px,100vw,100vh,0)}.toast{top:0;opacity:0;transition:top 150ms ease-out,opacity .1s ease-in;position:relative;padding:10px;font-size:18px;width:400px;background-color:#fff;box-shadow:0 2px 4px #000000AF;border-radius:5px;margin:auto}:host([showing]) .toast{transition:top 150ms ease-out,opacity .1s ease-in .1s;opacity:1;top:40px}.close{position:absolute;top:3px;right:3px;cursor:pointer}`;var La=Object.defineProperty,Pa=(e,t,i)=>(((e,t,i)=>{t in e?La(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);class Na extends Zt{constructor(){super()}firstUpdated(e){super.firstUpdated(e),this.showing=!0}close(e){this.showing=!1,setTimeout((e=>this.dispatchEvent(new CustomEvent("dismissed"))),1e3),e.preventDefault(),e.stopPropagation()}render(){return ft` <div class="toast"> <slot></slot> <div @click="${this.close}" class="close">${br("close","24px")}</div> </div> `}}Pa(Na,"styles",Ma),Pa(Na,"properties",{showing:{type:Boolean,reflect:!0}}),customElements.define("custom-toast",Na);const Ra=encodeURIComponent;var ja=e=>{if("sudokulab.net"!==location.hostname)return;const t=Object.entries({nc:Date.now(),code:"jjIMrMKDsaKUwNIh6ixm1Lp2FCFSQw3Z",url:Ra(location.href.substr(0,1800)),t:Ra(document.title),ref:Ra(document.referrer),w:screen.width,h:screen.height});fetch(`https://api.pirsch.io/hit?${t.map((([e,t])=>`${e}=${t}`)).join("&")}`)};const Da=Rt`*{box-sizing:border-box}:host{--base-font-size:1px;height:calc(100vh);width:calc(100vw);min-width:0;min-height:0;margin:0;padding:0;font-family:Helvetica;outline:0}header{top:0;height:40px;width:100vw;padding:0 1.5vw;display:grid;grid-template-columns:175px auto min(320px,27%);grid-auto-rows:1fr;align-items:flex-end;border-bottom:1px solid #a9a9a9}.logo{position:relative;margin:0;font-size:calc(var(--base-font-size) * 30);font-weight:800;cursor:pointer}.logo i{font-style:normal;visibility:hidden}.logo[vis*='a'] .a,.logo[vis*='b'] .b,.logo[vis*='d'] .d,.logo[vis*='k'] .k,.logo[vis*='l'] .l,.logo[vis*='o'] .o,.logo[vis*='s'] .s,.logo[vis*='u1'] .u1,.logo[vis*='u2'] .u2{visibility:visible}.logo[vis*='u1'][vis*='u2'][vis*='s'][vis*='d'][vis*='o'][vis*='k'][vis*='l'][vis*='a'][vis*='b'] .u1,.logo[vis*='u1'][vis*='u2'][vis*='s'][vis*='d'][vis*='o'][vis*='k'][vis*='l'][vis*='a'][vis*='b'] .u2{color:#dc143c;transition:color .2s ease .2s}.title{min-width:0;max-width:100%;justify-self:center;white-space:nowrap;text-overflow:ellipsis;position:relative;overflow-x:hidden}.title h1{display:inline;font-size:calc(var(--base-font-size) * 26);margin:0}.title h3{display:inline;font-size:calc(var(--base-font-size) * 20);margin:0;font-weight:400}nav{position:relative;width:100%;padding-left:25px;font-size:calc(var(--base-font-size) * 20);z-index:2}.menuicon{display:none}nav .items{display:grid;grid-auto-flow:column;justify-self:flex-end;justify-content:space-between}nav .items div{font-weight:400;color:#a9a9a9;cursor:pointer;padding:3px 5px 0 5px}nav .items div[selected]{color:#000}nav .items div:not([selected]):hover{color:#000}main{position:fixed;top:40px;height:calc(100vh - 54px);width:100vw;display:grid;grid-template-columns:min(100vh - 54px,55vw) max(100vw - 100vh + 54px,45vw);grid-auto-flow:column;overflow:auto;background:linear-gradient(white,#97b1ca);z-index:-1}sudoku-controls,sudoku-grid{position:relative;opacity:1}sudoku-controls:not([mode]),sudoku-grid:not([mode]){opacity:0}sudoku-controls{z-index:-1}footer{position:fixed;bottom:0;text-align:right;width:100%;height:14px;background-color:#fff;font-size:calc(var(--base-font-size) * 13);border-top:1px solid #a9a9a9}footer div{display:inline-block;margin:0 5px}footer a{color:#000}@media (orientation:portrait){main{grid-auto-flow:row;grid-template-columns:1fr;grid-template-rows:min(99vmin,70vh) auto}:host([mode="puzzles"]) main,:host([mode="settings"]) main{grid-template-rows:calc(100% - 40px)}sudoku-grid[mode="puzzles"],sudoku-grid[mode="settings"]{display:none}}@media screen and (max-width:1023px){:host{--base-font-size:.7px}header{grid-template-columns:150px auto 40px;padding:0 1vw;height:30px}.logo{font-size:calc(var(--base-font-size) * 40)}.menuicon{display:block;height:30px;width:30px;bottom:10px}nav{font-size:calc(var(--base-font-size) * 30);padding-left:10px;text-align:right}nav .items{grid-auto-flow:row;position:absolute;transform:scaleY(0);transform-origin:top right;top:35px;right:0;padding:1px 16px;opacity:0;background-color:#fff;border:1px solid #a9a9a9;border-top:0;box-shadow:0 2px 2px rgba(0,0,0,.5)}nav.open .items{transform:scaleY(1);opacity:1;transition:opacity 150ms ease,transform 150ms ease}main{top:30px;height:calc(100vh - 44px)}}@media only screen and (min-device-width:375px) and (max-device-width:667px) and (-webkit-min-device-pixel-ratio:2){:host{--base-font-size:.7px}nav{outline:0}}`;var Ua=Object.defineProperty,Fa=(e,t,i)=>(((e,t,i)=>{t in e?Ua(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);const{NORTH:Ha,SOUTH:Ba,WEST:Wa,EAST:Va}=M,Ga={ArrowLeft:Wa,ArrowRight:Va,ArrowUp:Ha,ArrowDown:Ba},qa="1.0.348".replace(/\d+$/,(e=>e));class Ka extends(Xt(ur)(Zt)){constructor(){super(),this.select=this.createSelectors(),document.addEventListener("keydown",this.keyDown.bind(this)),document.addEventListener("keyup",this.keyUp.bind(this)),this.addEventListener("dragover",this.dragover.bind(this)),this.addEventListener("drop",this.drop.bind(this)),document.addEventListener("paste",this.paste.bind(this),{capture:!0}),this.setAttribute("tabindex",0),this.menuOpen=!1,this.store=ur,qe()&&(window.onresize=e=>{this.shadowRoot.querySelector("sudoku-grid").setAttribute("style","z-index: 0"),this.shadowRoot.querySelector("main").setAttribute("style","z-index: 0"),setTimeout((e=>this.shadowRoot.querySelector("sudoku-grid").setAttribute("style","z-index: 1")),100),setTimeout((e=>this.shadowRoot.querySelector("main").setAttribute("style","z-index: 1")),100)})}createSelectors(){return{...Pi,...Ws,...Vs,...qs,...Gs}}stateChanged(e){if(this.mode=this.select.mode(e),this.keyMode=this.select.keyMode(e),this.puzzle=this.select.puzzle(e),this.solutionCount=this.select.solutionCount.stats.count(e),this.selectedCells=this.select.selectedCells(e),this.options=this.select.options(e),this.peers=this.select.peers(e),this.candidates=this.select.candidates(e),this.notifications=this.select.notifications(e),this.settings=this.select.settings(e),this.cells=this.select.cells(e),this.values=this.select.values(e),this.selectingCells=this.select.selectingCells(e),this.cellColors=this.select.cellColors(e),this.cornerMarks=this.select.cornerMarks(e),this.centerMarks=this.select.centerMarks(e),this.cursor=this.select.cursor(e),this.palette=this.select.palette(e),this.urlSet){const e=ir(we(this.puzzle)),t="?puzzle="+e;if("(-_4tYNs?D(n.*!b9IywF4uduB}r*t"===e)""!==location.search&&history.replaceState({},"",location.pathname);else if(location.search!==t)if(Object.values(this.puzzle.alias??[])[0]===e){const e="?pzl="+Object.keys(this.puzzle.alias??{})[0];location.search!==e&&history.replaceState({},"",e)}else history.replaceState({},"",t);document.title!==`sudokulab - ${this.puzzle.name}`&&(document.title=`sudokulab - ${this.puzzle.name}`)}this.setDocumentTitle()}setDocumentTitle(){document.title=`${this.solutionCount?"*":""}sudokulab${this.puzzle.name?` - ${this.puzzle.name}${this.puzzle.setter?` by ${this.puzzle.setter}`:""}`:""}`}firstUpdated(e){super.firstUpdated(e),setTimeout((e=>{this.focus(),window.scrollTo(0,1)})),this.grid=this.shadowRoot.querySelector("sudoku-grid"),this.animateLogo(),this.initializeUrl(),this.initializeMenu()}initializeMenu(){const e=this.shadowRoot.querySelector("nav");this.clickOutsideMenuListener=this.shadowRoot.addEventListener("click",(t=>{this.menuOpen&&!t.composedPath().includes(e)&&(this.menuOpen=!1)}),!0)}disconnectedCallback(){this.shadowRoot.removeEventListener("click",this.clickOutsideMenuListener,!0)}animateLogo(){const e=this.shadowRoot.querySelector(".logo"),t=e.attributes.vis;e.innerHTML="su1doku2lab".match(/.\d?/g).map((e=>`<i class="${e}">${e[0]}</i>`)).join(""),e.onclick=i=>{return o=[...e.childNodes].map((e=>e.className)),t.value="",o.sort((e=>Math.random()-.5)).forEach(((e,i)=>setTimeout((i=>t.value+=e),~~(150*Math.random())+150*i)));var o},e.click()}initializeUrl(){if(location.search){const e=location.search.slice(1).split(/&/).map((e=>e.split(/=/))).reduce(((e,[t,...i])=>(e[t]=e[t]||[],e[t].push(i.join("=")),e)),{});if(e.pzl){const t=e.pzl[0],i=t.match(/^[^!_]/);fetch("https://api-ssl.bitly.com/v4/expand",{method:"POST",headers:{Authorization:"Bearer a53f6cf70ecdf6c3eb3d1725b46c84ebc0bfa114","Content-Type":"application/json"},body:JSON.stringify({bitlink_id:`bit.ly/${i?t:t.slice(1)}${i?"_slab":""}`})}).then((e=>e.json())).then((e=>{const i=e.long_url.replace(/^.*puzzle=/,""),o=Ke(or(decodeURIComponent(i)));o.alias={[t]:i},ur.dispatch(ei(o)),this.urlSet=!0,ur.resolveAwaitUrlSet&&ur.resolveAwaitUrlSet()})).catch((e=>{location.href=`https://bit.ly/${i?t:t.slice(1)}${i?"_slab":""}`})).finally((e=>{ja()}))}else if(e.puzzle){const t=Ke(or(decodeURIComponent(e.puzzle[0])));ur.dispatch(ei(t)),this.urlSet=!0,ur.resolveAwaitUrlSet&&ur.resolveAwaitUrlSet(),ja()}else if(e.fpuzzle||e.fpuzzles){try{const{puzzle:t,grid:i}=Mr(JSON.parse(Ir(decodeURIComponent(e.fpuzzle??e.fpuzzles))));ur.dispatch(ei(t))}catch(e){e instanceof zr&&alert("Oops! Sudokulab does not support the following puzzle feature: "+e.message)}finally{ja()}this.urlSet=!0,ur.resolveAwaitUrlSet&&ur.resolveAwaitUrlSet()}}else ur.dispatch(ei()),this.urlSet=!0,ur.resolveAwaitUrlSet&&ur.resolveAwaitUrlSet(),ja()}dispatch(e,t=!0){this.paused&&t||ur.dispatch(e)}notificationDismisser(e){return t=>{ur.dispatch((e=>({type:"CLEAR_NOTIFICATION",notification:e}))(e)),t.preventDefault(),t.stopPropagation()}}modeSetter(e){return t=>{("keydown"===t.type&&"Enter"===t.key||"click"===t.type)&&(this.dispatch(fi(e)),this.menuOpen=!1,t.preventDefault(),t.stopPropagation())}}toggleMenu(e){("keydown"===e.type&&"Enter"===e.key||"click"===e.type)&&(this.menuOpen=!this.menuOpen,e.preventDefault(),e.stopPropagation())}paste(e){if(!e.composedPath().find(be)){const t=e.clipboardData.getData("Text");if(t){try{const{puzzle:e,grid:i}=Mr(JSON.parse(Ir(t.replace(/^.*load=/,""))));ur.dispatch(ei(e))}catch(e){e instanceof zr&&alert("Oops! Sudokulab does not support the following puzzle feature: "+e.message)}e.preventDefault(),e.stopPropagation()}}}drop(e){const t=e.dataTransfer.files.item(0),i=e.dataTransfer.getData("Text");if(t)t.arrayBuffer().then((e=>{let t=Ke(e);ur.dispatch(ei(t,this.options))})),e.preventDefault(),e.stopPropagation();else if(i){try{const{puzzle:e,grid:t}=Mr(JSON.parse(Ir(i.replace(/^.*load=/,""))));ur.dispatch(ei(e))}catch(e){e instanceof zr&&alert("Oops! Sudokulab does not support the following puzzle feature: "+e.message)}e.preventDefault(),e.stopPropagation()}}dragover(e){e.preventDefault(),e.stopPropagation()}keyUp(e){const t={ctrlKey:"Control",altKey:"Alt",shiftKey:"Shift"};be(e.composedPath()[0])||(Object.values(t).includes(e.key)&&this.dispatch({type:"CLEAR_TENTATIVE_CELL_SELECTION"}),"play"===this.mode&&Object.values(t).includes(e.key)&&this.dispatch(mi("values")))}keyDown(t){const i={ctrlKey:"Control",altKey:"Alt",shiftKey:"Shift",metaKey:"Meta"};if(be(t.composedPath()[0]))return;if(this.selectingCells&&"play"===this.mode){if([i[this.settings.rowModifier],i[this.settings.columnModifier],i[this.settings.boxModifier]].includes(t.key))return this.tentativelySelectCells(t),t.preventDefault(),void t.stopPropagation()}else{if(t.key===i[this.settings.cornersModifier]&&"play"===this.mode)return void this.dispatch(mi("corners"));if(t.key===i[this.settings.centersModifier]&&"play"===this.mode)return void this.dispatch(mi("centers"));if(t.key===i[this.settings.colorsModifier]&&"play"===this.mode)return void this.dispatch(mi("colors"))}if("Space"===t.code&&"play"===this.mode)return this.dispatch(mi(Qt[(Qt.indexOf(this.keyMode)+1)%Qt.length])),t.preventDefault(),void t.stopPropagation();if("KeyZ"===t.code&&(t.metaKey||t.ctrlKey))return t.shiftKey?this.dispatch(on.redo()):this.dispatch(on.undo()),t.preventDefault(),void t.stopPropagation();if(this.settings.zxcvkeys&&["KeyZ","KeyX","KeyC","KeyV"].includes(t.code)&&!t.ctrlKey&&!t.metaKey)switch(t.code){case"KeyZ":return this.dispatch(mi("values")),t.preventDefault(),void t.stopPropagation();case"KeyX":return this.dispatch(mi("corners")),t.preventDefault(),void t.stopPropagation();case"KeyC":return this.dispatch(mi("centers")),t.preventDefault(),void t.stopPropagation();case"KeyV":return this.dispatch(mi("colors")),t.preventDefault(),void t.stopPropagation()}if(Object.keys(Ga).includes(t.key))return 0===this.selectedCells.length?void this.dispatch(ai(0,!1,this.peers)):(this.dispatch({type:"MOVE_CELL_POSITION",direction:Ga[t.key],accumulate:t[this.settings.addRemoveModifier],puzzle:this.puzzle,peers:this.peers}),t.preventDefault(),void t.stopPropagation());if((navigator.platform.includes("Mac")?t.metaKey:t.ctrlKey)&&"KeyA"===t.code)return this.dispatch(ci(this.cursor,e(this.puzzle.size**2,(e=>!0)),!1)),t.preventDefault(),void t.stopPropagation();const o=t[this.settings.cornersModifier]||"corners"===this.keyMode,s=t[this.settings.centersModifier]||"centers"===this.keyMode,n=t[this.settings.colorsModifier]||"colors"===this.keyMode;if(!t.metaKey&&t.key.match(/Backspace|Delete/)){const e=this.selectedCells.filter((e=>0===this.puzzle.givens[e]||"edit"===this.mode||"solve"===this.mode)),i=this.selectedCells.some((e=>0!==this.values[e]&&0===this.puzzle.givens[e])),r=this.selectedCells.some((e=>0!==this.puzzle.givens[e])),a=this.selectedCells.some((e=>this.options.autoCandidates?""!==this.candidates[e]:""!==this.cornerMarks[e])),l=this.selectedCells.some((e=>""!==this.centerMarks[e])),c=this.selectedCells.some((e=>0!==this.cellColors[e]));return"edit"===this.mode&&"values"!==this.keyMode?ur.dispatch({type:"DELETE_FEATURE_ITEM"}):n&&c?this.dispatch(vi(this.selectedCells,this.puzzle)):o&&a?this.dispatch(di(e,this.options.autoCandidates&&this.candidates,this.puzzle)):s&&l?this.dispatch(hi(e)):!r||"edit"!==this.mode&&"solve"!==this.mode?i?this.dispatch(oi(e,this.puzzle,this.options)):a?this.dispatch(di(e,this.options.autoCandidates&&this.candidates,this.puzzle)):l?this.dispatch(hi(e)):c&&this.dispatch(vi(this.selectedCells,this.puzzle)):this.dispatch(ni(e)),t.preventDefault(),void t.stopPropagation()}if(localStorage.getItem("SET coloring")){const e="NumpadAdd"===t.code||t.shiftKey&&"Equal"===t.code,i="NumpadSubtract"===t.code||!t.shiftKey&&"Minus"===t.code;if(e||i)return ur.dispatch(e?Ti(this.selectedCells):Oi(this.selectedCells)),t.preventDefault(),void t.stopPropagation()}const r=t.code.replace(/^Digit|^Numpad/,"");if(!t.metaKey&&r>0&&r<=9){const e=this.selectedCells.filter((e=>0===this.puzzle.givens[e]||"edit"===this.mode||"solve"===this.mode));return e.length&&(o?this.dispatch(ui(e,Number(r),this.options.autoCandidates&&this.candidates,this.puzzle)):s?this.dispatch(pi(e,Number(r))):n?this.dispatch(gi(this.selectedCells,`${this.palette}-${r}`,this.puzzle)):"edit"===this.mode||"solve"===this.mode?this.dispatch(si(e,t.key)):this.dispatch(ii(e,t.key,this.puzzle,this.options))),t.preventDefault(),void t.stopPropagation()}}tentativelySelectCells(e){const{columnModifier:t,rowModifier:i,boxModifier:o}=this.settings,s=e[t]?"column":e[i]?"row":e[o]?"box":void 0,n=e.target.closest("sudoku-cell");if(s&&n){const e=this.cells[n.position][s],t=this.cells.filter((t=>t[s]===e)).map((e=>e.index)).filter((e=>!this.selectedCells.includes(e)));this.dispatch(li(t,!0))}}renderStyles(){return ft` <style>${[`* {--selection-background-color: ${this.settings.selectionColor};`,`--given-background-color: ${this.settings.givenBackgroundColor};`,`--svg-saturation: ${"play"!==this.mode&&"settings"!==this.mode||!this.settings.dimColors?"100%":"15%"};`,`${Vn.default.map(((e,t)=>`--cell-color-${t+1}:#${e.toString(16)};`)).join("")}`,`${Object.entries(Vn).flatMap((([e,t])=>t.map(((t,i)=>`--cell-color-${e}-${i+1}:#${t.toString(16).padStart(6,0)};`)))).join("")}}`].join("")}</style> `}render(){return ft` <header> <h2 class="logo" vis=""></h2> <div class="title"> <h1>${this.puzzle.name??""}</h1> <h3>${this.puzzle.setter?ft` by ${this.puzzle.setter}`:""}</h3> </div> <nav class="${hr({open:this.menuOpen})}"> <div tabindex="0" @keydown="${this.toggleMenu}" @click="${this.toggleMenu}" class="menuicon">${br(this.menuOpen?"menuopen":"menu","30px")}</div> <div class="items"> ${Object.entries({play:"Play",edit:"Edit",solve:"Solve",settings:"Settings"}).map((([e,t])=>ft`<div tabindex="0" ?selected="${this.mode===e}" @keydown="${this.modeSetter(e)}" @click="${this.modeSetter(e)}"> ${t} </div>`))} </div> </nav> </header> <main> ${this.renderStyles()} <sudoku-grid tabindex="0"></sudoku-grid> <sudoku-controls></sudoku-controls> ${this.notifications.map((e=>ft` <custom-toast @dismissed="${this.notificationDismisser(e)}">${e}</custom-toast> `))} </main> <footer> <div class="version">sudokulab v${qa}</div> </footer> `}}Fa(Ka,"properties",{mode:{type:String,reflect:!0},puzzle:Object,selectedCells:Array,options:Object,menuOpen:Boolean,candidates:Array,notifications:Array,settings:Object,cells:Array,values:Array,selectingCells:Boolean,cornerMarks:Array,centerMarks:Array,cellColors:Array,cursor:Number,palette:String}),Fa(Ka,"styles",Da),customElements.define("sudoku-lab",Ka);

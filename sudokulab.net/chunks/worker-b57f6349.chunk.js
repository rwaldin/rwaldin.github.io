"Atomics"in self||(self.Atomics={store:(t,e,s)=>t[e]=s,load:(t,e)=>t[e]});var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function s(t,e,s){return t(s={path:e,exports:{},require:function(t,e){return i(null==e&&s.path)}},s.exports),s.exports}function i(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var n=s((function(e,s){(function(){var t=this||{},i=t.jsonic,n=t.jsonic=function(t){return"[object String]"!==Object.prototype.toString.call(t)?Object.prototype.toString.call(t).match(/\[object (Object|Array)\]/)?t:""+t:("{"!=(t=t.trim())[0]&&"["!=t[0]&&(t="{"+t+"}"),r.parse(t))};n.noConflict=function(){return t.jsonic=i,n};var r=function(){function t(t,e,s,i,n,r){this.message=t,this.expected=e,this.found=s,this.offset=i,this.line=n,this.column=r,this.name="SyntaxError"}return function(t,e){function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s}(t,Error),{SyntaxError:t,parse:function(e){var s,i=arguments.length>1?arguments[1]:{},n={},r={start:be},o=be,a=n,l=function(t){return t},c=function(t){return t},u="{",h={type:"literal",value:"{",description:'"{"'},d="}",f={type:"literal",value:"}",description:'"}"'},p=function(){return{}},m=function(t){return t},g=null,_=",",w={type:"literal",value:",",description:'","'},b=function(t,e){var s={};t&&(s[t[0]]=Ge(t[1]));for(var i=0;i<e.length;i++)s[e[i][2][0]]=Ge(e[i][2][1]);return s},v=":",y={type:"literal",value:":",description:'":"'},$=function(t,e){return[t,e]},x="[",k={type:"literal",value:"[",description:'"["'},E="]",O={type:"literal",value:"]",description:'"]"'},A=function(){return[]},T=function(t){return t},S=function(t,e){var s=[];null!=t&&s.push(Ge(t));for(var i=0;i<e.length;i++)s.push(Ge(e[i][2]));return s},z="true",C={type:"literal",value:"true",description:'"true"'},I=function(){return!0},R="false",j={type:"literal",value:"false",description:'"false"'},N=function(){return!1},D="null",U={type:"literal",value:"null",description:'"null"'},L=function(){return qe},P=function(t){return t.join("").trim()},M={type:"other",description:"double-quote string"},F='"',Z={type:"literal",value:'"',description:'"\\""'},B=function(){return""},H=function(t){return t},W={type:"other",description:"single-quote string"},q="'",G={type:"literal",value:"'",description:'"\'"'},K=function(t){return t.join("")},V=/^[^"\\\0-\x1F]/,J={type:"class",value:'[^"\\\\\\0-\\x1F]',description:'[^"\\\\\\0-\\x1F]'},X='\\"',Y={type:"literal",value:'\\"',description:'"\\\\\\""'},Q=function(){return'"'},tt="\\\\",et={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},st=function(){return"\\"},it="\\/",nt={type:"literal",value:"\\/",description:'"\\\\/"'},rt=function(){return"/"},ot="\\b",at={type:"literal",value:"\\b",description:'"\\\\b"'},lt=function(){return"\b"},ct="\\f",ut={type:"literal",value:"\\f",description:'"\\\\f"'},ht=function(){return"\f"},dt="\\n",ft={type:"literal",value:"\\n",description:'"\\\\n"'},pt=function(){return"\n"},mt="\\r",gt={type:"literal",value:"\\r",description:'"\\\\r"'},_t=function(){return"\r"},wt="\\t",bt={type:"literal",value:"\\t",description:'"\\\\t"'},vt=function(){return"\t"},yt="\\u",$t={type:"literal",value:"\\u",description:'"\\\\u"'},xt=function(t,e,s,i){return String.fromCharCode(parseInt("0x"+t+e+s+i))},kt=/^[^'\\\0-\x1F]/,Et={type:"class",value:"[^'\\\\\\0-\\x1F]",description:"[^'\\\\\\0-\\x1F]"},Ot="\\'",At={type:"literal",value:"\\'",description:'"\\\\\'"'},Tt=function(){return"'"},St={type:"other",description:"key"},zt=/^[a-zA-Z0-9_$\-]/,Ct={type:"class",value:"[a-zA-Z0-9_$\\-]",description:"[a-zA-Z0-9_$\\-]"},It=function(t){return t.join("")},Rt=/^[^,}\]]/,jt={type:"class",value:"[^,}\\]]",description:"[^,}\\]]"},Nt={type:"other",description:"number"},Dt=function(t,e,s,i){return 0===i.length?parseFloat(t+e+s):(t+e+s+i.join("")).trim()},Ut=function(t,e,s){return 0===s.length?parseFloat(t+e):(t+e+s.join("")).trim()},Lt=function(t,e,s){return 0===s.length?parseFloat(t+e):(t+e+s.join("")).trim()},Pt=function(t,e){return 0===e.length?parseFloat(t):(t+e.join("")).trim()},Mt=function(t,e){return t+e},Ft="-",Zt={type:"literal",value:"-",description:'"-"'},Bt=function(t,e){return"-"+t+e},Ht=function(t){return"-"+t},Wt=".",qt={type:"literal",value:".",description:'"."'},Gt=function(t){return"."+t},Kt=function(t,e){return t+e},Vt=function(t){return t.join("")},Jt=/^[eE]/,Xt={type:"class",value:"[eE]",description:"[eE]"},Yt=/^[+\-]/,Qt={type:"class",value:"[+\\-]",description:"[+\\-]"},te=function(t,e){return t+(e||"")},ee=/^[0-9]/,se={type:"class",value:"[0-9]",description:"[0-9]"},ie=/^[1-9]/,ne={type:"class",value:"[1-9]",description:"[1-9]"},re=/^[0-9a-fA-F]/,oe={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},ae={type:"other",description:"whitespace"},le=/^[ \t\n\r]/,ce={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},ue=0,he=0,de={line:1,column:1,seenCR:!1},fe=0,pe=[],me=0;if("startRule"in i){if(!(i.startRule in r))throw new Error("Can't start parsing from rule \""+i.startRule+'".');o=r[i.startRule]}function ge(t){return he!==t&&(he>t&&(he=0,de={line:1,column:1,seenCR:!1}),function(t,s,i){var n,r;for(n=s;n<i;n++)"\n"===(r=e.charAt(n))?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}(de,he,t),he=t),de}function _e(t){ue<fe||(ue>fe&&(fe=ue,pe=[]),pe.push(t))}function we(s,i,n){var r=ge(n),o=n<e.length?e.charAt(n):null;return null!==i&&function(t){var e=1;for(t.sort((function(t,e){return t.description<e.description?-1:t.description>e.description?1:0}));e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(i),new t(null!==s?s:function(t,e){var s,i=new Array(t.length);for(s=0;s<t.length;s++)i[s]=t[s].description;return"Expected "+(t.length>1?i.slice(0,-1).join(", ")+" or "+i[t.length-1]:i[0])+" but "+(e?'"'+function(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(t){return"\\x0"+e(t)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(t){return"\\x"+e(t)})).replace(/[\u0180-\u0FFF]/g,(function(t){return"\\u0"+e(t)})).replace(/[\u1080-\uFFFF]/g,(function(t){return"\\u"+e(t)}))}(e)+'"':"end of input")+" found."}(i,o),i,o,n,r.line,r.column)}function be(){var t,e;return t=ue,He()!==n&&(e=ve())!==n?t=l(e):(ue=t,t=a),t===n&&(t=ue,He()!==n&&(e=xe())!==n?t=c(e):(ue=t,t=a)),t}function ve(){var t,s,i,r;return t=ue,123===e.charCodeAt(ue)?(s=u,ue++):(s=n,0===me&&_e(h)),s!==n&&He()!==n?(125===e.charCodeAt(ue)?(i=d,ue++):(i=n,0===me&&_e(f)),i!==n&&(r=He())!==n?t=s=p():(ue=t,t=a)):(ue=t,t=a),t===n&&(t=ue,123===e.charCodeAt(ue)?(s=u,ue++):(s=n,0===me&&_e(h)),s!==n&&He()!==n&&(i=ye())!==n?(125===e.charCodeAt(ue)?(r=d,ue++):(r=n,0===me&&_e(f)),r!==n&&He()!==n?t=s=m(i):(ue=t,t=a)):(ue=t,t=a)),t}function ye(){var t,s,i,r,o,l,c,u;if(t=ue,44===e.charCodeAt(ue)?(s=_,ue++):(s=n,0===me&&_e(w)),s===n&&(s=g),s!==n)if((i=$e())===n&&(i=g),i!==n){for(r=[],o=ue,44===e.charCodeAt(ue)?(l=_,ue++):(l=n,0===me&&_e(w)),l!==n&&(c=He())!==n&&(u=$e())!==n?o=l=[l,c,u]:(ue=o,o=a);o!==n;)r.push(o),o=ue,44===e.charCodeAt(ue)?(l=_,ue++):(l=n,0===me&&_e(w)),l!==n&&(c=He())!==n&&(u=$e())!==n?o=l=[l,c,u]:(ue=o,o=a);r!==n?(44===e.charCodeAt(ue)?(o=_,ue++):(o=n,0===me&&_e(w)),o===n&&(o=g),o!==n&&(l=He())!==n?t=s=b(i,r):(ue=t,t=a)):(ue=t,t=a)}else ue=t,t=a;else ue=t,t=a;return t}function $e(){var t,s,i,r;return t=ue,(s=Ie())!==n&&He()!==n?(58===e.charCodeAt(ue)?(i=v,ue++):(i=n,0===me&&_e(y)),i!==n&&He()!==n&&(r=Ee())!==n?t=s=$(s,r):(ue=t,t=a)):(ue=t,t=a),t}function xe(){var t,s,i,r;return t=ue,91===e.charCodeAt(ue)?(s=x,ue++):(s=n,0===me&&_e(k)),s!==n&&He()!==n?(93===e.charCodeAt(ue)?(i=E,ue++):(i=n,0===me&&_e(O)),i!==n&&(r=He())!==n?t=s=A():(ue=t,t=a)):(ue=t,t=a),t===n&&(t=ue,91===e.charCodeAt(ue)?(s=x,ue++):(s=n,0===me&&_e(k)),s!==n&&He()!==n&&(i=ke())!==n?(93===e.charCodeAt(ue)?(r=E,ue++):(r=n,0===me&&_e(O)),r!==n&&He()!==n?t=s=T(i):(ue=t,t=a)):(ue=t,t=a)),t}function ke(){var t,s,i,r,o,l,c,u;if(t=ue,44===e.charCodeAt(ue)?(s=_,ue++):(s=n,0===me&&_e(w)),s===n&&(s=g),s!==n)if((i=Ee())===n&&(i=g),i!==n){for(r=[],o=ue,44===e.charCodeAt(ue)?(l=_,ue++):(l=n,0===me&&_e(w)),l!==n&&(c=He())!==n&&(u=Ee())!==n?o=l=[l,c,u]:(ue=o,o=a);o!==n;)r.push(o),o=ue,44===e.charCodeAt(ue)?(l=_,ue++):(l=n,0===me&&_e(w)),l!==n&&(c=He())!==n&&(u=Ee())!==n?o=l=[l,c,u]:(ue=o,o=a);r!==n?(44===e.charCodeAt(ue)?(o=_,ue++):(o=n,0===me&&_e(w)),o===n&&(o=g),o!==n&&(l=He())!==n?t=s=S(i,r):(ue=t,t=a)):(ue=t,t=a)}else ue=t,t=a;else ue=t,t=a;return t}function Ee(){var t,s;return(t=Oe())===n&&(t=Ae())===n&&(t=ve())===n&&(t=xe())===n&&(t=ue,e.substr(ue,4)===z?(s=z,ue+=4):(s=n,0===me&&_e(C)),s!==n&&He()!==n?t=s=I():(ue=t,t=a),t===n&&(t=ue,e.substr(ue,5)===R?(s=R,ue+=5):(s=n,0===me&&_e(j)),s!==n&&He()!==n?t=s=N():(ue=t,t=a),t===n&&(t=ue,e.substr(ue,4)===D?(s=D,ue+=4):(s=n,0===me&&_e(U)),s!==n&&He()!==n?t=s=L():(ue=t,t=a),t===n&&(t=Ne())===n&&(t=ue,(s=Re())!==n&&(s=P(s)),t=s)))),t}function Oe(){var t,s,i,r;return me++,t=ue,34===e.charCodeAt(ue)?(s=F,ue++):(s=n,0===me&&_e(Z)),s!==n?(34===e.charCodeAt(ue)?(i=F,ue++):(i=n,0===me&&_e(Z)),i!==n&&(r=He())!==n?t=s=B():(ue=t,t=a)):(ue=t,t=a),t===n&&(t=ue,34===e.charCodeAt(ue)?(s=F,ue++):(s=n,0===me&&_e(Z)),s!==n&&(i=Te())!==n?(34===e.charCodeAt(ue)?(r=F,ue++):(r=n,0===me&&_e(Z)),r!==n&&He()!==n?t=s=H(i):(ue=t,t=a)):(ue=t,t=a)),me--,t===n&&(s=n,0===me&&_e(M)),t}function Ae(){var t,s,i,r;return me++,t=ue,39===e.charCodeAt(ue)?(s=q,ue++):(s=n,0===me&&_e(G)),s!==n?(39===e.charCodeAt(ue)?(i=q,ue++):(i=n,0===me&&_e(G)),i!==n&&(r=He())!==n?t=s=B():(ue=t,t=a)):(ue=t,t=a),t===n&&(t=ue,39===e.charCodeAt(ue)?(s=q,ue++):(s=n,0===me&&_e(G)),s!==n&&(i=ze())!==n?(39===e.charCodeAt(ue)?(r=q,ue++):(r=n,0===me&&_e(G)),r!==n&&He()!==n?t=s=H(i):(ue=t,t=a)):(ue=t,t=a)),me--,t===n&&(s=n,0===me&&_e(W)),t}function Te(){var t,e;if(t=[],(e=Se())!==n)for(;e!==n;)t.push(e),e=Se();else t=a;return t!==n&&(t=K(t)),t}function Se(){var t,s,i,r,o,l;return V.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(J)),t===n&&(t=ue,e.substr(ue,2)===X?(s=X,ue+=2):(s=n,0===me&&_e(Y)),s!==n&&(s=Q()),(t=s)===n&&(t=ue,e.substr(ue,2)===tt?(s=tt,ue+=2):(s=n,0===me&&_e(et)),s!==n&&(s=st()),(t=s)===n&&(t=ue,e.substr(ue,2)===it?(s=it,ue+=2):(s=n,0===me&&_e(nt)),s!==n&&(s=rt()),(t=s)===n&&(t=ue,e.substr(ue,2)===ot?(s=ot,ue+=2):(s=n,0===me&&_e(at)),s!==n&&(s=lt()),(t=s)===n&&(t=ue,e.substr(ue,2)===ct?(s=ct,ue+=2):(s=n,0===me&&_e(ut)),s!==n&&(s=ht()),(t=s)===n&&(t=ue,e.substr(ue,2)===dt?(s=dt,ue+=2):(s=n,0===me&&_e(ft)),s!==n&&(s=pt()),(t=s)===n&&(t=ue,e.substr(ue,2)===mt?(s=mt,ue+=2):(s=n,0===me&&_e(gt)),s!==n&&(s=_t()),(t=s)===n&&(t=ue,e.substr(ue,2)===wt?(s=wt,ue+=2):(s=n,0===me&&_e(bt)),s!==n&&(s=vt()),(t=s)===n&&(t=ue,e.substr(ue,2)===yt?(s=yt,ue+=2):(s=n,0===me&&_e($t)),s!==n&&(i=Be())!==n&&(r=Be())!==n&&(o=Be())!==n&&(l=Be())!==n?t=s=xt(i,r,o,l):(ue=t,t=a)))))))))),t}function ze(){var t,e;if(t=[],(e=Ce())!==n)for(;e!==n;)t.push(e),e=Ce();else t=a;return t!==n&&(t=K(t)),t}function Ce(){var t,s,i,r,o,l;return kt.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(Et)),t===n&&(t=ue,e.substr(ue,2)===Ot?(s=Ot,ue+=2):(s=n,0===me&&_e(At)),s!==n&&(s=Tt()),(t=s)===n&&(t=ue,e.substr(ue,2)===tt?(s=tt,ue+=2):(s=n,0===me&&_e(et)),s!==n&&(s=st()),(t=s)===n&&(t=ue,e.substr(ue,2)===it?(s=it,ue+=2):(s=n,0===me&&_e(nt)),s!==n&&(s=rt()),(t=s)===n&&(t=ue,e.substr(ue,2)===ot?(s=ot,ue+=2):(s=n,0===me&&_e(at)),s!==n&&(s=lt()),(t=s)===n&&(t=ue,e.substr(ue,2)===ct?(s=ct,ue+=2):(s=n,0===me&&_e(ut)),s!==n&&(s=ht()),(t=s)===n&&(t=ue,e.substr(ue,2)===dt?(s=dt,ue+=2):(s=n,0===me&&_e(ft)),s!==n&&(s=pt()),(t=s)===n&&(t=ue,e.substr(ue,2)===mt?(s=mt,ue+=2):(s=n,0===me&&_e(gt)),s!==n&&(s=_t()),(t=s)===n&&(t=ue,e.substr(ue,2)===wt?(s=wt,ue+=2):(s=n,0===me&&_e(bt)),s!==n&&(s=vt()),(t=s)===n&&(t=ue,e.substr(ue,2)===yt?(s=yt,ue+=2):(s=n,0===me&&_e($t)),s!==n&&(i=Be())!==n&&(r=Be())!==n&&(o=Be())!==n&&(l=Be())!==n?t=s=xt(i,r,o,l):(ue=t,t=a)))))))))),t}function Ie(){var t,s,i;if(me++,(t=Oe())===n&&(t=Ae())===n){if(t=ue,s=[],zt.test(e.charAt(ue))?(i=e.charAt(ue),ue++):(i=n,0===me&&_e(Ct)),i!==n)for(;i!==n;)s.push(i),zt.test(e.charAt(ue))?(i=e.charAt(ue),ue++):(i=n,0===me&&_e(Ct));else s=a;s!==n&&(s=It(s)),t=s}return me--,t===n&&(s=n,0===me&&_e(St)),t}function Re(){var t,e;if(t=[],(e=je())!==n)for(;e!==n;)t.push(e),e=je();else t=a;return t}function je(){var t;return Rt.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(jt)),t}function Ne(){var t,e,s,i,r,o,l;if(me++,t=ue,(e=De())!==n)if((s=Ue())!==n)if((i=Le())!==n)if((r=He())!==n){for(o=[],l=je();l!==n;)o.push(l),l=je();o!==n?t=e=Dt(e,s,i,o):(ue=t,t=a)}else ue=t,t=a;else ue=t,t=a;else ue=t,t=a;else ue=t,t=a;if(t===n){if(t=ue,(e=De())!==n)if((s=Ue())!==n)if((i=He())!==n){for(r=[],o=je();o!==n;)r.push(o),o=je();r!==n?t=e=Ut(e,s,r):(ue=t,t=a)}else ue=t,t=a;else ue=t,t=a;else ue=t,t=a;if(t===n){if(t=ue,(e=De())!==n)if((s=Le())!==n)if((i=He())!==n){for(r=[],o=je();o!==n;)r.push(o),o=je();r!==n?t=e=Lt(e,s,r):(ue=t,t=a)}else ue=t,t=a;else ue=t,t=a;else ue=t,t=a;if(t===n)if(t=ue,(e=De())!==n)if((s=He())!==n){for(i=[],r=je();r!==n;)i.push(r),r=je();i!==n?t=e=Pt(e,i):(ue=t,t=a)}else ue=t,t=a;else ue=t,t=a}}return me--,t===n&&(e=n,0===me&&_e(Nt)),t}function De(){var t,s,i,r;return t=ue,(s=Ze())!==n&&(i=Pe())!==n?t=s=Mt(s,i):(ue=t,t=a),t===n&&(t=Fe())===n&&(t=ue,45===e.charCodeAt(ue)?(s=Ft,ue++):(s=n,0===me&&_e(Zt)),s!==n&&(i=Ze())!==n&&(r=Pe())!==n?t=s=Bt(i,r):(ue=t,t=a),t===n&&(t=ue,45===e.charCodeAt(ue)?(s=Ft,ue++):(s=n,0===me&&_e(Zt)),s!==n&&(i=Fe())!==n?t=s=Ht(i):(ue=t,t=a))),t}function Ue(){var t,s,i;return t=ue,46===e.charCodeAt(ue)?(s=Wt,ue++):(s=n,0===me&&_e(qt)),s!==n&&(i=Pe())!==n?t=s=Gt(i):(ue=t,t=a),t}function Le(){var t,e,s;return t=ue,(e=Me())!==n&&(s=Pe())!==n?t=e=Kt(e,s):(ue=t,t=a),t}function Pe(){var t,e;if(t=[],(e=Fe())!==n)for(;e!==n;)t.push(e),e=Fe();else t=a;return t!==n&&(t=Vt(t)),t}function Me(){var t,s,i;return t=ue,Jt.test(e.charAt(ue))?(s=e.charAt(ue),ue++):(s=n,0===me&&_e(Xt)),s!==n?(Yt.test(e.charAt(ue))?(i=e.charAt(ue),ue++):(i=n,0===me&&_e(Qt)),i===n&&(i=g),i!==n?t=s=te(s,i):(ue=t,t=a)):(ue=t,t=a),t}function Fe(){var t;return ee.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(se)),t}function Ze(){var t;return ie.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(ne)),t}function Be(){var t;return re.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(oe)),t}function He(){var t,e;for(me++,t=[],e=We();e!==n;)t.push(e),e=We();return me--,t===n&&(e=n,0===me&&_e(ae)),t}function We(){var t;return le.test(e.charAt(ue))?(t=e.charAt(ue),ue++):(t=n,0===me&&_e(ce)),t}var qe=new Object;function Ge(t){return t===qe?null:t}if((s=o())!==n&&ue===e.length)return s;throw s!==n&&ue<e.length&&_e({type:"end",description:"end of input"}),we(null,pe,fe)}}}();function o(t,e,s){if(s++,null==t)return"null";var i=Object.prototype.toString.call(t).charAt(8);if("F"===i&&!e.showfunc)return null;if(e.custom){if(t.hasOwnProperty("toString"))return t.toString();if(t.hasOwnProperty("inspect"))return t.inspect()}var n,r,a,l=0;if("N"===i)return isNaN(t)?"null":t.toString();if("O"===i){if(n=[],s<=e.depth)for(l in r=0,t){if(r>=e.maxitems)break;var c=!0;for(a=0;a<e.exclude.length&&c;a++)c=!~l.indexOf(e.exclude[a]);if(c=c&&!e.omit[l],null!=(h=o(t[l],e,s))&&c){var u=l.match(/^[a-zA-Z0-9_$]+$/)?l:JSON.stringify(l);n.push(u+":"+h),r++}}return"{"+n.join(",")+"}"}if("A"===i){if(n=[],s<=e.depth)for(;l<t.length&&l<e.maxitems;l++){var h;null!=(h=o(t[l],e,s))&&n.push(h)}return"["+n.join(",")+"]"}var d=t.toString();return(~" \"'\r\n\t,}]".indexOf(d[0])||!~d.match(/,}]/)||~" \r\n\t".indexOf(d[d.length-1]))&&(d="'"+d.replace(/'/g,"\\'")+"'"),d}n.stringify=function(t,e){try{e=e||{};var s={};s.showfunc=e.showfunc||e.f||!1,s.custom=e.custom||e.c||!1,s.depth=e.depth||e.d||3,s.maxitems=e.maxitems||e.mi||11,s.maxchars=e.maxchars||e.mc||111,s.exclude=e.exclude||e.x||["$"];var i=e.omit||e.o||[];s.omit={};for(var n=0;n<i.length;n++)s.omit[i[n]]=!0;var r=o(t,s,0);return null==r?"":r.substring(0,s.maxchars)}catch(e){return"ERROR: jsonic.stringify: "+e+" input was: "+JSON.stringify(t)}},e.exports&&(s=e.exports=n),s.jsonic=n}).call(t)}));/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */function r(t){let e=t.length;for(;--e>=0;)t[e]=0}const o=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),a=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),l=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=new Array(576);r(u);const h=new Array(60);r(h);const d=new Array(512);r(d);const f=new Array(256);r(f);const p=new Array(29);r(p);const m=new Array(30);function g(t,e,s,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=s,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let _,w,b;function v(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}r(m);const y=t=>t<256?d[t]:d[256+(t>>>7)],$=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},x=(t,e,s)=>{t.bi_valid>16-s?(t.bi_buf|=e<<t.bi_valid&65535,$(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=s-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=s)},k=(t,e,s)=>{x(t,s[2*e],s[2*e+1])},E=(t,e)=>{let s=0;do{s|=1&t,t>>>=1,s<<=1}while(--e>0);return s>>>1},O=(t,e,s)=>{const i=new Array(16);let n,r,o=0;for(n=1;n<=15;n++)i[n]=o=o+s[n-1]<<1;for(r=0;r<=e;r++){let e=t[2*r+1];0!==e&&(t[2*r]=E(i[e]++,e))}},A=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},T=t=>{t.bi_valid>8?$(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},S=(t,e,s,i)=>{const n=2*e,r=2*s;return t[n]<t[r]||t[n]===t[r]&&i[e]<=i[s]},z=(t,e,s)=>{const i=t.heap[s];let n=s<<1;for(;n<=t.heap_len&&(n<t.heap_len&&S(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!S(e,i,t.heap[n],t.depth));)t.heap[s]=t.heap[n],s=n,n<<=1;t.heap[s]=i},C=(t,e,s)=>{let i,n,r,l,c=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],n=t.pending_buf[t.l_buf+c],c++,0===i?k(t,n,e):(r=f[n],k(t,r+256+1,e),l=o[r],0!==l&&(n-=p[r],x(t,n,l)),i--,r=y(i),k(t,r,s),l=a[r],0!==l&&(i-=m[r],x(t,i,l)))}while(c<t.last_lit);k(t,256,e)},I=(t,e)=>{const s=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,r=e.stat_desc.elems;let o,a,l,c=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<r;o++)0!==s[2*o]?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):s[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,s[2*l]=1,t.depth[l]=0,t.opt_len--,n&&(t.static_len-=i[2*l+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)z(t,s,o);l=r;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],z(t,s,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,s[2*l]=s[2*o]+s[2*a],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,s[2*o+1]=s[2*a+1]=l,t.heap[1]=l++,z(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const s=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let c,u,h,d,f,p,m=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(s[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)u=t.heap[c],d=s[2*s[2*u+1]+1]+1,d>l&&(d=l,m++),s[2*u+1]=d,u>i||(t.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),p=s[2*u],t.opt_len+=p*(d+f),r&&(t.static_len+=p*(n[2*u+1]+f)));if(0!==m){do{for(d=l-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[l]--,m-=2}while(m>0);for(d=l;0!==d;d--)for(u=t.bl_count[d];0!==u;)h=t.heap[--c],h>i||(s[2*h+1]!==d&&(t.opt_len+=(d-s[2*h+1])*s[2*h],s[2*h+1]=d),u--)}})(t,e),O(s,c,t.bl_count)},R=(t,e,s)=>{let i,n,r=-1,o=e[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),e[2*(s+1)+1]=65535,i=0;i<=s;i++)n=o,o=e[2*(i+1)+1],++a<l&&n===o||(a<c?t.bl_tree[2*n]+=a:0!==n?(n!==r&&t.bl_tree[2*n]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=n,0===o?(l=138,c=3):n===o?(l=6,c=3):(l=7,c=4))},j=(t,e,s)=>{let i,n,r=-1,o=e[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),i=0;i<=s;i++)if(n=o,o=e[2*(i+1)+1],!(++a<l&&n===o)){if(a<c)do{k(t,n,t.bl_tree)}while(0!=--a);else 0!==n?(n!==r&&(k(t,n,t.bl_tree),a--),k(t,16,t.bl_tree),x(t,a-3,2)):a<=10?(k(t,17,t.bl_tree),x(t,a-3,3)):(k(t,18,t.bl_tree),x(t,a-11,7));a=0,r=n,0===o?(l=138,c=3):n===o?(l=6,c=3):(l=7,c=4)}};let N=!1;const D=(t,e,s,i)=>{x(t,0+(i?1:0),3),((t,e,s,i)=>{T(t),$(t,s),$(t,~s),t.pending_buf.set(t.window.subarray(e,e+s),t.pending),t.pending+=s})(t,e,s)};var U={_tr_init:t=>{N||((()=>{let t,e,s,i,n;const r=new Array(16);for(s=0,i=0;i<28;i++)for(p[i]=s,t=0;t<1<<o[i];t++)f[s++]=i;for(f[s-1]=i,n=0,i=0;i<16;i++)for(m[i]=n,t=0;t<1<<a[i];t++)d[n++]=i;for(n>>=7;i<30;i++)for(m[i]=n<<7,t=0;t<1<<a[i]-7;t++)d[256+n++]=i;for(e=0;e<=15;e++)r[e]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,r[8]++;for(;t<=255;)u[2*t+1]=9,t++,r[9]++;for(;t<=279;)u[2*t+1]=7,t++,r[7]++;for(;t<=287;)u[2*t+1]=8,t++,r[8]++;for(O(u,287,r),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=E(t,5);_=new g(u,o,257,286,15),w=new g(h,a,0,30,15),b=new g(new Array(0),l,0,19,7)})(),N=!0),t.l_desc=new v(t.dyn_ltree,_),t.d_desc=new v(t.dyn_dtree,w),t.bl_desc=new v(t.bl_tree,b),t.bi_buf=0,t.bi_valid=0,A(t)},_tr_stored_block:D,_tr_flush_block:(t,e,s,i)=>{let n,r,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,s=4093624447;for(e=0;e<=31;e++,s>>>=1)if(1&s&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),I(t,t.l_desc),I(t,t.d_desc),o=(t=>{let e;for(R(t,t.dyn_ltree,t.l_desc.max_code),R(t,t.dyn_dtree,t.d_desc.max_code),I(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*c[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),n=t.opt_len+3+7>>>3,r=t.static_len+3+7>>>3,r<=n&&(n=r)):n=r=s+5,s+4<=n&&-1!==e?D(t,e,s,i):4===t.strategy||r===n?(x(t,2+(i?1:0),3),C(t,u,h)):(x(t,4+(i?1:0),3),((t,e,s,i)=>{let n;for(x(t,e-257,5),x(t,s-1,5),x(t,i-4,4),n=0;n<i;n++)x(t,t.bl_tree[2*c[n]+1],3);j(t,t.dyn_ltree,e-1),j(t,t.dyn_dtree,s-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),C(t,t.dyn_ltree,t.dyn_dtree)),A(t),i&&T(t)},_tr_tally:(t,e,s)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&s,t.last_lit++,0===e?t.dyn_ltree[2*s]++:(t.matches++,e--,t.dyn_ltree[2*(f[s]+256+1)]++,t.dyn_dtree[2*y(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{x(t,2,3),k(t,256,u),(t=>{16===t.bi_valid?($(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},L=(t,e,s,i)=>{let n=65535&t|0,r=t>>>16&65535|0,o=0;for(;0!==s;){o=s>2e3?2e3:s,s-=o;do{n=n+e[i++]|0,r=r+n|0}while(--o);n%=65521,r%=65521}return n|r<<16|0};const P=new Uint32Array((()=>{let t,e=[];for(var s=0;s<256;s++){t=s;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[s]=t}return e})());var M=(t,e,s,i)=>{const n=P,r=i+s;t^=-1;for(let s=i;s<r;s++)t=t>>>8^n[255&(t^e[s])];return-1^t},F={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Z={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:B,_tr_stored_block:H,_tr_flush_block:W,_tr_tally:q,_tr_align:G}=U,{Z_NO_FLUSH:K,Z_PARTIAL_FLUSH:V,Z_FULL_FLUSH:J,Z_FINISH:X,Z_BLOCK:Y,Z_OK:Q,Z_STREAM_END:tt,Z_STREAM_ERROR:et,Z_DATA_ERROR:st,Z_BUF_ERROR:it,Z_DEFAULT_COMPRESSION:nt,Z_FILTERED:rt,Z_HUFFMAN_ONLY:ot,Z_RLE:at,Z_FIXED:lt,Z_DEFAULT_STRATEGY:ct,Z_UNKNOWN:ut,Z_DEFLATED:ht}=Z,dt=(t,e)=>(t.msg=F[e],e),ft=t=>(t<<1)-(t>4?9:0),pt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let mt=(t,e,s)=>(e<<t.hash_shift^s)&t.hash_mask;const gt=t=>{const e=t.state;let s=e.pending;s>t.avail_out&&(s=t.avail_out),0!==s&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+s),t.next_out),t.next_out+=s,e.pending_out+=s,t.total_out+=s,t.avail_out-=s,e.pending-=s,0===e.pending&&(e.pending_out=0))},_t=(t,e)=>{W(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,gt(t.strm)},wt=(t,e)=>{t.pending_buf[t.pending++]=e},bt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},vt=(t,e,s,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),s),1===t.state.wrap?t.adler=L(t.adler,e,n,s):2===t.state.wrap&&(t.adler=M(t.adler,e,n,s)),t.next_in+=n,t.total_in+=n,n)},yt=(t,e)=>{let s,i,n=t.max_chain_length,r=t.strstart,o=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,c=t.window,u=t.w_mask,h=t.prev,d=t.strstart+258;let f=c[r+o-1],p=c[r+o];t.prev_length>=t.good_match&&(n>>=2),a>t.lookahead&&(a=t.lookahead);do{if(s=e,c[s+o]===p&&c[s+o-1]===f&&c[s]===c[r]&&c[++s]===c[r+1]){r+=2,s++;do{}while(c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&c[++r]===c[++s]&&r<d);if(i=258-(d-r),r=d-258,i>o){if(t.match_start=e,o=i,i>=a)break;f=c[r+o-1],p=c[r+o]}}}while((e=h[e&u])>l&&0!=--n);return o<=t.lookahead?o:t.lookahead},$t=t=>{const e=t.w_size;let s,i,n,r,o;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,s=i;do{n=t.head[--s],t.head[s]=n>=e?n-e:0}while(--i);i=e,s=i;do{n=t.prev[--s],t.prev[s]=n>=e?n-e:0}while(--i);r+=e}if(0===t.strm.avail_in)break;if(i=vt(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=mt(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=mt(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},xt=(t,e)=>{let s,i;for(;;){if(t.lookahead<262){if($t(t),t.lookahead<262&&e===K)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==s&&t.strstart-s<=t.w_size-262&&(t.match_length=yt(t,s)),t.match_length>=3)if(i=q(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=mt(t,t.ins_h,t.window[t.strstart+1]);else i=q(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(_t(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===X?(_t(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(_t(t,!1),0===t.strm.avail_out)?1:2},kt=(t,e)=>{let s,i,n;for(;;){if(t.lookahead<262){if($t(t),t.lookahead<262&&e===K)return 1;if(0===t.lookahead)break}if(s=0,t.lookahead>=3&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==s&&t.prev_length<t.max_lazy_match&&t.strstart-s<=t.w_size-262&&(t.match_length=yt(t,s),t.match_length<=5&&(t.strategy===rt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,i=q(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=mt(t,t.ins_h,t.window[t.strstart+3-1]),s=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(_t(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=q(t,0,t.window[t.strstart-1]),i&&_t(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=q(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===X?(_t(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(_t(t,!1),0===t.strm.avail_out)?1:2};function Et(t,e,s,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=s,this.max_chain=i,this.func=n}const Ot=[new Et(0,0,0,0,((t,e)=>{let s=65535;for(s>t.pending_buf_size-5&&(s=t.pending_buf_size-5);;){if(t.lookahead<=1){if($t(t),0===t.lookahead&&e===K)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const i=t.block_start+s;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,_t(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(_t(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(_t(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(_t(t,!1),t.strm.avail_out),1)})),new Et(4,4,8,4,xt),new Et(4,5,16,8,xt),new Et(4,6,32,32,xt),new Et(4,4,16,16,kt),new Et(8,16,32,32,kt),new Et(8,16,128,128,kt),new Et(8,32,128,256,kt),new Et(32,128,258,1024,kt),new Et(32,258,258,4096,kt)];function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ht,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),pt(this.dyn_ltree),pt(this.dyn_dtree),pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),pt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Tt=t=>{const e=(t=>{if(!t||!t.state)return dt(t,et);t.total_in=t.total_out=0,t.data_type=ut;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=K,B(e),Q})(t);var s;return e===Q&&((s=t.state).window_size=2*s.w_size,pt(s.head),s.max_lazy_match=Ot[s.level].max_lazy,s.good_match=Ot[s.level].good_length,s.nice_match=Ot[s.level].nice_length,s.max_chain_length=Ot[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0),e};var St=(t,e,s,i,n,r)=>{if(!t)return et;let o=1;if(e===nt&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>9||s!==ht||i<8||i>15||e<0||e>9||r<0||r>lt)return dt(t,et);8===i&&(i=9);const a=new At;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=r,a.method=s,Tt(t)},zt=(t,e)=>{let s,i;if(!t||!t.state||e>Y||e<0)return t?dt(t,et):et;const n=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===n.status&&e!==X)return dt(t,0===t.avail_out?it:et);n.strm=t;const r=n.last_flush;if(n.last_flush=e,42===n.status)if(2===n.wrap)t.adler=0,wt(n,31),wt(n,139),wt(n,8),n.gzhead?(wt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),wt(n,255&n.gzhead.time),wt(n,n.gzhead.time>>8&255),wt(n,n.gzhead.time>>16&255),wt(n,n.gzhead.time>>24&255),wt(n,9===n.level?2:n.strategy>=ot||n.level<2?4:0),wt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(wt(n,255&n.gzhead.extra.length),wt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=M(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(wt(n,0),wt(n,0),wt(n,0),wt(n,0),wt(n,0),wt(n,9===n.level?2:n.strategy>=ot||n.level<2?4:0),wt(n,3),n.status=113);else{let e=ht+(n.w_bits-8<<4)<<8,s=-1;s=n.strategy>=ot||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=s<<6,0!==n.strstart&&(e|=32),e+=31-e%31,n.status=113,bt(n,e),0!==n.strstart&&(bt(n,t.adler>>>16),bt(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),gt(t),s=n.pending,n.pending!==n.pending_buf_size));)wt(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),gt(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,wt(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),0===i&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),gt(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}i=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,wt(n,i)}while(0!==i);n.gzhead.hcrc&&n.pending>s&&(t.adler=M(t.adler,n.pending_buf,n.pending-s,s)),0===i&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&gt(t),n.pending+2<=n.pending_buf_size&&(wt(n,255&t.adler),wt(n,t.adler>>8&255),t.adler=0,n.status=113)):n.status=113),0!==n.pending){if(gt(t),0===t.avail_out)return n.last_flush=-1,Q}else if(0===t.avail_in&&ft(e)<=ft(r)&&e!==X)return dt(t,it);if(666===n.status&&0!==t.avail_in)return dt(t,it);if(0!==t.avail_in||0!==n.lookahead||e!==K&&666!==n.status){let s=n.strategy===ot?((t,e)=>{let s;for(;;){if(0===t.lookahead&&($t(t),0===t.lookahead)){if(e===K)return 1;break}if(t.match_length=0,s=q(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,s&&(_t(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(_t(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(_t(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===at?((t,e)=>{let s,i,n,r;const o=t.window;for(;;){if(t.lookahead<=258){if($t(t),t.lookahead<=258&&e===K)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){r=t.strstart+258;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<r);t.match_length=258-(r-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(s=q(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(s=q(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),s&&(_t(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===X?(_t(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(_t(t,!1),0===t.strm.avail_out)?1:2})(n,e):Ot[n.level].func(n,e);if(3!==s&&4!==s||(n.status=666),1===s||3===s)return 0===t.avail_out&&(n.last_flush=-1),Q;if(2===s&&(e===V?G(n):e!==Y&&(H(n,0,0,!1),e===J&&(pt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),gt(t),0===t.avail_out))return n.last_flush=-1,Q}return e!==X?Q:n.wrap<=0?tt:(2===n.wrap?(wt(n,255&t.adler),wt(n,t.adler>>8&255),wt(n,t.adler>>16&255),wt(n,t.adler>>24&255),wt(n,255&t.total_in),wt(n,t.total_in>>8&255),wt(n,t.total_in>>16&255),wt(n,t.total_in>>24&255)):(bt(n,t.adler>>>16),bt(n,65535&t.adler)),gt(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Q:tt)},Ct=t=>{if(!t||!t.state)return et;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?dt(t,et):(t.state=null,113===e?dt(t,st):Q)};const It=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Rt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const s=e.shift();if(s){if("object"!=typeof s)throw new TypeError(s+"must be non-object");for(const e in s)It(s,e)&&(t[e]=s[e])}}return t},jt=t=>{let e=0;for(let s=0,i=t.length;s<i;s++)e+=t[s].length;const s=new Uint8Array(e);for(let e=0,i=0,n=t.length;e<n;e++){let n=t[e];s.set(n,i),i+=n.length}return s};let Nt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Nt=!1}const Dt=new Uint8Array(256);for(let t=0;t<256;t++)Dt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Dt[254]=Dt[254]=1;var Ut=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,s,i,n,r,o=t.length,a=0;for(n=0;n<o;n++)s=t.charCodeAt(n),55296==(64512&s)&&n+1<o&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),a+=s<128?1:s<2048?2:s<65536?3:4;for(e=new Uint8Array(a),r=0,n=0;r<a;n++)s=t.charCodeAt(n),55296==(64512&s)&&n+1<o&&(i=t.charCodeAt(n+1),56320==(64512&i)&&(s=65536+(s-55296<<10)+(i-56320),n++)),s<128?e[r++]=s:s<2048?(e[r++]=192|s>>>6,e[r++]=128|63&s):s<65536?(e[r++]=224|s>>>12,e[r++]=128|s>>>6&63,e[r++]=128|63&s):(e[r++]=240|s>>>18,e[r++]=128|s>>>12&63,e[r++]=128|s>>>6&63,e[r++]=128|63&s);return e},Lt=(t,e)=>{const s=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const r=new Array(2*s);for(n=0,i=0;i<s;){let e=t[i++];if(e<128){r[n++]=e;continue}let o=Dt[e];if(o>4)r[n++]=65533,i+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&i<s;)e=e<<6|63&t[i++],o--;o>1?r[n++]=65533:e<65536?r[n++]=e:(e-=65536,r[n++]=55296|e>>10&1023,r[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Nt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let s="";for(let i=0;i<e;i++)s+=String.fromCharCode(t[i]);return s})(r,n)},Pt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let s=e-1;for(;s>=0&&128==(192&t[s]);)s--;return s<0||0===s?e:s+Dt[t[s]]>e?s:e},Mt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ft=Object.prototype.toString,{Z_NO_FLUSH:Zt,Z_SYNC_FLUSH:Bt,Z_FULL_FLUSH:Ht,Z_FINISH:Wt,Z_OK:qt,Z_STREAM_END:Gt,Z_DEFAULT_COMPRESSION:Kt,Z_DEFAULT_STRATEGY:Vt,Z_DEFLATED:Jt}=Z;function Xt(t){this.options=Rt({level:Kt,method:Jt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Vt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mt,this.strm.avail_out=0;let s=St(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(s!==qt)throw new Error(F[s]);if(e.header&&((t,e)=>{t&&t.state&&(2!==t.state.wrap||(t.state.gzhead=e))})(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Ut(e.dictionary):"[object ArrayBuffer]"===Ft.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,s=((t,e)=>{let s=e.length;if(!t||!t.state)return et;const i=t.state,n=i.wrap;if(2===n||1===n&&42!==i.status||i.lookahead)return et;if(1===n&&(t.adler=L(t.adler,e,s,0)),i.wrap=0,s>=i.w_size){0===n&&(pt(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(s-i.w_size,s),0),e=t,s=i.w_size}const r=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=s,t.next_in=0,t.input=e,$t(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=mt(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,$t(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=r,i.wrap=n,Q})(this.strm,t),s!==qt)throw new Error(F[s]);this._dict_set=!0}}function Yt(t,e){const s=new Xt(e);if(s.push(t,!0),s.err)throw s.msg||F[s.err];return s.result}Xt.prototype.push=function(t,e){const s=this.strm,i=this.options.chunkSize;let n,r;if(this.ended)return!1;for(r=e===~~e?e:!0===e?Wt:Zt,"string"==typeof t?s.input=Ut(t):"[object ArrayBuffer]"===Ft.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;)if(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),(r===Bt||r===Ht)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(n=zt(s,r),n===Gt)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),n=Ct(this.strm),this.onEnd(n),this.ended=!0,n===qt;if(0!==s.avail_out){if(r>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(0===s.avail_in)break}else this.onData(s.output)}return!0},Xt.prototype.onData=function(t){this.chunks.push(t)},Xt.prototype.onEnd=function(t){t===qt&&(this.result=jt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Qt={Deflate:Xt,deflate:Yt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Yt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Yt(t,e)},constants:Z},te=function(t,e){let s,i,n,r,o,a,l,c,u,h,d,f,p,m,g,_,w,b,v,y,$,x,k,E;const O=t.state;s=t.next_in,k=t.input,i=s+(t.avail_in-5),n=t.next_out,E=t.output,r=n-(e-t.avail_out),o=n+(t.avail_out-257),a=O.dmax,l=O.wsize,c=O.whave,u=O.wnext,h=O.window,d=O.hold,f=O.bits,p=O.lencode,m=O.distcode,g=(1<<O.lenbits)-1,_=(1<<O.distbits)-1;t:do{f<15&&(d+=k[s++]<<f,f+=8,d+=k[s++]<<f,f+=8),w=p[d&g];e:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,0===b)E[n++]=65535&w;else{if(!(16&b)){if(0==(64&b)){w=p[(65535&w)+(d&(1<<b)-1)];continue e}if(32&b){O.mode=12;break t}t.msg="invalid literal/length code",O.mode=30;break t}v=65535&w,b&=15,b&&(f<b&&(d+=k[s++]<<f,f+=8),v+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=k[s++]<<f,f+=8,d+=k[s++]<<f,f+=8),w=m[d&_];s:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0==(64&b)){w=m[(65535&w)+(d&(1<<b)-1)];continue s}t.msg="invalid distance code",O.mode=30;break t}if(y=65535&w,b&=15,f<b&&(d+=k[s++]<<f,f+=8,f<b&&(d+=k[s++]<<f,f+=8)),y+=d&(1<<b)-1,y>a){t.msg="invalid distance too far back",O.mode=30;break t}if(d>>>=b,f-=b,b=n-r,y>b){if(b=y-b,b>c&&O.sane){t.msg="invalid distance too far back",O.mode=30;break t}if($=0,x=h,0===u){if($+=l-b,b<v){v-=b;do{E[n++]=h[$++]}while(--b);$=n-y,x=E}}else if(u<b){if($+=l+u-b,b-=u,b<v){v-=b;do{E[n++]=h[$++]}while(--b);if($=0,u<v){b=u,v-=b;do{E[n++]=h[$++]}while(--b);$=n-y,x=E}}}else if($+=u-b,b<v){v-=b;do{E[n++]=h[$++]}while(--b);$=n-y,x=E}for(;v>2;)E[n++]=x[$++],E[n++]=x[$++],E[n++]=x[$++],v-=3;v&&(E[n++]=x[$++],v>1&&(E[n++]=x[$++]))}else{$=n-y;do{E[n++]=E[$++],E[n++]=E[$++],E[n++]=E[$++],v-=3}while(v>2);v&&(E[n++]=E[$++],v>1&&(E[n++]=E[$++]))}break}}break}}while(s<i&&n<o);v=f>>3,s-=v,f-=v<<3,d&=(1<<f)-1,t.next_in=s,t.next_out=n,t.avail_in=s<i?i-s+5:5-(s-i),t.avail_out=n<o?o-n+257:257-(n-o),O.hold=d,O.bits=f};const ee=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),se=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ie=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ne=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var re=(t,e,s,i,n,r,o,a)=>{const l=a.bits;let c,u,h,d,f,p,m=0,g=0,_=0,w=0,b=0,v=0,y=0,$=0,x=0,k=0,E=null,O=0;const A=new Uint16Array(16),T=new Uint16Array(16);let S,z,C,I=null,R=0;for(m=0;m<=15;m++)A[m]=0;for(g=0;g<i;g++)A[e[s+g]]++;for(b=l,w=15;w>=1&&0===A[w];w--);if(b>w&&(b=w),0===w)return n[r++]=20971520,n[r++]=20971520,a.bits=1,0;for(_=1;_<w&&0===A[_];_++);for(b<_&&(b=_),$=1,m=1;m<=15;m++)if($<<=1,$-=A[m],$<0)return-1;if($>0&&(0===t||1!==w))return-1;for(T[1]=0,m=1;m<15;m++)T[m+1]=T[m]+A[m];for(g=0;g<i;g++)0!==e[s+g]&&(o[T[e[s+g]]++]=g);if(0===t?(E=I=o,p=19):1===t?(E=ee,O-=257,I=se,R-=257,p=256):(E=ie,I=ne,p=-1),k=0,g=0,m=_,f=r,v=b,y=0,h=-1,x=1<<b,d=x-1,1===t&&x>852||2===t&&x>592)return 1;for(;;){S=m-y,o[g]<p?(z=0,C=o[g]):o[g]>p?(z=I[R+o[g]],C=E[O+o[g]]):(z=96,C=0),c=1<<m-y,u=1<<v,_=u;do{u-=c,n[f+(k>>y)+u]=S<<24|z<<16|C|0}while(0!==u);for(c=1<<m-1;k&c;)c>>=1;if(0!==c?(k&=c-1,k+=c):k=0,g++,0==--A[m]){if(m===w)break;m=e[s+o[g]]}if(m>b&&(k&d)!==h){for(0===y&&(y=b),f+=_,v=m-y,$=1<<v;v+y<w&&($-=A[v+y],!($<=0));)v++,$<<=1;if(x+=1<<v,1===t&&x>852||2===t&&x>592)return 1;h=k&d,n[h]=b<<24|v<<16|f-r|0}}return 0!==k&&(n[f+k]=m-y<<24|64<<16|0),a.bits=b,0};const{Z_FINISH:oe,Z_BLOCK:ae,Z_TREES:le,Z_OK:ce,Z_STREAM_END:ue,Z_NEED_DICT:he,Z_STREAM_ERROR:de,Z_DATA_ERROR:fe,Z_MEM_ERROR:pe,Z_BUF_ERROR:me,Z_DEFLATED:ge}=Z,_e=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function we(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const be=t=>{if(!t||!t.state)return de;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,(t=>{if(!t||!t.state)return de;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,ce})(t)};let ve,ye,$e=!0;const xe=t=>{if($e){ve=new Int32Array(512),ye=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(re(1,t.lens,0,288,ve,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;re(2,t.lens,0,32,ye,0,t.work,{bits:5}),$e=!1}t.lencode=ve,t.lenbits=9,t.distcode=ye,t.distbits=5},ke=(t,e,s,i)=>{let n;const r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(e.subarray(s-r.wsize,s),0),r.wnext=0,r.whave=r.wsize):(n=r.wsize-r.wnext,n>i&&(n=i),r.window.set(e.subarray(s-i,s-i+n),r.wnext),(i-=n)?(r.window.set(e.subarray(s-i,s),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=n,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=n))),0};var Ee=be,Oe=(t,e)=>{if(!t)return de;const s=new we;t.state=s,s.window=null;const i=((t,e)=>{let s;if(!t||!t.state)return de;const i=t.state;return e<0?(s=0,e=-e):(s=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?de:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=s,i.wbits=e,be(t))})(t,e);return i!==ce&&(t.state=null),i},Ae=(t,e)=>{let s,i,n,r,o,a,l,c,u,h,d,f,p,m,g,_,w,b,v,y,$,x,k=0;const E=new Uint8Array(4);let O,A;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return de;s=t.state,12===s.mode&&(s.mode=13),o=t.next_out,n=t.output,l=t.avail_out,r=t.next_in,i=t.input,a=t.avail_in,c=s.hold,u=s.bits,h=a,d=l,x=ce;t:for(;;)switch(s.mode){case 1:if(0===s.wrap){s.mode=13;break}for(;u<16;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(2&s.wrap&&35615===c){s.check=0,E[0]=255&c,E[1]=c>>>8&255,s.check=M(s.check,E,2,0),c=0,u=0,s.mode=2;break}if(s.flags=0,s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",s.mode=30;break}if((15&c)!==ge){t.msg="unknown compression method",s.mode=30;break}if(c>>>=4,u-=4,$=8+(15&c),0===s.wbits)s.wbits=$;else if($>s.wbits){t.msg="invalid window size",s.mode=30;break}s.dmax=1<<s.wbits,t.adler=s.check=1,s.mode=512&c?10:12,c=0,u=0;break;case 2:for(;u<16;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(s.flags=c,(255&s.flags)!==ge){t.msg="unknown compression method",s.mode=30;break}if(57344&s.flags){t.msg="unknown header flags set",s.mode=30;break}s.head&&(s.head.text=c>>8&1),512&s.flags&&(E[0]=255&c,E[1]=c>>>8&255,s.check=M(s.check,E,2,0)),c=0,u=0,s.mode=3;case 3:for(;u<32;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}s.head&&(s.head.time=c),512&s.flags&&(E[0]=255&c,E[1]=c>>>8&255,E[2]=c>>>16&255,E[3]=c>>>24&255,s.check=M(s.check,E,4,0)),c=0,u=0,s.mode=4;case 4:for(;u<16;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}s.head&&(s.head.xflags=255&c,s.head.os=c>>8),512&s.flags&&(E[0]=255&c,E[1]=c>>>8&255,s.check=M(s.check,E,2,0)),c=0,u=0,s.mode=5;case 5:if(1024&s.flags){for(;u<16;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}s.length=c,s.head&&(s.head.extra_len=c),512&s.flags&&(E[0]=255&c,E[1]=c>>>8&255,s.check=M(s.check,E,2,0)),c=0,u=0}else s.head&&(s.head.extra=null);s.mode=6;case 6:if(1024&s.flags&&(f=s.length,f>a&&(f=a),f&&(s.head&&($=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(i.subarray(r,r+f),$)),512&s.flags&&(s.check=M(s.check,i,f,r)),a-=f,r+=f,s.length-=f),s.length))break t;s.length=0,s.mode=7;case 7:if(2048&s.flags){if(0===a)break t;f=0;do{$=i[r+f++],s.head&&$&&s.length<65536&&(s.head.name+=String.fromCharCode($))}while($&&f<a);if(512&s.flags&&(s.check=M(s.check,i,f,r)),a-=f,r+=f,$)break t}else s.head&&(s.head.name=null);s.length=0,s.mode=8;case 8:if(4096&s.flags){if(0===a)break t;f=0;do{$=i[r+f++],s.head&&$&&s.length<65536&&(s.head.comment+=String.fromCharCode($))}while($&&f<a);if(512&s.flags&&(s.check=M(s.check,i,f,r)),a-=f,r+=f,$)break t}else s.head&&(s.head.comment=null);s.mode=9;case 9:if(512&s.flags){for(;u<16;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(c!==(65535&s.check)){t.msg="header crc mismatch",s.mode=30;break}c=0,u=0}s.head&&(s.head.hcrc=s.flags>>9&1,s.head.done=!0),t.adler=s.check=0,s.mode=12;break;case 10:for(;u<32;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}t.adler=s.check=_e(c),c=0,u=0,s.mode=11;case 11:if(0===s.havedict)return t.next_out=o,t.avail_out=l,t.next_in=r,t.avail_in=a,s.hold=c,s.bits=u,he;t.adler=s.check=1,s.mode=12;case 12:if(e===ae||e===le)break t;case 13:if(s.last){c>>>=7&u,u-=7&u,s.mode=27;break}for(;u<3;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}switch(s.last=1&c,c>>>=1,u-=1,3&c){case 0:s.mode=14;break;case 1:if(xe(s),s.mode=20,e===le){c>>>=2,u-=2;break t}break;case 2:s.mode=17;break;case 3:t.msg="invalid block type",s.mode=30}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",s.mode=30;break}if(s.length=65535&c,c=0,u=0,s.mode=15,e===le)break t;case 15:s.mode=16;case 16:if(f=s.length,f){if(f>a&&(f=a),f>l&&(f=l),0===f)break t;n.set(i.subarray(r,r+f),o),a-=f,r+=f,l-=f,o+=f,s.length-=f;break}s.mode=12;break;case 17:for(;u<14;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(s.nlen=257+(31&c),c>>>=5,u-=5,s.ndist=1+(31&c),c>>>=5,u-=5,s.ncode=4+(15&c),c>>>=4,u-=4,s.nlen>286||s.ndist>30){t.msg="too many length or distance symbols",s.mode=30;break}s.have=0,s.mode=18;case 18:for(;s.have<s.ncode;){for(;u<3;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}s.lens[T[s.have++]]=7&c,c>>>=3,u-=3}for(;s.have<19;)s.lens[T[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,O={bits:s.lenbits},x=re(0,s.lens,0,19,s.lencode,0,s.work,O),s.lenbits=O.bits,x){t.msg="invalid code lengths set",s.mode=30;break}s.have=0,s.mode=19;case 19:for(;s.have<s.nlen+s.ndist;){for(;k=s.lencode[c&(1<<s.lenbits)-1],g=k>>>24,_=k>>>16&255,w=65535&k,!(g<=u);){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(w<16)c>>>=g,u-=g,s.lens[s.have++]=w;else{if(16===w){for(A=g+2;u<A;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(c>>>=g,u-=g,0===s.have){t.msg="invalid bit length repeat",s.mode=30;break}$=s.lens[s.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===w){for(A=g+3;u<A;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}c>>>=g,u-=g,$=0,f=3+(7&c),c>>>=3,u-=3}else{for(A=g+7;u<A;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}c>>>=g,u-=g,$=0,f=11+(127&c),c>>>=7,u-=7}if(s.have+f>s.nlen+s.ndist){t.msg="invalid bit length repeat",s.mode=30;break}for(;f--;)s.lens[s.have++]=$}}if(30===s.mode)break;if(0===s.lens[256]){t.msg="invalid code -- missing end-of-block",s.mode=30;break}if(s.lenbits=9,O={bits:s.lenbits},x=re(1,s.lens,0,s.nlen,s.lencode,0,s.work,O),s.lenbits=O.bits,x){t.msg="invalid literal/lengths set",s.mode=30;break}if(s.distbits=6,s.distcode=s.distdyn,O={bits:s.distbits},x=re(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,O),s.distbits=O.bits,x){t.msg="invalid distances set",s.mode=30;break}if(s.mode=20,e===le)break t;case 20:s.mode=21;case 21:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=r,t.avail_in=a,s.hold=c,s.bits=u,te(t,d),o=t.next_out,n=t.output,l=t.avail_out,r=t.next_in,i=t.input,a=t.avail_in,c=s.hold,u=s.bits,12===s.mode&&(s.back=-1);break}for(s.back=0;k=s.lencode[c&(1<<s.lenbits)-1],g=k>>>24,_=k>>>16&255,w=65535&k,!(g<=u);){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(_&&0==(240&_)){for(b=g,v=_,y=w;k=s.lencode[y+((c&(1<<b+v)-1)>>b)],g=k>>>24,_=k>>>16&255,w=65535&k,!(b+g<=u);){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,s.back+=b}if(c>>>=g,u-=g,s.back+=g,s.length=w,0===_){s.mode=26;break}if(32&_){s.back=-1,s.mode=12;break}if(64&_){t.msg="invalid literal/length code",s.mode=30;break}s.extra=15&_,s.mode=22;case 22:if(s.extra){for(A=s.extra;u<A;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}s.length+=c&(1<<s.extra)-1,c>>>=s.extra,u-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=23;case 23:for(;k=s.distcode[c&(1<<s.distbits)-1],g=k>>>24,_=k>>>16&255,w=65535&k,!(g<=u);){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(0==(240&_)){for(b=g,v=_,y=w;k=s.distcode[y+((c&(1<<b+v)-1)>>b)],g=k>>>24,_=k>>>16&255,w=65535&k,!(b+g<=u);){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}c>>>=b,u-=b,s.back+=b}if(c>>>=g,u-=g,s.back+=g,64&_){t.msg="invalid distance code",s.mode=30;break}s.offset=w,s.extra=15&_,s.mode=24;case 24:if(s.extra){for(A=s.extra;u<A;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}s.offset+=c&(1<<s.extra)-1,c>>>=s.extra,u-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){t.msg="invalid distance too far back",s.mode=30;break}s.mode=25;case 25:if(0===l)break t;if(f=d-l,s.offset>f){if(f=s.offset-f,f>s.whave&&s.sane){t.msg="invalid distance too far back",s.mode=30;break}f>s.wnext?(f-=s.wnext,p=s.wsize-f):p=s.wnext-f,f>s.length&&(f=s.length),m=s.window}else m=n,p=o-s.offset,f=s.length;f>l&&(f=l),l-=f,s.length-=f;do{n[o++]=m[p++]}while(--f);0===s.length&&(s.mode=21);break;case 26:if(0===l)break t;n[o++]=s.length,l--,s.mode=21;break;case 27:if(s.wrap){for(;u<32;){if(0===a)break t;a--,c|=i[r++]<<u,u+=8}if(d-=l,t.total_out+=d,s.total+=d,d&&(t.adler=s.check=s.flags?M(s.check,n,d,o-d):L(s.check,n,d,o-d)),d=l,(s.flags?c:_e(c))!==s.check){t.msg="incorrect data check",s.mode=30;break}c=0,u=0}s.mode=28;case 28:if(s.wrap&&s.flags){for(;u<32;){if(0===a)break t;a--,c+=i[r++]<<u,u+=8}if(c!==(4294967295&s.total)){t.msg="incorrect length check",s.mode=30;break}c=0,u=0}s.mode=29;case 29:x=ue;break t;case 30:x=fe;break t;case 31:return pe;default:return de}return t.next_out=o,t.avail_out=l,t.next_in=r,t.avail_in=a,s.hold=c,s.bits=u,(s.wsize||d!==t.avail_out&&s.mode<30&&(s.mode<27||e!==oe))&&ke(t,t.output,t.next_out,d-t.avail_out),h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,s.total+=d,s.wrap&&d&&(t.adler=s.check=s.flags?M(s.check,n,d,t.next_out-d):L(s.check,n,d,t.next_out-d)),t.data_type=s.bits+(s.last?64:0)+(12===s.mode?128:0)+(20===s.mode||15===s.mode?256:0),(0===h&&0===d||e===oe)&&x===ce&&(x=me),x},Te=t=>{if(!t||!t.state)return de;let e=t.state;return e.window&&(e.window=null),t.state=null,ce},Se=(t,e)=>{const s=e.length;let i,n,r;return t&&t.state?(i=t.state,0!==i.wrap&&11!==i.mode?de:11===i.mode&&(n=1,n=L(n,e,s,0),n!==i.check)?fe:(r=ke(t,e,s,s),r?(i.mode=31,pe):(i.havedict=1,ce))):de},ze=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Ce=Object.prototype.toString,{Z_NO_FLUSH:Ie,Z_FINISH:Re,Z_OK:je,Z_STREAM_END:Ne,Z_NEED_DICT:De,Z_STREAM_ERROR:Ue,Z_DATA_ERROR:Le,Z_MEM_ERROR:Pe}=Z;function Me(t){this.options=Rt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Mt,this.strm.avail_out=0;let s=Oe(this.strm,e.windowBits);if(s!==je)throw new Error(F[s]);if(this.header=new ze,((t,e)=>{if(!t||!t.state)return de;const s=t.state;0==(2&s.wrap)||(s.head=e,e.done=!1)})(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Ut(e.dictionary):"[object ArrayBuffer]"===Ce.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(s=Se(this.strm,e.dictionary),s!==je)))throw new Error(F[s])}function Fe(t,e){const s=new Me(e);if(s.push(t),s.err)throw s.msg||F[s.err];return s.result}Me.prototype.push=function(t,e){const s=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Re:Ie,"[object ArrayBuffer]"===Ce.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;;){for(0===s.avail_out&&(s.output=new Uint8Array(i),s.next_out=0,s.avail_out=i),r=Ae(s,o),r===De&&n&&(r=Se(s,n),r===je?r=Ae(s,o):r===Le&&(r=De));s.avail_in>0&&r===Ne&&s.state.wrap>0&&0!==t[s.next_in];)Ee(s),r=Ae(s,o);switch(r){case Ue:case Le:case De:case Pe:return this.onEnd(r),this.ended=!0,!1}if(a=s.avail_out,s.next_out&&(0===s.avail_out||r===Ne))if("string"===this.options.to){let t=Pt(s.output,s.next_out),e=s.next_out-t,n=Lt(s.output,t);s.next_out=e,s.avail_out=i-e,e&&s.output.set(s.output.subarray(t,t+e),0),this.onData(n)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(r!==je||0!==a){if(r===Ne)return r=Te(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===s.avail_in)break}}return!0},Me.prototype.onData=function(t){this.chunks.push(t)},Me.prototype.onEnd=function(t){t===je&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=jt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ze={Inflate:Me,inflate:Fe,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Fe(t,e)},ungzip:Fe,constants:Z};const{Deflate:Be,deflate:He,deflateRaw:We,gzip:qe}=Qt,{Inflate:Ge,inflate:Ke,inflateRaw:Ve,ungzip:Je}=Ze;var Xe={Deflate:Be,deflate:He,deflateRaw:We,gzip:qe,Inflate:Ge,inflate:Ke,inflateRaw:Ve,ungzip:Je,constants:Z};const Ye=(t,e=(t=>t))=>Array.from({length:t},((t,s)=>e(s))),Qe=t=>t.reduce(((t,e)=>t+Number(e)),0),ts=(t,...e)=>e.length?[...t].flatMap((t=>ts(...e).map((e=>[t,e])))):[...t],es="ABCDEFGHJKLMNOPQ",ss=(t=Date.now())=>{const e=2147483647;return(t%=e)<=0&&(t+=e),s=>((t=16807*t%e)-1)/e},is=t=>({on:()=>is(t),otherwise:()=>t}),ns=t=>({on:(e,s)=>e(t)?is(s(t)):ns(t),otherwise:e=>e(t)}),rs=Math.PI,os=rs/2,as=2*rs,ls={SOUTH:os,NORTH:-os,WEST:rs,EAST:0,NORTHWEST:1.5*-os,NORTHEAST:.5*-os,SOUTHWEST:1.5*os,SOUTHEAST:.5*os},cs={[ls.NORTH]:1,[ls.SOUTH]:1,[ls.WEST]:1,[ls.EAST]:1,[ls.NORTHWEST]:Math.SQRT2,[ls.NORTHEAST]:Math.SQRT2,[ls.SOUTHWEST]:Math.SQRT2,[ls.SOUTHEAST]:Math.SQRT2},us=([t,e],[s,i])=>Math.atan2(i-e,s-t),hs=(t,e)=>Math.sqrt(t**2+e**2),ds=(t,e,s)=>[t[0]+e*Math.cos(s),t[1]+e*Math.sin(s)],fs=t=>180*t/rs,ps=(t,e,s)=>ds(t,s,us(t,e)),ms=t=>t>rs?ms(t-as):t<=-rs?ms(t+as):t,gs=([t,e],[s,i])=>[(t+s)/2,(e+i)/2],_s=(t,e,s)=>Object.entries(t).reduce(((s,[i,n])=>e(s,n,i,t)),s),ws=(t,e)=>_s(t,((t,s,i,n)=>(t[i]=e(s,i,n),t)),{}),bs=(t,e)=>_s(t,((t,s,i,n)=>(t.push(e(s,i,n)),t)),[]),vs=(t,e,s)=>e*t+~~s,ys=(t,e)=>({row:~~(e/t),col:e%t}),$s=(t,e)=>Object.values(ls).reduce(((s,i)=>(s[i]=ks(t,e,i),s)),{}),xs=(t,e)=>Object.entries(cs).reduce(((s,[i,n])=>(1===n&&(s[i]=ks(t,e,i)),s)),{}),ks=(t,e,s)=>{const{row:i,col:n}=ys(t,e),r=ds([n,i],cs[s],s).map((t=>Math.round(t)));if(r[0]>=0&&r[0]<t&&r[1]>=0&&r[1]<t)return vs(t,r[1],r[0])},Es={DIAGONAL_POSITIVE:ls.SOUTHEAST,DIAGONAL_NEGATIVE:ls.SOUTHWEST,COLUMN:ls.SOUTH,ROW:ls.EAST},Os={CELL:[],DOMINO:[[ls.NORTH],[ls.WEST],[ls.SOUTH],[ls.EAST]],TWO_BY_TWO:[[ls.NORTH,ls.NORTHWEST,ls.WEST],[ls.WEST,ls.SOUTHWEST,ls.SOUTH],[ls.SOUTH,ls.SOUTHEAST,ls.EAST],[ls.EAST,ls.NORTHEAST,ls.NORTH]],PUZZLE_SIZE_BLOCK:[Object.values(ls)]},As={LINE_DRAW:"LINE_DRAW",BOX_DRAW:"BOX_DRAW"},Ts={CENTER_SIZE:"CENTER_SIZE",CORNER_SIZE:"CORNER_SIZE",PATH:"PATH",POINT:"POINT"},Ss=(t,e,s)=>{switch(t){case Os.DOMINO:case Os.PUZZLE_SIZE_BLOCK:case Os.TWO_BY_TWO:return((t,e,{positions:[s],point:i})=>{const n=[];for(const i of e){const e=[s];for(const n of i){const i=ks(t,s,n);void 0!==i&&e.push(i)}e.length===i.length+1&&n.push(e)}return n.length>1&&n.sort(((e,s)=>Qe(e.map((e=>{const{row:s,col:n}=ys(t,e),[r,o]=[n+.5-i.x,s+.5-i.y];return hs(r,o)})))-Qe(s.map((e=>{const{row:s,col:n}=ys(t,e),[r,o]=[n+.5-i.x,s+.5-i.y];return hs(r,o)}))))),n[0]})(e,t,s);case Es.DIAGONAL_POSITIVE:case Es.DIAGONAL_NEGATIVE:case Es.COLUMN:case Es.ROW:return((t,e,{positions:[s]})=>[s,...[e,ms(e+rs)].flatMap((e=>{const i=[];let n=s;for(;void 0!==(n=ks(t,n,e));)i.push(n);return i}))].sort(((t,e)=>t-e)))(e,t,s);case As.LINE_DRAW:return Cs(e,s);case As.BOX_DRAW:return zs(e,s);case Ts.CORNER_SIZE:case Ts.CENTER_SIZE:case Ts.CORNERS:return[0];default:return[s.positions[0]]}},zs=(t,{positions:[e,s]})=>{const i=[];if(null!=s){const{row:n,col:r}=ys(t,s),{row:o,col:a}=ys(t,e);for(let e=Math.min(n,o);e<=Math.max(n,o);++e)for(let s=Math.min(r,a);s<=Math.max(r,a);++s)i.push(vs(t,e,s))}return i},Cs=(t,{positions:[e,s]})=>{const i=[];if(null==s)return[e];{let{col:n,row:r}=ys(t,s),{col:o,row:a}=ys(t,e);const l=Math.abs(o-n),c=n<o?1:-1,u=-Math.abs(a-r),h=r<a?1:-1;let d=l+u;for(;i.push(vs(t,r,n)),n!==o||r!==a;){const t=2*d;t>=u&&(d+=u,n+=c),t<=l&&(d+=l,r+=h)}}return i},Is=/r(?<row>\d)c(?<col>\d)|(?<letter>[a-j])(?<num>[1-9])|(?<pos>\d\d?)/i,Rs=/^(?:r\dc\d|[a-j][1-9]|\d\d?)\s*(?:,\s*(?:r\dc\d|[a-j][1-9]|\d\d?)\s*)*$/i,js=t=>Rs.test(t),Ns=(t,e)=>e.split(",").flatMap((e=>{const s=e.split(/[:;-]/);if(s.length>1){const[i,n]=Ns(t,s.join(","));return e.includes("-")?Cs(t,{positions:[n,i]}):zs(t,{positions:[n,i]})}return((t,e=9)=>ns(t.match(Is)?.groups??{}).on((({row:t,col:e})=>t&&e),(({row:t,col:s})=>(t-1)*e+(s-1))).on((({letter:t,num:e})=>t&&e),(({letter:t,num:s})=>es.indexOf(t.toUpperCase())*e+(s-1))).on((({pos:t})=>t),(({pos:t})=>t)).otherwise((t=>{})))(e,t)})),Ds=(t,e,s=!1)=>null!=e?s?`r${1+~~(e/t)}c${1+e%t}`:`${es[~~(e/t)]}${1+e%t}`:"",Us=t=>16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24,Ls=(t,e)=>{const s=Ye(t.length,(t=>[]));for(const[i,n]of t.entries())s[i]=e[n].filter((e=>t.includes(e))).map((e=>t.indexOf(e)));const i=[];for(let e=3;e<2**t.length;++e)if(!(Us(e)<2)){for(let n=0;n<t.length;++n)e&1<<n&&(i[e]=e in i?i[e].filter((t=>t===n||s[n].includes(t))):[n,...s[n]]);i[e]&&i[e].length>Us(e)&&(i[e]=[])}const n=0===i.length?[]:i.reduce(((t,e)=>e.length>t.length?e:t)).map((e=>t[e]));return 0===n.length?[t[0]]:n},Ps=t=>{const e=JSON.stringify(t),s=new TextEncoder;return Xe.deflate(s.encode(e),{level:9})},Ms=t=>{const e=(new TextDecoder).decode(Xe.inflate(t));return JSON.parse(e)},Fs=t=>{let{name:e,setter:s,rules:i,constraints:n,givens:r,disableViolationChecking:o}=Gs(t);Object.entries(n).forEach((([t,e])=>{if(e.items){const t=[];e.items.forEach((e=>{if(e._creating)return;const{_editing:s,...i}=e;t.push(i)})),e.items=t}n={...n,[t]:e}}));let{row:a,column:l,...c}=n;r=r.join("").replace(/0+$/g,"");const u=JSON.stringify({name:e||void 0,setter:s||void 0,givens:r||void 0,rules:i||void 0,constraints:c,disableViolationChecking:o}).replace(/"([a-zA-Z_][a-zA-Z0-9_]*)":/g,"$1:").replace(/"((?:-)?\d+(?:\.\d+)?)"/g,"$1").replace(/givens:(\d+)/,'givens:"$1"'),h=new TextEncoder;return Xe.deflateRaw(h.encode(u),{level:9})},Zs=t=>{const e=Xe.inflateRaw(t),s=(new TextDecoder).decode(e);let i=n(s);return i={size:9,...i},i.constraints={row:{},column:{},...i.constraints},i.givens=i.givens??"",i.givens+=Ye(81-i.givens.length,(t=>"0")).join(""),i.givens=[...i.givens].map((t=>Number(t))),i},Bs={fromAttribute:t=>Object.fromEntries([...t.matchAll(/(?<name>\w+)(?:\((?<value>[^(]+)\))?/g)].map((({groups:t})=>{const{name:e,value:s}=t;return[e,s??!0]}))),toAttribute:t=>Object.entries(t).filter((([,t])=>t)).map((([t,e])=>"boolean"==typeof e?t:`${t}(${e})`)).join(" ")},Hs=(t,e)=>(Array.isArray(e)||(e=[e]),t?e.length>1?t.map((t=>Hs(t,e.slice(1)))).join(e[0]):t.join(e[0]):t),Ws=(t,e)=>(Array.isArray(e)||(e=[e]),t?e.length>1?t.split(e[0].trim()).map((t=>Ws(t.trim(),e.slice(1)))):t.split(e[0].trim()).map((t=>t.trim())):t),qs=()=>{const t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("safari")&&-1===t.indexOf("chrome")},Gs=t=>{if(null===t)return null;let e=ws(t,(t=>"object"==typeof t?Gs(t):t));return Array.isArray(t)?(e.length=t.length,Array.from(e)):e},Ks=(t,e)=>Array.isArray(e)||"object"!=typeof e?e??t:Object.fromEntries([...new Set([...Object.keys(t??{}),...Object.keys(e??{})])].map((s=>[s,Ks(t?.[s],e[s])]))),Vs=(t,e=0,s)=>{if(0===t.length)return[];const i=t.flatMap((t=>{const{row:e,col:i}=ys(s,t);return[[[i,e],[i+1,e]],[[i+1,e],[i+1,e+1]],[[i+1,e+1],[i,e+1]],[[i,e+1],[i,e]]]})),n=new Set(i.map((([t,e])=>`${[e,t]}`))),r=i.filter((t=>!n.has(`${t}`)));let o=[...r.shift()];const a=[];let[l,c]=o;for(;r.length;){const[t]=r.reduce((([t,e],[[s,i],n],r)=>{if(s===c[0]&&i==c[1]){const t=(a=us(o[o.length-2],c),l=us(c,n),ms(l-a));if(t>e)return[r,t]}var a,l;return[t,e]}),[-1,-Math.PI]);if(-1===t)throw`Cannot find edge that starts where this edge ends: ${o[o.length-2]}, ${c}`;c=r[t][1],o.push(c),r.splice(t,1),l[0]===c[0]&&l[1]===c[1]&&(a.push(o.slice(0,o.length-1)),r.length&&(o=[...r.shift()],l=o[0],c=o[1]))}const u=a.map((t=>t.reduce(((e,s,i)=>{const n=t[0===i?t.length-1:i-1],r=t[i<t.length-1?i+1:0];return us(n,s)!==us(s,r)&&e.push(s),e}),[])));return 0===e?u:u.map((t=>t.map(((s,i)=>{const n=t[0===i?t.length-1:i-1],r=t[i<t.length-1?i+1:0],o=[us(n,s),us(s,r)],[a,l]=s,{NORTH:c,EAST:u}=ls;return[a+(o.includes(c)?e:-e),l+(o.includes(u)?e:-e)]}))))},Js=(t,e)=>{const s=s=>s.composedPath().includes(t)||e(s);return document.body.querySelector("sudoku-lab").addEventListener("click",s,!0),t=>document.body.querySelector("sudoku-lab").removeEventListener("click",s,!0)};let Xs;const Ys=()=>{try{null==Xs&&(Xs=!1,new Worker("data:,",{get type(){Xs=!0}}).terminate())}finally{return Xs}},Qs=(t,e)=>t.filter((t=>e.includes(t))),ti=["Alt","Ctrl","Shift","Meta"],ei=t=>Object.fromEntries(ti.map((e=>[e.toLowerCase(),t.getModifierState(e)]))),si=t=>"TEXTAREA"===t.nodeName||"INPUT"===t.nodeName&&["text","number"].includes(t.type);class ii{constructor(t,e={rules:null}){this.puzzle=t,this.size=t.size,this._rules=e.rules}static enabled(t){return!0}static parseUrlParams(){return{}}static rules(t={size:9}){return`Normal Sudoku rules apply. Place the digits 1 through ${t.size} in each empty cell. Digits must not repeat within the same row, column, or box.`}get rules(){return this._rules??this.constructor.rules(this)}get peers(){return[]}get units(){return[]}clearCandidates(t,e,s,i){return e}eliminateCandidate(t,e,s,i,n){return!0}conflicts(t){return[]}peersFromUnits(){return this.units.reduce(((t,e)=>e.reduce(((t,s)=>(t[s]=[...t[s]??[],...e.filter((t=>t!==s))],t)),t)),Ye(this.size**2,(t=>[])))}}class ni extends ii{constructor(t,{items:e,rules:s}){super(t),this.arrows=e,this._rules=s}static urlParams(){return["arrow"]}static label(){return"Arrow"}static parseUrlParams(t,e){return{items:e.arrow.map((e=>({positions:Ns(t,e)})))}}static validatePositions(t,e){if(!(e.length>1&&e.length<9&&e.every(((s,i)=>0===i||s!==e[0]&&Object.values($s(t,s)).includes(e[i-1])))))return"Oops! Arrows need between 2 and 7 cells that are each adjacent to the next."}static rules(t={}){return"The digits along each arrow must sum to the digit in the circled cell. Digits may repeat along an arrow if permitted by other rules."}get rules(){return this._rules??ni.rules(this)}conflicts(t){return this.arrows.reduce(((e,s,i)=>{if(s.positions.length>1){const n=s.positions.length-1,r=s.positions.filter((e=>t[e])).length,o=t[s.positions[0]],a=Qe(s.positions.slice(1).map((e=>t[e])));if(o){const l=s.positions.every((e=>t[e]));(l&&o!==a||!l&&o<=a+n-r)&&e.push([i,s.positions])}else a+n-r>9&&e.push([i,s.positions])}return e}),[])}clearCandidates(t,e,s){for(const i of this.arrows)if(i.positions?.length>1){const n=i.positions[0],r=i.positions.slice(1);for(const s of r){const i=(t[n]||e[n].slice(-1)[0])-Qe(r.map((i=>i===s?0:t[i]||e[i][0]))),o=(t[n]||e[n][0])-Qe(r.map((i=>i===s?0:t[i]||e[i].slice(-1)[0])));e[s]=[...e[s]].filter((t=>~~t>=o&&~~t<=i)).join("")}const o=r.map(((t,e)=>[e,s[t].map((t=>r.indexOf(t))).filter((t=>-1!==t))])).sort((([t,e],[s,i])=>e-i)),a=r.map((s=>t[s]?[t[s]]:e[s])),l=[],c=[];o.forEach((([t,e])=>{let s=0,i=a[t].length-1;for(;e.some((e=>l[e]&&a[t][s]===l[e]));)s++;for(;e.some((e=>c[e]&&a[t][i]===c[e]));)i--;l[t]=a[t][s],c[t]=a[t][i]}));const u=Qe(l.map((t=>~~t))),h=Qe(c.map((t=>~~t)));e[n]=[...e[n]].filter((t=>~~t>=u&&~~t<=h)).join("")}return e}}class ri extends ii{constructor(t,{items:e,rules:s}){super(t),this.lines=e,this._rules=s}static urlParams(){return["between"]}static label(){return"Between Line"}static parseUrlParams(t,e){return{items:e.between.map((e=>({positions:Ns(t,e)})))}}static validatePositions(t,e){if(e.length>2){const s=e[e.length-1];if(e[0]!==s&&e.every(((i,n)=>0===n||i!==e[0]&&(n===e.length-1||i!==s)&&Object.values($s(t,i)).includes(e[n-1]))))return}return"Oops! Between lines need at least 3 cells that are each adjacent to the next."}static rules(t={}){return"Cells along lines between two filled circles must have values between those in the circles."}get rules(){return this._rules??ri.rules(this)}conflicts(t){return this.lines.reduce(((e,s,i)=>{const n=[s.positions[0],s.positions[s.positions.length-1]].map((e=>t[e])),r=s.positions.slice(1,-1).map((e=>t[e]));return n.every((t=>t))&&r.some((t=>t&&(t>=Math.max(...n)||t<=Math.min(...n))))&&e.push([i,s.positions]),e}),[])}clearCandidates(t,e,s){for(const{positions:s}of this.lines){if(s.length<3)return e;const i=s[0],[n]=s.slice(-1),r=s.slice(1,-1);t[i]&&!t[n]?e[n]=e[n].replace(new RegExp(`[${t[i]-1}${t[i]}${t[i]+1}]`,"g"),""):t[n]&&!t[i]&&(e[i]=e[i].replace(new RegExp(`[${t[n]-1}${t[n]}${t[n]+1}]`,"g"),""));const o=Math.min(t[i]||e[i][0],t[n]||e[n][0]),a=Math.max(t[i]||e[i].slice(-1)[0],t[n]||e[n].slice(-1)[0]);for(const t of r){for(;e[t][0]<=o;)e[t]=e[t].slice(1);for(;e[t].slice(-1)[0]>=a;)e[t]=e[t].slice(0,-1)}}return e}}class oi extends ii{constructor(t,{rules:e,rowCols:s="3x3",rows:i=~~s?.replace(/x\d+$/i,""),cols:n=~~s?.replace(/^\d+x/i,"")}){super(t,{rules:e}),this.rows=i,this.cols=n,this.boxes=Ye(this.size,(t=>[]));for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){const s=Math.trunc(t/i)*i+Math.trunc(e/n);this.boxes[s].push(t*this.size+e)}this._peers=this.peersFromUnits()}get units(){return this.boxes}get peers(){return this._peers}}class ai extends ii{constructor(t){super(t),this.columns=Ye(this.size,(t=>Ye(this.size,(e=>t+this.size*e)))),this._peers=this.peersFromUnits()}get units(){return this.columns}get peers(){return this._peers}}class li extends ii{constructor(t,{rules:e}){super(t),this._rules=e}static urlParams(){return["consecutive"]}static label(){return"Consecutive"}static rules(t={}){return"Orthogonally adjacent cells must not contain consecutive digits."}get rules(){return this._rules??li.rules(this)}conflicts(t){const e=this.puzzle.constraints.kropki?.items?.filter((({type:t})=>"consecutive"===t))??[];return[[0,Ye(this.size**2).filter((s=>{const i=xs(this.size,s);return Object.values(i).some((i=>t[s]&&t[i]&&!e.some((t=>t.positions.every((t=>[s,i].includes(t)))))&&[-1,1].includes(t[s]-t[i])))}))]]}clearCandidates(t,e){const s=this.puzzle.constraints.kropki?.items?.filter((({type:t})=>"consecutive"===t))??[];return e.forEach(((i,n)=>{for(const i of Object.values(xs(this.size,n)))0===t[i]||s.some((t=>t.positions.every((t=>[n,i].includes(t)))))||(e[n]=e[n].replace(t[i]-1,"").replace(t[i]+1,""))})),e}}class ci extends ii{constructor(t,{rules:e,orientation:s="both"}){super(t),this._rules=e,this.orientation=s,this.items=[],"both"!==s&&"\\"!==s||this.items.push({positions:Ye(this.size,(t=>t*this.size+t)),orientation:"positive"}),"both"!==s&&"/"!==s||this.items.push({positions:Ye(this.size,(t=>++t*this.size-t)),orientation:"negative"}),this._peers=this.peersFromUnits()}static urlParams(){return["diagonal"]}static label(){return"Diagonals"}static parseUrlParams(t,e){return{orientatiopn:e.diagonal.orientation??"both"}}static featureTemplate(t){return{orientation:{type:"choice",label:"",default:"both",choices:{both:{label:""},"/":{label:""},"\\":{label:""}}}}}get units(){return bs(this.items,(({positions:t})=>t))}get peers(){return this._peers}static rules(t={}){return"Digits along diagonals must not repeat."}get rules(){return this._rules??ci.rules(this)}}class ui extends ii{constructor(t,{rules:e}){super(t),this._rules=e,this.sets=Ye(this.size,(t=>[]));const{rowCols:s="3x3",rows:i=~~s?.replace(/x\d+$/i,""),cols:n=~~s?.replace(/^\d+x/i,"")}=t.constraints.box;for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++){const s=t%i*n+e%n;this.sets[s].push(t*this.size+e)}this._peers=this.peersFromUnits()}static urlParams(){return["disjoint"]}static label(){return"Disjoint Sets"}static enabled(t){return!!t.constraints.box}get units(){return this.sets}get peers(){return this._peers}static rules(t={}){return"Digits must not repeat at corresponding box positions."}get rules(){return this._rules??ui.rules(this)}}class hi extends ii{static enabled(){return!0}static gutter(){return!0}static layer(){return 1}renderSvg(){}}class di extends ii{constructor(t,{rules:e,items:s}){super(t),this.symbols=s,this._rules=e}static urlParams(){return["ineq"]}static label(){return"Inequality"}static parseUrlParams(t,e){return{items:e.ineq.map((e=>({positions:Ns(t,e)})))}}static validatePositions(t,e){if(2!==e.length||!Object.values(xs(t,e[0])).includes(e[1]))return"Oops! Inequality symbols are placed between 2 orthongonally adjacent cells."}static rules(t={}){return"Cells on either side of the inequality symbol must have values that abide by the indicated relationship."}get rules(){return this._rules??di.rules(this)}conflicts(t){return this.symbols.reduce(((e,s,i)=>(s.positions.every((e=>t[e]))&&t[s.positions[0]]<t[s.positions[1]]&&e.push([i,s.positions]),e)),[])}clearCandidates(t,e){for(const{positions:[s,i]}of this.symbols)if(void 0!==s&&void 0!==i){const[n,r]=[t[s],t[i]],[o,a]=[e[s],e[i]];e[s]=[...o].filter((t=>~~t>(r||~~a[0]))).join(""),e[i]=[...a].filter((t=>~~t<(n||~~o.slice(-1)[0]))).join("")}return e}}const fi=(t=Ye(9,(t=>t+1)))=>{const e=Ye(46,(t=>[]));for(let s=0;s<1<<t.length;++s){const i=[];for(let e=0;e<9;++e)s&1<<e&&i.push(t[e]);e[Qe(i)].push(i.join(""))}return e},pi=(t,e)=>{var s=[];if(1===t.length)return[t];for(var i=0;i<t.length;i++)for(var n=t[i],r=pi([...t.slice(0,i),...t.slice(i+1)]),o=0;o<r.length;o++){const t=[n,...r[o]];if(e){if(e(t))return t}else s.push(t)}return!e&&s},mi=(t,e=(t=>t))=>{const s=Ye(t.length,(t=>0)),i=[];for(let n=0;n<t.reduce(((t,e)=>t*e),1);++n){const n=e(s);n&&i.push(n);let r=0;for(;r<s.length&&++s[r]>=t[r];)s[r]=0,++r;if(s[s.length-1]===t[t.length-1])break}return i},gi=fi();class _i extends ii{constructor(t,{rules:e,items:s}){super(t),this.cages=s,this._peers=Ye(this.size**2,(t=>[])),this._rules=e;for(const t of s)for(const e of t.positions)this._peers[e]=[...new Set([...this._peers[e],...t.positions.filter((t=>t!==e))])]}static urlParams(){return["cage"]}static label(){return"Killer Cage"}static parseUrlParams(t,e){return{items:e.cage.map((e=>({sum:~~e.split(/,/)[0],positions:Ns(t,e.slice(e.indexOf(",")+1))})))}}static validatePositions(t,e){if(!(e.length>0&&e.length<=9&&e.length===new Set(e).size))return"Oops! Killercages need 1 to 9 cells."}static rules(t={}){return"The digits in a cage must sum to the number printed in its corner. Digits may not repeat within a cage."}get rules(){return this._rules??_i.rules(this)}get peers(){return this._peers}get units(){return this.cages.filter((t=>t.positions.length===this.size)).map((t=>t.positions))}conflicts(t){return this.cages.reduce(((e,s,i)=>{const n=Qe(s.positions.map((e=>t[e]))),r=s.positions.every((e=>t[e]));return s.sum&&(r&&s.sum!==n||!r&&s.sum<n)&&e.push([i,s.positions]),e}),[])}clearCandidates(t,e,s){for(const{sum:i,positions:n}of this.cages)if(i&&i<=45){const r=n.length,o=t.filter(((t,e)=>0!==t&&n.includes(e))),a=n.filter((e=>!!t[e])),l=e.filter(((t,e)=>n.includes(e)&&!a.includes(e))).map((t=>[...t||[]].filter((t=>!o.includes(~~t))))),c=gi[~~i]?.filter((t=>t.length===r&&o.every((e=>t.includes(e))))).map((t=>[...t].filter((t=>!o.includes(~~t))).join(""))).filter((t=>Qs([...new Set([...l.join("")])],[...t]).length===t.length)),u=c?.reduce(((t,e)=>Qs([...t],[...e])),[..."123456789"]).join("");if(c.length>1&&u.length){const t=n.map((t=>s[t])).reduce(((t,e)=>Qs(t,e)));for(const s of t)e[s]=e[s].replace(new RegExp(`[${u}]`,"g"),"")}const h=[...new Set([...c.join("")])].sort();for(const t of n)e[t]=[...Qs(h,[...e[t]])].join("")}return e}}class wi extends ii{constructor(t,{rules:e}){super(t),this._rules=e,this._peers=Ye(this.size**2,(t=>[]));for(let t=0;t<this.size**2;++t){const{row:e,col:s}=ys(this.size,t),i=[[e-1,s],[e+1,s],[e,s-1],[e,s+1],[e-1,s-1],[e+1,s-1],[e+1,s+1],[e-1,s+1]];this._peers[t]=i.filter((([t,e])=>t>=0&&t<this.size&&e>=0&&e<this.size)).map((t=>vs(this.size,...t)))}}static urlParams(){return["kings"]}static label(){return"King's Move"}static rules(t={}){return"Digits must not repeat in cells that are a chess king's move apart."}get rules(){return this._rules??wi.rules(this)}get peers(){return this._peers}}class bi extends ii{constructor(t,{rules:e}){super(t),this._rules=e,this._peers=Ye(this.size**2,(t=>[]));for(let t=0;t<this.size**2;++t){const e=t%this.size;for(const s of[7,11,17,19])t-s>=0&&(7===s&&this.size-e>2||11===s&&e>1||17===s&&this.size-e>1||19===s&&e>0)&&(this._peers[t].push(t-s),this._peers[t-s].push(t))}}static urlParams(){return["knights"]}static label(){return"Knight's Move"}static rules(t={}){return"Digits must not repeat in cells that are a chess knight's move apart."}get rules(){return this._rules??bi.rules(this)}get peers(){return this._peers}}class vi extends ii{constructor(t,{rules:e,negativeConstraint:s,items:i}){super(t),this.items=i,this.negativeConstraint=s,this._rules=e}static urlParams(){return["double","increment"]}static label(){return"Kropki Dot"}static parseUrlParams(t,e){return{items:[...e.double?e.double.map((e=>({type:"double",positions:Ns(t,e)}))):[],...e.increment?e.increment.map((e=>({type:"consecutive",positions:Ns(t,e)}))):[]]}}static validatePositions(t,e){if(2!==e.length||!Object.values(xs(t,e[0])).includes(e[1]))return"Oops! Kropki dots are placed between 2 orthongonally adjacent cells."}static rules(t={}){return`A black dot between cells indicates cell values with a 2:1 ratio. A white dot between cells indicates cells with consecutive values. ${t.negativeConstraint?"All":"Not all"} dots are shown.`}get rules(){return this._rules??vi.rules(this)}conflicts(t){const e=[];if(this.negativeConstraint)for(const[s,i]of t.entries()){if(!i)continue;const n=Object.values(xs(this.size,s));for(const r of n.filter((t=>null!=t))){const n=t[r];n&&(this.items?.some((({positions:t})=>t.length&&t.every((t=>[s,r].includes(t)))))||([-1,1].includes(i-n)||[2,.5].includes(i/n))&&e.push([-1,[s,r]]))}}if(this.items?.length)for(const[s,i]of this.items.entries()){const{type:n,positions:[r,o]}=i;t[r]&&t[o]&&("consecutive"===n&&![-1,1].includes(t[r]-t[o])||"consecutive"!==n&&![2,.5].includes(t[r]/t[o]))&&e.push([s,[r,o]])}return e}clearCandidates(t,e){for(const s of this.items??[])for(const[i,n]of s.positions.entries()){const r=t[n],o=s.positions[(i+1)%2],a=t[o];0===a||r?r||("consecutive"===s.type?e[n]=`${[...e[n]].filter((t=>[...e[o]].some((e=>[1,-1].includes(e-t))))).join("")}`:e[n]=`${[...e[n]].filter((t=>[...e[o]].some((e=>[2,.5].includes(e/t))))).join("")}`):"consecutive"===s.type?e[n]=`${[...e[n]].filter((t=>[1,-1].includes(a-t))).join("")}`:e[n]=`${[...e[n]].filter((t=>[2,.5].includes(a/t))).join("")}`}if(this.negativeConstraint)for(const[s]of e.entries()){const i=t[s],n=xs(this.size,s);for(const r of Object.values(n).flat())if(r&&!this.items?.find((t=>t.positions.includes(s)&&t.positions.includes(r)))){const n=t[r];0===n||i||(e[s]=`${[...e[s]].filter((t=>![.5,2].includes(~~t/~~n)&![1,-1].includes(~~t-~~n))).join("")}`)}}return e}}class yi extends ii{constructor(t,{items:e,rules:s}){super(t),this.diagonals=e,this._rules=s}static urlParams(){return["lilkiller"]}static label(){return"Little Killer"}static parseUrlParams(t,e){return{items:e.lilkiller.map((e=>({sum:e.split(/,/)[0],positions:Ns(t,e.substr(e.indexOf(",")+1))})))}}static validatePositions(t,e){if(![Es.DIAGONAL_NEGATIVE,Es.DIAGONAL_POSITIVE].some((s=>{const i=Ss(s,t,{positions:e});return i.length===e.length&&i.every((t=>e.includes(t)))})))return"Oops! Littlekiller needs diagonally adjacent cells that cover the grid from edge to edge."}static rules(t={}){return"Digits along diagonals pointed to by arrows outside the grid must sum to the number listed. Digits may repeat along the diagonal if otherwise allowed by normal Sudoku rules."}get rules(){return this._rules??yi.rules(this)}conflicts(t){return this.diagonals.reduce(((e,s,i)=>(s.positions.every((e=>t[e]))&&~~s.sum!==Qe(s.positions.map((e=>t[e])))&&e.push([i,s.positions]),e)),[])}}class $i extends ii{constructor(t,{rules:e,items:s}){super(t),this.rows=this.cols=Math.sqrt(this.size),this._rules=e,this.items=s}static enabled(t){return~~Math.sqrt(t.size)===Math.sqrt(t.size)}static validatePositions(t,e){if(9===e.length){const s=new Set(e.map((e=>ys(t,e).row))).size,i=new Set(e.map((e=>ys(t,e).col))).size;if(3===s&&3===i)return}return"Oops! Magic Squares need a 3 by 3 block of cells."}static label(){return"Magic Square"}static rules(t={}){return"The rows, columns, and diagonals in a magic square must all sum to the same totals."}get rules(){return this._rules??$i.rules(this)}conflicts(t,e){const s=[];for(const[e,i]of this.items.entries()){if(i.positions.some((e=>0===t[e])))continue;const{row:n,col:r}=ys(this.size,Math.min(...i.positions)),{byRow:o,byCol:a,byDiag:l}=i.positions.reduce((({byRow:t,byCol:e,byDiag:s},i)=>{const{row:o,col:a}=ys(this.size,i),l=o-n;t[l]=t[l]??[],t[l].push(i);const c=a-r;e[c]=e[c]??[],e[c].push(i);const u=l*this.rows+c,h=ns(u).on((t=>4==t),(t=>[!0,!0])).on((t=>[0,8].includes(t)),(t=>[!0,!1])).on((t=>[2,6].includes(t)),(t=>[!1,!0])).otherwise((t=>[!1,!1]));return h[0]&&(s[0]=s[0]??[],s[0].push(i)),h[1]&&(s[1]=s[1]??[],s[1].push(i)),{byRow:t,byCol:e,byDiag:s}}),{byRow:[],byCol:[],byDiag:[]});new Set([...o,...a,...l].flatMap((e=>Qe(e.map((e=>t[e])))))).size>1&&s.push([e,i.positions])}return s}clearCandidates(t,e){const s=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const t of this.items)if(9===t.positions?.length){const i=t.positions;i.sort(((t,e)=>t-e));for(let t=0;t<9;++t){const s=i[t];switch(t){case 4:e[s]=e[s].replace(/[^5]/g,"");break;case 1:case 3:case 5:case 7:e[s]=e[s].replace(/[^1379]/g,"");break;default:e[s]=e[s].replace(/[^2468]/g,"")}}for(let t=0;t<9;++t){if(4===t)continue;const n=i[t];for(const r of s.filter((e=>e.includes(t))))e[n]=[...e[n]].filter((s=>{const n=r.filter((e=>e!==t));return[...e[i[n[0]]]].some((t=>[...e[i[n[1]]]].some((e=>~~s+~~t+~~e==15))))})).join("")}}return e}}class xi extends ii{constructor(t,{rules:e,items:s}){super(t),this.items=s,this._rules=e}static urlParams(){return["max","min"]}static parseUrlParams(t,e){return{items:[...e.mins?e.min.map((e=>({type:"min",position:Ns(t,e)[0]}))):[],...e.max?e.max.map((e=>({type:"max",position:Ns(t,e)[0]}))):[]]}}static rules(t={}){return"Min/max cells must be greater than or less than their orthogonally adjacent neighbors as indicated by the symbols bordering the cell."}get rules(){return this._rules??xi.rules(this)}conflicts(t){const e=[];return this.items.forEach((({positions:s,type:i},n)=>{const r=s[0];if(t[r]){const s=Object.values(xs(this.size,r)).filter((e=>t[e]&&this.items.every((t=>t.positions[0]!==e||t.type!==i))&&("max"===i?t[e]>=t[r]:t[e]<=t[r])));s.length>0&&e.push([n,[r,...s]])}})),e}clearCandidates(t,e){for(const{positions:[t],type:s}of this.items)void 0!==t&&Object.values(xs(this.size,t)).forEach((i=>{if(i&&!this.items.filter((t=>t.type===s&&t.positions[0]===i)).length){const n="max"===s?t:i,r="max"===s?i:t;for(;e[n]&&e[n][0]<=e[r][0];)e[n]=e[n].slice(1);for(;e[r]&&e[n].slice(-1)<=e[r].slice(-1);)e[r]=e[r].slice(0,-1)}}));return e}}class ki extends ii{constructor(t,{rules:e,items:s}){super(t),this.items=s,this._rules=e}static urlParams(){return["odd","even"]}static label(){return"Odd/Even"}static parseUrlParams(t,e){return{items:[...e.odd?e.odd.map((e=>({type:"odd",positions:Ns(t,e)}))):[],...e.even?e.even.map((e=>({type:"even",positions:Ns(t,e)}))):[]]}}static validatePositions(t,e){if(1!==e.length)return"Oops! OddEvens are placed on a single cell."}static rules(t={}){return"Cells with a filled circle must be odd. Cells with a filled square must be even."}get rules(){return this._rules??ki.rules(this)}conflicts(t){return this.items.reduce(((e,{type:s,positions:i},n)=>(0===i.length||("even"===s?t[i[0]]&&t[i[0]]%2&&e.push([n,i]):!t[i[0]]||t[i[0]]%2||e.push([n,i])),e)),[])}clearCandidates(t,e){for(const{type:t,positions:[s]}of this.items)void 0!==s&&(e[s]=e[s].replace("even"===t?/[^2468]/g:/[2468]/g,""));return e}}class Ei extends ii{constructor(t,{items:e,rules:s}){super(t),this.lines=e,this._rules=s}static urlParams(){return["palindrome"]}static label(){return"Palindrome"}static parseUrlParams(t,e){return{items:e.palindrome.map((e=>({positions:Ns(t,e)})))}}static validatePositions(t,e){if(!(e.length>1&&e.every(((s,i)=>0===i||Object.values($s(t,s)).includes(e[i-1])))))return"Oops! Palindromes need at least two cells that are each adjacent to the next."}static rules(t={}){return"Digits along a palindrome line read the same forwards or backwards."}get rules(){return this._rules??Ei.rules(this)}conflicts(t){return this.lines.reduce(((e,s,i)=>{const n=s.positions.slice(0,Math.trunc(s.positions.length/2)).map(((t,e)=>[t,s.positions[s.positions.length-e-1]])).filter((([e,s])=>t[e]&&t[s]&&t[e]!==t[s]));return n&&e.push([i,n.flat()]),e}),[])}clearCandidates(t,e){for(const{positions:s}of this.lines){const i=s.length;if(i>1)for(const[n,r]of s.slice(0,Math.floor(i/2)).entries()){const o=s[i-n-1],[a,l]=[e[r],e[o]],[c,u]=[t[r],t[o]];e[r]=e[o]=Qs(c?[`${c}`]:[...a],u?[`${u}`]:[...l]).join("")}}return e}}class Oi extends ii{constructor(t,{rules:e,items:s}){super(t),this.quadruples=s;for(const t of s)t.values=[...new Set(t.values?.join("").replace(/\s/g,""))].slice(0,4).sort().map((t=>Number(t)));this._rules=e}static urlParams(){return["quad"]}static label(){return"Quadruple"}static parseUrlParams(t,e){return{items:e.quad.map((e=>({values:[...e.split(/,/)[0]].map((t=>~~t)),positions:Ns(t,e.slice(e.indexOf(",")+1))})))}}static validatePositions(t,e){if(4!==[...new Set(e)].length||!e.every((s=>{const i=Object.values($s(t,s));return e.filter((t=>t!=s)).every((t=>i.includes(t)))})))return"Oops! Quadruples need 4 adjacent cells."}static rules(t={}){return"Circled digits where four cells meet must be present as values in those four cells."}get rules(){return this._rules??Oi.rules(this)}conflicts(t){return this.quadruples.reduce(((e,s,i)=>{const n=s.positions,r=new Set(s.values),o=n.map((e=>t[e])).filter((t=>0!==t));if(o.forEach((t=>r.delete(t))),r.size>4-o.length){const r=n.filter((e=>0!==t[e]&&!s.values.includes(t[e])));e.push([i,0===r.length?n:r])}return e}),[])}clearCandidates(t,e,s){for(const{values:i,positions:[n,r,o,a]}of this.quadruples)if(i){if(4===i.length){const t=i.join("");e[n]=Qs([...e[n]],t).join(""),e[r]=Qs([...e[r]],t).join(""),e[o]=Qs([...e[o]],t).join(""),e[a]=Qs([...e[a]],t).join("")}else{const s=t.filter(((t,e)=>0!==t&&[n,r,o,a].includes(e))),l=i.filter((t=>!s.includes(t))).join("");s.length+l.length===4&&(e[n]=t[n]?e[n]:Qs([...e[n]],l).join(""),e[r]=t[r]?e[r]:Qs([...e[r]],l).join(""),e[o]=t[o]?e[o]:Qs([...e[o]],l).join(""),e[a]=t[a]?e[a]:Qs([...e[a]],l).join(""))}for(const[t,l]of s.entries()){const s=i.join("");[n,r,o,a].every((e=>l.includes(e)&&e!==t))&&(e[t]=e[t].replace(new RegExp(`[${s}]`,"g"),""))}}return e}}class Ai extends ii{constructor(t,{items:e}){if(super(t),this.items=[...e],e&&e.length===t.size-1&&e.every((e=>e.positions?.length===t.size))){const s={positions:Ye(t.size**2).filter((t=>!e.some((e=>e.positions?.includes(t)))))};s.positions.length===t.size&&this.items.push(s)}this._units=this.items.filter((({positions:e})=>e.length===t.size)).map((({positions:t})=>t)),this._peers=Ye(this.size**2,(t=>[]));for(const t of this.items)for(const e of t.positions)this._peers[e]=[...new Set([...this._peers[e],...t.positions.filter((t=>t!==e))])]}static label(){return"Region"}static validatePositions(t,e){if(!(e.length>0&&e.length<=9&&e.length===new Set(e).size))return"Oops! Regions need 1 to 9 cells."}static rules(t={}){return t.puzzle.constraints.box?"Digits may not repeat within any of the indicated regions.":`Place the digits 1 through ${t.size} in each empty cell. Digits must not repeat within the same row, column, or indicated region.`}get rules(){return this._rules??Ai.rules(this)}get units(){return this._units}get peers(){return this._peers}}class Ti extends ii{static label(){return"Renban Line"}constructor(t,{defaults:e,rules:s,items:i}){super(t,{defaults:e}),this.items=i,this._rules=s,this._peers=Ye(this.size**2,(t=>[]));for(const t of i)for(const e of t.positions)this._peers[e]=[...new Set([...this._peers[e],...t.positions.filter((t=>t!==e))])]}static validatePositions(t,e){if(!(e.length>1&&e.length<=9&&e.every(((s,i)=>0===i||s!==e[0]&&Object.values($s(t,s)).includes(e[i-1])))))return"Oops! Renban Lines need between 2 and 9 cells that are each adjacent to the next."}static rules(t={}){return"Digits along each renban line must be a set of consecutive digits in any order, and must not repeat."}get rules(){return this._rules??Ti.rules(this)}get peers(){return this._peers}get units(){return this.items.filter((t=>t.positions.length===this.size)).map((t=>t.positions))}conflicts(t){return this.items.reduce(((e,s,i)=>{const n=s.positions.filter(((e,i)=>t[e]&&s.positions.some(((i,n)=>t[i]&&Math.abs(t[e]-t[i])>s.positions.length-1))));return n.length&&e.push([i,n]),e}),[])}clearCandidates(t,e){for(const s of this.items){if(!s.positions)continue;const i=s.positions.length;for(const n of s.positions){const r=t[n]||e[n][0],o=t[n]||e[n].slice(-1)[0],a=new RegExp(`[${[..."123456789"].filter((t=>~~t<~~r-i-1||~~t>~~o+i-1)).join("")}]`,"g");for(const t of s.positions)t!==n&&(e[t]=e[t].replace(a,""))}}return e}}class Si extends ii{constructor(t){super(t),this.rows=Ye(this.size,(t=>Ye(this.size,(e=>t*this.size+e)))),this._peers=this.peersFromUnits()}get units(){return this.rows}get peers(){return this._peers}}class zi extends ii{constructor(t,{items:e,rules:s}){super(t),this.sums=e,this._rules=s}static urlParams(){return["sammy"]}static label(){return"Sandwich Sum"}static parseUrlParams(t,e){return{items:e.sammy.map((e=>({sum:e.split(/,/)[0],positions:Ns(t,e.substr(e.indexOf(",")+1))})))}}static validatePositions(t,e){if(![Es.COLUMN,Es.ROW].some((s=>{const i=Ss(s,t,{positions:[e[0]]});return i.length===e.length&&i.every((t=>e.includes(t)))})))return"Oops! Sandwich Sum needs an entire row or column of cells."}static rules(t={}){return"Clues outside the grid show the sum of digits sandwiched between the 1 and the 9 in that row or column."}get rules(){return this._rules??zi.rules(this)}conflicts(t){return this.sums.reduce(((e,s,i)=>{if(s.positions.length<9)return e;const n=s.positions.map((e=>t[e])),r=n.findIndex((t=>1===t)),o=n.findIndex((t=>9===t));if(-1!==r&&-1!==o){const t=Math.min(r,o),a=Math.max(r,o),l=n.slice(t+1,a);l.every((t=>0!==t))&&Qe(l)!==~~s.sum&&e.push([i,s.positions.slice(t+1,a)])}return e}),[])}}class Ci extends ii{constructor(t,{rules:e,items:s}){super(t),this._rules=e,this.thermos=s,this._peers=Ye(this.size**2,(t=>[]));for(const t of s)for(const e of t.positions)this._peers[e]=[...new Set([...this._peers[e],...t.positions.filter((t=>t!==e))])]}static urlParams(){return["thermo"]}static label(){return"Thermo"}static parseUrlParams(t,e){return{items:e.thermo.map((e=>({positions:Ns(t,e)})))}}static validatePositions(t,e){if(!(e.length>1&&e.length<=9&&e.every(((s,i)=>0===i||s!==e[0]&&Object.values($s(t,s)).includes(e[i-1])))))return"Oops! Thermos need between 2 and 9 cells that are each adjacent to the next."}static rules(t={}){return"Digits along each thermometer must increase starting from the bulb end."}get rules(){return this._rules??Ci.rules(this)}get peers(){return this._peers}get units(){return this.thermos.filter((t=>t.positions.length===this.size)).map((t=>t.positions))}conflicts(t){return this.thermos.reduce(((e,s,i)=>{const n=s.positions.filter(((e,i)=>t[e]&&s.positions.some(((s,n)=>t[s]&&i<n?t[e]>=t[s]:i>n&&t[e]<=t[s]))));return n.length&&e.push([i,n]),e}),[])}clearCandidates(t,e){for(const s of this.thermos){let i=1;for(const n of s.positions){const s=e[n][0];i=Math.max(i,t[n],s);let r=e[n],o=r?.[0]??i;for(;r&&o<i;)r=r.replace(o,""),o=r?.[0]??i;e[n]=r,++i}let n=9;for(const i of[...s.positions].reverse()){const s=~~e[i].slice(-1);n=Math.min(n,t[i]||9,s);let r=e[i],o=~~r?.slice(-1);for(;r&&o>n;)r=r.replace(o,""),o=~~r?.slice(-1);e[i]=r,--n}}return e}}class Ii extends ii{static label(){return"German Whispers"}constructor(t,{defaults:e,rules:s,items:i}){super(t,{defaults:e}),this.items=i,this._rules=s}static validatePositions(t,e){if(!(e.length>1&&e.length<=9&&e.every(((s,i)=>0===i||s!==e[0]&&Object.values($s(t,s)).includes(e[i-1])))))return"Oops! German Whispers need 2 or more cells that are each adjacent to the next."}static rules(t={}){return"Adjacent digits along each german whisper line must have a difference of at least 5."}get rules(){return this._rules??Ii.rules(this)}conflicts(t){return this.items.reduce(((e,s,i)=>{const n=s.positions.filter(((e,i)=>t[e]&&s.positions.some(((s,n)=>1===Math.abs(i-n)&&t[s]&&Math.abs(t[e]-t[s])<5))));return n.length&&e.push([i,n]),e}),[])}clearCandidates(t,e){for(const s of this.items)if(s.positions)for(const[i,n]of s.positions.entries()){const r=t[n]||e[n][0],o=t[n]||e[n].slice(-1)[0],a=new RegExp(`[${[..."123456789"].filter((t=>~~t<5+~~r&&~~t>~~o-5)).join("")}]`,"g");for(const[t,n]of s.positions.entries())1===Math.abs(t-i)&&(e[n]=e[n].replace(a,""))}return e}}class Ri extends ii{constructor(t,{rules:e,negativeConstraint:s,items:i}){super(t),this.items=i,this.negativeConstraint=s,this._rules=e}static urlParams(){return["x","v"]}static label(){return"XV"}static parseUrlParams(t,e){return{items:[...e.x?e.x.map((e=>({type:"x",positions:Ns(t,e)}))):[],...e.v?e.v.map((e=>({type:"v",positions:Ns(t,e)}))):[]]}}static validatePositions(t,e){if(2!==e.length||!Object.values(xs(t,e[0])).includes(e[1]))return"Oops! XVs are placed between 2 orthongonally adjacent cells."}static rules(t={}){return"Adjacent cells connected with an X must sum to 10. Adjacent cells connected with a V must sum to 5. "+(t.negativeConstraint?"Adjacent cells not connected with an X or V must not sum to 5 or 10.":"")}get rules(){return this._rules??Ri.rules(this)}conflicts(t){const e=[];if(this.negativeConstraint)for(const[s,i]of t.entries()){if(!i)continue;const n=Object.values(xs(this.size,s));for(const r of n.filter((t=>null!=t))){const n=t[r];n&&(this.items?.some((({positions:t})=>t.length&&t.includes(s)&&t.includes(r)))||[5,10].includes(i+n)&&e.push([-1,[s,r]]))}}return this.items?.reduce(((e,{type:s,positions:i},n)=>{const[r,o]=i;return t[r]&&t[o]&&t[o]+t[r]!==("v"===s?5:10)&&e.push([n,i]),e}),e),e}clearCandidates(t,e){if(this.items)for(const s of this.items)for(const[i,n]of s.positions.entries()){const r=t[n],o=s.positions[(i+1)%2],a=t[o];0===a||r?r||(e[n]=`${[...e[n]].filter((t=>[...e[o]].some((e=>t!==e&&~~e+~~t==("v"===s.type?5:10))))).join("")}`):e[n]=`${[...e[n]].filter((t=>~~t+~~a==("v"===s.type?5:10))).join("")}`}if(this.negativeConstraint)for(const[s]of e.entries()){const i=t[s],n=xs(this.size,s);for(const r of Object.values(n).flat())if(r&&!this.items?.find((t=>t.positions.includes(s)&&t.positions.includes(r)))){const n=t[r];0===n||i||(e[s]=`${[...e[s]].filter((t=>![5,10].includes(~~t+~~n))).join("")}`)}}return e}}const ji=new Map([["arrow",ni],["betweenline",ri],["box",oi],["column",ai],["consecutive",li],["diagonal",ci],["disjointgroups",ui],["gutter",hi],["inequality",di],["killercage",_i],["kingsmove",wi],["knightsmove",bi],["kropki",vi],["littlekiller",yi],["magicsquare",$i],["minmax",xi],["oddeven",ki],["palindrome",Ei],["quadruple",Oi],["region",Ai],["renban",Ti],["row",Si],["sandwichsum",zi],["thermo",Ci],["whispers",Ii],["xv",Ri]]),Ni={Boxes:"box",Diagonal:"diagonal","Disjoint Groups":"disjointgroups","King's Move":"kingsmove","Knight's Move":"knightsmove","Negative Kropki":"negativekropki","Negative XV":"negativexv",Nonconsecutive:"consecutive","Show Gutter":"gutter"},Di=t=>Object.fromEntries(Object.keys(t.constraints).map((t=>[t,ji.get(t)])).filter((([,t])=>!!t))),Ui=t=>Object.fromEntries(Object.entries(t.constraints).map((([t,e])=>[ji.get(t),t,e])).filter((([t])=>!!t)).map((([e,s,i])=>[s,new e(t,i)]))),Li=(t,e,s)=>_s(Ui(t),e,s),Pi=(t,e)=>ws(Ui(t),e),Mi=(t,e)=>{Li(t,((t,s,i,n)=>{e(s,i,n)}))},Fi="SINGLE_CHAIN_COLORED",Zi="SINGLE_CHAIN_UNCOLORED",Bi="CONTRADICTION",Hi="SOLUTION_COMPLETE",Wi="SOLUTION_INCOMPLETE",qi="FISH_WINGS",Gi=Ye(9),Ki=Ye(512,(t=>Qe(Gi.map((e=>t&1<<e?1:0))))),Vi=t=>{const e=[];for(let s=0;s<9;++s)t&1<<s&&e.push(s);return e},Ji="NAKED_TUPLE",Xi="HIDDEN_TUPLE",Yi="SOLUTION_COMPLETE",Qi="SOLUTION_INCOMPLETE",tn="SOLUTION_STEP",en="SOLUTION_CANCELLED",sn="CANDIDATE_ELIMINATION",nn=(t,e,s,i,n,r,o=300,a,l=(t=>!0))=>{let c=0,u=5;const h=h=>{let f=!0;if(c++<o){const o=((t,e,s,i,n,r)=>{const o=[],a=[],l=Ye(9),c=t=>Qe([...t].map((t=>1<<t-1))),u=t=>l.reduce(((e,s)=>e+(t&1<<s?s+1:"")),""),h=Ye(511,(t=>Qe(Ye(10,(e=>t&1<<e?1:0)))));return 0===(r=>{const a=[],l=Ye(t.size**2,(t=>[]));for(const[t,e]of Object.entries(i))for(const[s,i]of e.entries())for(const e of i)l[e].push({unitType:t,unitIndex:s,unit:i});for(const[t,i]of s.entries())if(0===e[t])if(1!==i.length)for(const{unitType:c,unit:u,unitIndex:h}of l[t]){const l=[...i].find((e=>u.every((i=>i===t||!s[i].includes(e))))),d=[...new Set(n[t].filter((t=>0===e[t]&&s[t].includes(l))))],f=a.find((e=>e.positions[0]===t));if(f)"HIDDEN_TUPLE"===f.type&&(f.units=[...f.units,[c,h]].reduce(((t,[e,s],i,n)=>(t[`${e} ${s}`]=[e,s],i===n.length-1?Object.values(t):t)),{}));else if(l){const e={type:"HIDDEN_TUPLE",n:1,positions:[t],impactedPositions:d,units:[[c,h]],values:[l]};if(a.push(e),!r(e))return a;o.push(t)}}else{const c=[...new Set(n[t].filter((t=>0===e[t]&&s[t].includes(i))))],u=a.find((e=>e.positions[0]===t));if(u){"NAKED_TUPLE"===u.type&&(u.units=[...u.units,[unitType,unitIndex]].reduce(((t,[e,s],i,n)=>(t[`${e} ${s}`]=[e,s],i===n.length-1?Object.values(t):t)),{}));continue}const h={type:"NAKED_TUPLE",n:1,positions:[t],impactedPositions:c,units:l[t].map((({unitType:t,unitIndex:e})=>[t,e])),values:[i]};if(a.push(h),!r(h))return a;o.push(t)}return a})((t=>(o.push(t.positions[0]),a.push(t),r(t)))).length&&(t=>{const n=[],r=s.map(c),a=Ye(512,(t=>{return e=t,l.reduce(((t,s)=>t+(e&1<<s?s:"")),"");var e})).sort(((t,e)=>t.length-e.length)).filter((t=>t.length>1&&t.length<5));for(const c of a){const a=Object.fromEntries(bs(i,((t,e)=>[e,l.map((t=>l.map((t=>!1))))])));for(const[l,d]of Object.entries(i))t:for(const[i,f]of d.entries()){const d=c.length;let p=0,m=0,g=9;for(const t of c){const e=f[t];if(1===s[e].length||o.includes(e)||a[l][i][t])continue t}for(const[t,e]of f.entries()){const i=c.includes(t);1===s[e].length&&--g,i?p|=r[e]:m|=r[e]}if(h[p]===d&&d<g){const r=[...u(p)],o=[...c].map((t=>f[t])),h=f.filter((t=>!o.includes(t)&&r.some((e=>s[t].includes(e)))&&0===e[t])),m=n.find((t=>t.values.every((t=>r.includes(t)))&&t.positions.every((t=>o.includes(t)))));if(m){m.n===d&&"NAKED_TUPLE"===m.type&&(m.units=[...m.units,[l,i]].reduce(((t,[e,s],i,n)=>(t[`${e} ${s}`]=[e,s],i===n.length-1?Object.values(t):t)),{}));continue}if(0===h.length)continue;const g={type:"NAKED_TUPLE",n:d,positions:o,impactedPositions:h,units:[[l,i]],values:r};if(n.push(g),!t(g))return n;for(const t of c)a[l][i][t]=!0;continue}const _=p&~m;let w=!0;for(const t of c)w=w&&_&r[f[t]];const b=[...u(_)],v=[...c].map((t=>f[t])).sort(),y=f.filter((t=>!v.includes(t)&&b.some((e=>s[t].includes(e)))&&0===e[t]));if(w&&b.length===d&&d<g){const e=n.find((t=>t.values.every((t=>b.includes(t)))&&t.positions.every((t=>v.includes(t)))));if(e){e.n===d&&"HIDDEN_TUPLE"===e.type&&(e.units=[...e.units,[l,i]].reduce(((t,[e,s],i,n)=>(t[`${e} ${s}`]=[e,s],i===n.length-1?Object.values(t):t)),{}));continue}const s={type:"HIDDEN_TUPLE",n:d,positions:v,impactedPositions:y,units:[[l,i]],values:b};if(n.push(s),!t(s))return n;for(const t of c)a[l][i][t]=!0}}}})((t=>(a.push(t),r(t)))),a})(n,t,e,i,s,(i=>(f=f&&l({type:"SOLUTION_STEP",gridIteration:a,proceed:f,data:[i]}),f=f&&an(i,t,e,s,n,l),f=f&&an({type:"CANDIDATE_ELIMINATION"},t,e,s,n,l),!1)));if(o.length&&f)return void d();if(((t,e,s,i,n,r,o=(t=>!0))=>{const a=[],l=Object.keys(i).sort(),c=r.filter((t=>1===t.n)).reduce(((t,e)=>(t[e.values[0]-1].push(e),t)),Ye(9,(t=>[]))),u=Ye(2**t.size,(t=>{return e=t,Ye(10).reduce(((t,s)=>t+(e&1<<s?s:"")),"");var e})).sort(((t,e)=>t.length-e.length)).filter((t=>t.length>0&&t.length<8)),h=Ye(t.size**2,(t=>({}))),d=Object.fromEntries(l.map((t=>[t,Gi.map((t=>Gi.map((t=>0))))])));for(const t of l)for(const[n,r]of i[t].entries())for(const[i,o]of r.entries()){if(e[o])continue;h[o][t]=n;const r=s[o];for(const e of r)d[t][n][e-1]|=1<<i}const f=Ye(9,(t=>[])),p=u.reduce(((t,e)=>(t[e.length]=t[e.length]??[],t[e.length].push(e),t)),[]);for(const t of p)if(t)for(const r of l)for(const u of t){const t=Gi.map((t=>[]));for(const e of[...u])for(const s of Gi)Ki[d[r][e][s]]&&t[s].push(e);for(const p of Gi)if(t[p].length&&t[p].length===u.length){const m=[];for(const t of[...u]){const e=i[r][t],s=Vi(d[r][t][p]);e.forEach(((t,e)=>{s.includes(e)&&m.push(t)}))}if(c[p].some((t=>m.some((e=>e===t.positions[0]))))||f[p].some((t=>t.every((t=>m.includes(t))))))continue;let g=!1;for(const n of l.filter((t=>t!==r))){const l=new Set;let c=!0;for(const t of m)n in h[t]?l.add(h[t][n]):c=!1;if(c&&l.size>0&&l.size<=u.length){const c=i[n].filter(((t,e)=>l.has(e))).flatMap((t=>t.filter((t=>!m.includes(t)&&s[t].includes(p+1)&&0===e[t]))));if(c.length&&m.length>1){g=!0;const e=t[p].map((t=>[r,~~t])),s=[...l].map((t=>[n,~~t])),i={type:"FISH_WINGS",n:u.length,positions:m,impactedPositions:c,units:e,impactedUnits:s,values:[p+1]};if(a.push(i),f[p].push(m),!o(i))return a}}}if(!g&&1===u.length){let e=[];for(const[t,i]of n.entries())s[t].includes(p+1)&&!m.includes(t)&&m.every((t=>i.includes(t)))&&e.push(t);if(e.length){const s=t[p].map((t=>[r,~~t])),i={type:"FISH_WINGS",n:u.length,positions:m,impactedPositions:e,units:s,values:[p+1]};if(a.push(i),f[p].push(m),!o(i))return a}}}}return a})(n,t,e,i,s,o,(i=>(f=f&&l({type:"SOLUTION_STEP",gridIteration:a,proceed:f,data:[i]}),f=f&&an(i,t,e,s,n,l),f=f&&an({type:"CANDIDATE_ELIMINATION"},t,e,s,n,l),!1))).length&&f)return void d();if(0===r){const o=((t,e,s,i,n,r)=>{const o=t.size,a=[],l=Ye(t.size**2,(t=>[]));for(const[t,e]of Object.entries(i))for(const[s,i]of e.entries())for(const e of i)l[e].push({unitType:t,unitIndex:s,unit:i});const c=Object.keys(i),u=Ye(o,(t=>Object.fromEntries(c.map((t=>[t,Ye(o,(t=>[]))]))))),h=Ye(o,(t=>[]));for(const[t,i]of s.entries())if(0===e[t])for(let e=0;e<o;++e)i.includes(e+1)&&(h[e].push(t),l[t].forEach((({unitType:s,unitIndex:i})=>{u[e][s][i].push(t)})));const d=Ye(o,(t=>c.flatMap((e=>u[t][e].reduce(((t,s,i)=>(2==s.length&&t.push({type:e,index:i,positions:s}),t)),[])))));for(const[t,e]of d.entries()){const s=Ye(o**2,(t=>[]));for(const t of e){const[e,i]=t.positions;s[e].push(t),s[i].push(t)}const i=new Map,l=[];for(const[e,c]of s.entries()){const c=Ye(o**2,(t=>-1)),u=(e,n=0,r=-1,o=[])=>{l[e]=!0;const a=s[e];if(a.length&&(o.push([r,e,n,t]),!i.has(e)))if(-1!==c[e])-1!==r&&c[e]!==n&&i.set(e,o.slice());else if(a.length){c[e]=n;const t=(n+1)%2;for(const s of a)s.positions[0]===e&&s.positions[1]!==r?o=u(s.positions[1],t,e,o):s.positions[1]===e&&s.positions[0]!==r&&(o=u(s.positions[0],t,e,o))}return o};if(!l[e]){const s=u(e);for(const e of h[t]){const i=n[e].map((t=>({peer:t,color:c[t]}))).reduce(((t,{peer:e,color:s})=>(-1!==s&&t[s].push(e),t)),Ye(2,(t=>[]))),o=c[e];if(-1===o){if(i[0].length&&i[1].length){const n={type:"SINGLE_CHAIN_UNCOLORED",positions:[...i[0],...i[1]],values:[t+1],impactedPositions:[e],chain:[s]};if(a.push(n),!r(n))return a}}else if(i[o].length){const i=s.reduce(((t,[,s,i])=>(i===o&&s!==e&&t.push(s),t)),[]),n={type:"SINGLE_CHAIN_COLORED",positions:[e],values:[t+1],impactedPositions:i,chain:[s]};if(a.push(n),!r(n))return a}}}}}return a})(n,t,e,i,s,(i=>(f=f&&l({type:"SOLUTION_STEP",gridIteration:a,proceed:f,data:[i]}),f=f&&an(i,t,e,s,n,l),f=f&&an({type:"CANDIDATE_ELIMINATION"},t,e,s,n,l),!1)));if(o.length&&f)return void d();const c=((t,e,s,i,n,r,o,a,l,c)=>{if(r>0)return[];const u=Ye(t.size**2).sort(((t,e)=>s[t].length-s[e].length));let h;for(let d=u.findIndex((t=>s[t].length>1));d<s.length;++d){const f=u[d];if(-1!==d&&s[f].length<=9){for(const u of s[f]){const d=[...s],p=[...e];d[f]=u;const m=[];l(p,d,n,i,t,r+1,o,a,(t=>{const e=Object.entries(i).reduce(((t,[e,s])=>s.reduce(((t,s,i)=>(t.push([e,i,s.reduce(((t,e)=>(0!==p[e]&&(t[p[e]-1]=!0),[...d[e]].forEach((e=>t[e-1]=!0)),t)),Ye(9,(t=>!1))).map(((t,e)=>t?"":e+1)).join("")]),t)),t)),[]);return m.push(t),!!([Wi,Hi].includes(t.type)||!e.some((([t,e,s])=>s.length))&&t.proceed)||(h={type:"CONTRADICTION",n:1,positions:[f],impactedPositions:d.map(((t,e)=>0===t.length?e:void 0)).filter((t=>t)),values:[u],steps:m.map((t=>t.data[0])),impactedUnits:e.filter((([t,e,s])=>s.length))},c(h),!1)}))}if(h)return[h]}}return[]})(n,t,e,i,s,r,u,a,nn,(i=>(f=f&&an(i,t,e,s,n,l),f=f&&l({type:"SOLUTION_STEP",gridIteration:a,data:[i]}),f=f&&an({type:"CANDIDATE_ELIMINATION"},t,e,s,n,l),!1)));if(c.length&&f)return u=2,void d();if(t.includes(0)&&u++<10&&f)return void d()}}l({type:t.includes(0)?"SOLUTION_INCOMPLETE":"SOLUTION_COMPLETE",gridIteration:a})},d=0===r?t=>setTimeout(h):h;d()},rn=(t,e,s,i,n,r,o)=>(s[e]=~~t,i[e]=t,n[e].forEach((e=>i[e]=i[e].replace(t,""))),i),on=(t,e,s,i,n,r,o)=>{if(!t||0===e.length)return i;for(const s of e)i[s]=i[s].replace(new RegExp(`[${t}]`,"g"),"");return i},an=(t,e,s,i,n,r)=>{switch(t.type){case"SUDOKU_SOLVER_STEP":for(const[n,r]of Object.entries(t.assignments))for(const t of r)rn(n,t,e,s,i);for(const[e,i]of Object.entries(t.eliminations))on(`${e}`,i,0,s);break;case"NAKED_TUPLE":case"HIDDEN_TUPLE":if(1===t.n)rn(t.values[0],t.positions[0],e,s,i);else{const e="123456789".replace(new RegExp(`[${t.values.join("")}]`,"g"),"");on(e,t.positions,0,s),on(t.values.join(""),t.impactedPositions,0,s)}break;case"FISH_WINGS":case"SINGLE_CHAIN_UNCOLORED":case"SINGLE_CHAIN_COLORED":on(t.values.join(""),t.impactedPositions,0,s);break;case"CONTRADICTION":on(t.values.join(""),t.positions,0,s);break;case"CANDIDATE_ELIMINATION":if(!((t,e,s,i,n)=>{let r;const o={};do{r=e.join(""),Mi(i,((i,n)=>{if(!["row","box","column","ellipse","rectangle","path","text"].includes(n)){const r=[...e];i.clearCandidates(t,e,s),o[n]=o[n]||{},r.forEach(((t,s)=>{const i=t.replace(new RegExp(`[${e[s]}]`,"g"),"");if(i)for(let t of[...i])o[n][t]=o[n][t]||[],o[n][t].push(s)}))}}))}while(e.every((t=>t.length))&&r!==e.join(""));for(const t in o)0===Object.keys(o[t]).length&&delete o[t];return!(Object.keys(o).length>0)||n({type:"SOLUTION_STEP",gridIteration:0,proceed:!0,data:[{type:"CANDIDATE_ELIMINATION",constraints:o}]})})(e,s,i,n,r))return!1}return s.every((t=>t.length>0))};class ln{constructor(t,e){this.value=t,this.left=e??this,this.right=this.up=this.down=this}insertBelow(t){this.up=t,this.down=t.down,t.down.up=t.down=this}removeVertically(){this.up.down=this.down,this.down.up=this.up,this.column.rowCount--,this.column.rowWeight-=this.weight}reinsertVertically(){this.up.down=this.down.up=this,this.column.rowWeight+=this.weight,this.column.rowCount++}removeHorizontally(){this.left.right=this.right,this.right.left=this.left}reinsertHorizontally(){this.left.right=this.right.left=this}eachPeerDown(t){for(let e=this.down;e!==this;e=e.down)t(e)}eachPeerLeft(t){for(let e=this.left;e!==this;e=e.left)t(e)}eachPeerRight(t){for(let e=this.right;e!==this;e=e.right)t(e)}mapPeersRight(t){const e=[];for(let s=this.right;s!==this;s=s.right)e.push(t(s,e.length,this));return e}}class cn extends ln{constructor(t,e){super(t?.replace(/:multiple\(\d+\)$/,""),e),this.rowCount=0,this.rowWeight=0,this.matchCount=~~t?.replace(/^.*:multiple\((\d+)\)$/,"$1")||1}removeHorizontally(){super.removeHorizontally(),this.header.columnCount--}reinsertHorizontally(){super.reinsertHorizontally(),this.header.columnCount++}}const un=t=>{const e=t.column??t;if(0==--e.matchCount){e.removeHorizontally();for(let t=e.down;t!==e;t=t.down){e.header.rowCount--;for(let e=t.right;e!==t;e=e.right)e.removeVertically()}}},hn=t=>{const e=t.column??t;if(0==e.matchCount++){for(let t=e.up;t!==e;t=t.up){for(let e=t.left;e!==t;e=e.left)e.reinsertVertically();e.header.rowCount++}e.reinsertHorizontally()}},dn=({row:t,col:e})=>`${t},${e}`,fn=[Ye(9,(t=>9*t+t)),Ye(9,(t=>9*++t-t))],pn=(t,e)=>({following:[{row:t,col:e+1},{row:t+1,col:e}],preceding:[{row:t,col:e-1},{row:t-1,col:e}]}),mn=t=>{const e=[...new Set([...t.join("")].sort())],s=[];for(let i=1;i<1<<e.length;++i){let n=[];for(let t=0;t<e.length;++t)i&1<<t&&n.push(e[t]);n.length<=t[0].length&&t.every((t=>n.some((e=>!t.includes(e)))))&&s.push([i,n])}return s.filter((([t,e])=>!s.find((([s,i])=>e!==i&&(t&s)===s)))).map((([t,e])=>e)).sort(((t,e)=>t-e))},gn=fi(),_n=(t,e)=>{const s=[...new Set([...e.join("")])].join(""),i=new Set;for(let e=2;e<=t;e++)mi(Ye(e,(t=>s.length)),(t=>{let n="";for(let i=0;i<e;++i)n+=s[t[i]];i.add([...n].sort().join(""))}));const n=[...i].filter((t=>e.every((e=>{let s=t;for(const t of e)s=s.replace(t,"");return s.length>0}))));return n.filter((t=>n.every((e=>e===t||-1===t.indexOf(e)))))},wn=t=>{const e=~~(t/9),s=t%9;return[e,s,3*~~(e/3)+~~(s/3)]};class bn extends Error{}const vn=({items:t},e)=>{const s=t.map((t=>0)),i=t.map((t=>[])),n=t.map((t=>new Set(t.positions.map((t=>{const[e,s]=wn(t);return`${"ABCDEFGHJ"[e]}${s+1}`}))))),r=n.map((t=>t.size)),o=t.map((t=>Ls(t.positions,e).length)),a=Ye(9,(t=>t+1)).join(""),l=t.map((t=>""));return{add:e=>{const c=e[0]+e[1],u=~~e[2];return t.map(((t,e)=>{if(n[e].has(c)){l[e]+=u,s[e]+=u;const n=s[e];i[e].push(c);const h=i[e].length;if(h===r[e])return t.sum===n;const d=a.replace(new RegExp(`[${l[e]}]`,"g"),""),f=new Set([...l[e]]),p=Math.max(0,o[e]-f.size),m=Qe([...d.slice(0,p)]),g=Math.max(0,r[e]-h-p),_=m+g,w=9*g+(p?Qe([...d.slice(-p)]):0);return t.sum>=n+_&&t.sum<=n+w}return!0})).every((t=>t))},remove:e=>{const r=e[0]+e[1],o=~~e[2];t.forEach(((t,e)=>{n[e].has(r)&&(l[e]=l[e].replace(o,""),i[e].pop(),s[e]-=o)}))}}};var yn=Object.freeze({__proto__:null,rows:"ABCDEFGHJ",rowColString:dn,position:()=>(t,e,s)=>[`pos${9*t+e}`],row:()=>(t,e,s)=>[`row${"ABCDEFGHJ"[t]},${s+1}`],column:()=>(t,e,s)=>[`col${e+1},${s+1}`],box:()=>(t,e,s)=>[`box${3*~~(t/3)+~~(e/3)+1},${s+1}`],classic:()=>(t,e,s)=>{return[...(i=t,n=e,[`pos${9*i+n}`]),...((t,e,s)=>[`row${"ABCDEFGHJ"[t]},${s+1}`])(t,0,s),...((t,e,s)=>[`col${e+1},${s+1}`])(0,e,s),...((t,e,s)=>[`box${3*~~(t/3)+~~(e/3)+1},${s+1}`])(t,e,s)];var i,n},diagonal:({orientation:t})=>(e,s,i)=>{const n=9*e+s,r=[];return t&&"both"!==t&&"\\"!==t||fn[0].includes(n)&&r.push(`diag0,${i+1}`),t&&"both"!==t&&"/"!==t||fn[1].includes(n)&&r.push(`diag1,${i+1}`),r},kingsmove:()=>(t,e,s)=>[`kings${t},${e},${t+1},${e+1},${s}`,`kings${t-1},${e-1},${t},${e},${s}`,`kings${t},${e},${t+1},${e-1},${s}`,`kings${t-1},${e+1},${t},${e},${s}`].filter((t=>!t.match(/-|9|10/))).map((t=>`optional:${t}`)),knightsmove:()=>(t,e,s)=>[`knights${t},${e},${t+2},${e+1},${s}`,`knights${t},${e},${t+2},${e-1},${s}`,`knights${t},${e},${t+1},${e+2},${s}`,`knights${t},${e},${t+1},${e-2},${s}`,`knights${t-2},${e+1},${t},${e},${s}`,`knights${t-2},${e-1},${t},${e},${s}`,`knights${t-1},${e+2},${t},${e},${s}`,`knights${t-1},${e-2},${t},${e},${s}`].filter((t=>!t.match(/-|9|10/))).map((t=>`optional:${t}`)),disjointgroups:()=>(t,e,s)=>`disjoint${t%3*3+e%3},${s+1}`,consecutive:(t,e,s)=>(t,e,i)=>{const n=9*t+e,r=((t,e)=>{const s=pn(t,e);return{following:s.following.map(dn).filter((t=>!t.match(/9|10/))),preceding:s.preceding.map(dn).filter((t=>!t.match(/-/)))}})(t,e),o=s.kropki?.items?.filter((t=>"consecutive"===t.type))??[];return[...r.following.filter((t=>!o.some((e=>{const[s,i]=t.split(",");return e.positions.every((t=>[n,9*s+~~i].includes(t)))})))).flatMap((s=>[`consecutive${t},${e},${s},${i+1},${i+2}`,`consecutive${t},${e},${s},${i},${i+1}`])),...r.preceding.filter((t=>!o.some((e=>{const[s,i]=t.split(",");return e.positions.every((t=>[n,9*s+~~i].includes(t)))})))).flatMap((s=>[`consecutive${s},${t},${e},${i+1},${i+2}`,`consecutive${s},${t},${e},${i},${i+1}`]))].map((t=>`optional:${t}`))},oddeven:({items:t})=>(e,s,i)=>{const n=t.filter((({type:t})=>"even"!==t)),r=t.filter((({type:t})=>"even"===t)),o=9*e+s;return(!n.map((t=>t.positions[0])).includes(o)||i%2!=1)&&(!r.map((t=>t.positions[0])).includes(o)||i%2!=0)&&[]},inequality:({items:t})=>(e,s,i)=>{const n=9*e+s;return t.flatMap((({positions:t})=>t[0]===n?0!==i&&Ye(9-i,(e=>`gt${n},${t[1]},${i},${i+e}`)):t[1]===n?8!==i&&Ye(i,(e=>`gt${t[0]},${n},${i-(e+1)},${i}`)):[])).map((t=>!1===t?t:`optional:${t}`))},kropki:({negativeConstraint:t,items:e})=>(s,i,n)=>{const r=9*s+i,o=e?.flatMap((({type:t,positions:e},s)=>{if(e.includes(r)){if("consecutive"!==t)return![5,7,9].includes(n+1)&&Ye(9).filter((t=>![2,.5].includes((t+1)/(n+1)))).map((t=>r===e[0]?[n,t]:[t,n])).map((t=>`kropki2x${s},${t}`));if("consecutive"===t)return Ye(9).filter((t=>![1,-1].includes(t-n))).map((t=>r===e[0]?[n,t]:[t,n])).map((t=>`kropki1+${s},${t}`))}return[]}))??[];let a=[];if(t){const t=e?.filter((t=>"consecutive"!==t.type)),o=e?.filter((t=>"consecutive"===t.type)),l=pn(s,i);for(const s of Object.values(l).flat().filter((t=>t.row>=0&&t.row<9&&t.col>=0&&t.col<9))){const i=9*s.row+s.col;Ye(9).forEach((s=>{s+1===1&&n+1===2||s+1===2&&n+1===1?e?.find((({positions:t})=>2===t.length&&t.every((t=>[r,i].includes(t)))))||a.push(i<r?`kropki!,${i},${r},${s+1},${n+1}`:`kropki!,${r},${i},${n+1},${s+1}`):(![5,7,9].includes(n+1)&&[2,.5].includes((s+1)/(n+1))&&(t?.find((({positions:t})=>2===t.length&&t.every((t=>[r,i].includes(t)))))||a.push(i<r?`kropki!,${i},${r},${s+1},${n+1}`:`kropki!,${r},${i},${n+1},${s+1}`)),[1,-1].includes(s-n)&&(o?.find((({positions:t})=>2===t.length&&t.every((t=>[r,i].includes(t)))))||a.push(i<r?`kropki!,${i},${r},${s+1},${n+1}`:`kropki!,${r},${i},${n+1},${s+1}`)))}))}}return[...o,...a].map((t=>!1!==t&&`optional:${t}`))},killercage:({items:t})=>{const e=t.map((t=>{if(!t.sum)return[];const e=gn[t.sum].filter((e=>e.length===t.positions.length));var s;return{requiredDigits:[...(s=e.map((t=>new Set(t))),new Set([...s?.[0]??[]].filter((t=>s.slice(1).every((e=>e.has(t)))))))].join(""),missingDigits:"123456789".replace(new RegExp(`[${[...new Set([...e.join("")])]}]`,"g"),""),combos:mn(e)}}));return(s,i,n)=>{const r=9*s+i,o=3*~~(s/3)+~~(i/3);return t.flatMap(((t,a)=>{if(!t.sum)return t.positions?.includes(r)?[`cage${a},${n+1}`]:[];const l=new Set,c=new Set,u=new Set;for(const e of t.positions){const[t,s,i]=wn(e);l.add(t),c.add(s),u.add(i)}if(t.positions.includes(r))return e[a].missingDigits.includes(n+1)?[!1]:[`cage${a},${n+1}`,...e[a].combos.flatMap((t=>t.includes(`${n+1}`)?[`cage${a},${t.join("")}:multiple(${t.length-1})`]:[]))];if(e[a].requiredDigits.includes(`${n+1}`)){if(l.has(s))return[`cage${a},row,${n+1}:multiple(${l.size-1})`];if(c.has(i))return[`cage${a},col,${n+1}:multiple(${c.size-1})`];if(u.has(o))return[`cage${a},box,${n+1}:multiple(${u.size-1})`]}return[]})).map((t=>!1===t?t:`optional:${t}`))}},arrow:({items:t},e)=>{const s=Ye(t.length,(t=>new Set)),i=t.map(((t,i)=>{const n=t.positions.length-1,r=t.positions.slice(1),o=1===n?1:Ls(r,e).length,a=[Qe([..."123456789"].slice(0,o))+(n-o),9],l={},c=[];mi(Ye(n,(t=>9)),(t=>{const e=n+Qe(t);e>=a[0]&&e<=a[1]&&new Set(t).size>=o&&(l[e]=l[e]??new Set,l[e].add(t.map((t=>t+1)).sort().join("")))}));for(let r in l){const o="123456789".replace(new RegExp("["+[...new Set(l[r])].join("")+"]","g"),""),u=[..._n(n,[...l[r]]).reduce(((r,o)=>(s[i].has(o)||(o.length<n&&(o+=Ye(n-o.length,(t=>"_")).join("")),pi([...o],(s=>{let i=!0;for(let n=1;n<=s.length;++n)for(let r=n+1;r<=s.length;++r)"_"!==s[n-1]&&s[n-1]===s[r-1]&&e[t.positions[n]].includes(t.positions[r])&&(i=!1);i&&r.add(s.join(""))}))),r)),new Set)];u.filter((t=>{const e=t.replace(/_/g,""),s=Qe([...e]),i=n-e.length;return s+9*i<a[0]||s+i>a[1]})).forEach((t=>s[i].add(t))),c[~~r]={disallowedTerms:o,permutedDigits:u.filter((t=>!s[i].has(t)))}}return c})),n=i.map((t=>[...new Set([...t.map((({disallowedTerms:t})=>t)).join("")])].filter((e=>t.every((({disallowedTerms:t})=>-1!==t.indexOf(e))))).join("")));return(e,r,o)=>{const a=9*e+r,l=[];return t.forEach(((t,e)=>{const r=`arrow${e}`;if(a===t.positions[0]){const s=i[e][o+1];if(!s)return void l.push(!1);if(s.disallowedTerms)for(const i of s.disallowedTerms)if(-1===n[e].indexOf(i))for(let e=0;e<t.positions.length-1;++e)l.push(`${r},${o+1},${e},${i}`);for(const t of s.permutedDigits)l.push(`${r},${o+1},${t}:multiple(${t.replace(/_/g,"").length})`)}else if(t.positions.includes(a)){if(-1!==n[e].indexOf(o+1))return void l.push(!1);for(const i of s[e])i[t.positions.indexOf(a)-1]==o+1&&l.push(`${r},${i}:multiple(${i.replace(/_/g,"").length-1})`);for(const[s,n]of i[e].entries()){if(!n)continue;const e=t.positions.indexOf(a)-1;if(-1===n.disallowedTerms.indexOf(o+1))for(const t of n.permutedDigits)~~t[e]===o+1&&l.push(`${r},${s},${t}:multiple(${t.replace(/_/g,"").length})`);else l.push(`${r},${s},${e},${o+1}`)}}})),l.map((t=>!1===t?t:`optional:${t}`))}},thermo:({items:t})=>(e,s,i)=>{const n=9*e+s;return t.flatMap((({positions:t},e)=>{const s=`thermo${e}`;if(t.includes(n)){const e=t.indexOf(n);return t.flatMap(((n,r)=>i<e||i+(t.length-e)>9?[!1]:e<r?Ye(i+(r-e),(t=>`${s},${e},${i+1},${r},${1+t}`)):e>r?Ye(9-i,(t=>`${s},${r},${i+1+t},${e},${i+1}`)):[]))}return[]})).map((t=>!1!==t&&`optional:${t}`))},xv:({negativeConstraint:t,items:e})=>(s,i,n)=>{const r=9*s+i,o=e?e.filter((({type:t})=>"v"!==t)):[],a=e?e.filter((({type:t})=>"v"===t)):[],l=[...a.flatMap(((t,e)=>t.positions.includes(r)?n>3?[!1]:Ye(4).filter((t=>t+n!==3)).map((e=>r==t.positions[0]?[n,e]:[e,n])).map((t=>`xvv${e},${t}`)):[])),...o.flatMap(((t,e)=>t.positions.includes(r)?Ye(9).filter((t=>t+n!==8)).map((e=>r==t.positions[0]?[n,e]:[e,n])).map((t=>`xvx${e},${t}`)):[]))];let c=[];if(t){const t=pn(s,i);for(const e of t.preceding.filter((t=>t.row>=0&&t.row<9&&t.col>=0&&t.col<9))){const t=9*e.row+e.col;a?.find((({positions:e})=>2===e.length&&e.every((e=>[r,t].includes(e)))))||(c=[...c,...Ye(4).filter((t=>t+n===3)).map((e=>`xv!v,${t},${r},${e},${n}`))]),o?.find((({positions:e})=>2===e.length&&e.every((e=>[r,t].includes(e)))))||(c=[...c,...Ye(9).filter((t=>t+n===8)).map((e=>`xv!x,${t},${r},${e},${n}`))])}for(const e of t.following.filter((t=>t.row>=0&&t.row<9&&t.col>=0&&t.col<9))){const t=9*e.row+e.col;a?.find((({positions:e})=>2===e.length&&e.every((e=>[r,t].includes(e)))))||(c=[...c,...Ye(4).filter((t=>t+n===3)).map((e=>`xv!v,${r},${t},${n},${e}`))]),o?.find((({positions:e})=>2===e.length&&e.every((e=>[r,t].includes(e)))))||(c=[...c,...Ye(9).filter((t=>t+n===8)).map((e=>`xv!x,${r},${t},${n},${e}`))])}}return[...l,...c].map((t=>!!t&&`optional:${t}`))},betweenline:({items:t})=>(e,s,i)=>{const n=9*e+s;return t.flatMap(((t,e)=>{const s=[];if(t.positions.length<3)return[];const r=[t.positions[0],t.positions[t.positions.length-1]],o=t.positions.slice(1,-1);if(r.includes(n)){const t=n===r[0];s.push(`between${e},${i+1},${i+1}`),s.push(`between${e},${t?`${i+1},${i}`:`${i},${i+1}`}`),s.push(`between${e},${t?`${i+1},${i+2}`:`${i+2},${i+1}`}`);for(let n=0;n<9;++n){if(i===n||1===Math.abs(i-n))continue;const r=Math.max(i,n),a=Math.min(i,n);for(let l=0;l<9;++l)if(l>=r||l<=a){const r=t?i+1:n+1,a=t?n+1:i+1;for(let t=0;t<o.length;++t)s.push(`between${e},${t},${r},${l+1},${a}:multiple(2)`)}}}else if(o.includes(n)){0!==i&&8!==i||s.push(!1);const t=o.indexOf(n);for(let n=0;n<9;++n)for(let r=0;r<9;++r)if(n!==r&&1!==Math.abs(n-r)){const o=Math.max(n,r),a=Math.min(n,r);(i>=o||i<=a)&&s.push(`between${e},${t},${n+1},${i+1},${r+1}:multiple(2)`)}}return s})).map((t=>!1===t?t:`optional:${t}`))},InvalidPuzzleError:bn,palindrome:({items:t},e)=>(s,i,n)=>{const r=9*s+i;return t.flatMap(((t,s)=>{if(t.positions.includes(r)){const i=t.positions.indexOf(r),o=t.positions.length-1-i;if(i===o)return[];if(e[r].includes(t.positions[o]))throw new bn(`Palindrome positions ${r} and ${t.positions[o]} are peers and cannot have the same value.`);const a=i<o?i:o,l=i<o?t=>t:([t,e])=>[e,t];return Ye(9).filter((t=>t!==n)).map((t=>`palindrome${s},${a},${l([n+1,t+1]).join(",")}`))}return[]})).map((t=>!1!==t&&`optional:${t}`))},region:({items:t})=>(e,s,i)=>{const n=9*e+s;if(t&&8===t.length&&t.every((t=>9===t.positions?.length))){const e={positions:Ye(81).filter((e=>!t.some((t=>t.positions?.includes(e)))))};9===e.positions.length&&(t=[...t,e])}return t.flatMap(((t,e)=>t.positions.includes(n)?[`${t.positions.length<9?"optional:":""}region${e},${i+1}`]:[]))},minmax:({items:t})=>(e,s,i)=>{const n=[];for(const[r,o]of t.entries()){const a=pn(e,s),l={preceding:a.preceding.map((({row:t,col:e})=>9*t+e)),following:a.following.map((({row:t,col:e})=>9*t+e))},c=9*e+s;if(c===o.positions[0])if("max"===o.type){0===i&&n.push(!1);for(let e=i+1;e<9;++e){for(const s of l.preceding)t.every((t=>!(o.type===t.type&&s===t.positions[0])))&&n.push(`minmax${r},${s},${c},${e+1},${i+1}`);for(const s of l.following)t.every((t=>!(o.type===t.type&&s===t.positions[0])))&&n.push(`minmax${r},${c},${s},${i+1},${e+1}`)}}else{8===i&&n.push(!1);for(let e=i;e>0;--e){for(const s of l.preceding)t.every((t=>!(o.type===t.type&&s===t.positions[0])))&&n.push(`minmax${r},${s},${c},${e},${i+1}`);for(const s of l.following)t.every((t=>!(o.type===t.type&&s===t.positions[0])))&&n.push(`minmax${r},${c},${s},${i+1},${e}`)}}if(Object.values(l).flat().includes(o.positions[0])){const e=c<o.positions[0]?[c,o.positions[0]]:[o.positions[0],c];if(t.every((t=>!(o.type===t.type&&c===t.positions[0]))))if("max"===o.type){8===i&&n.push(!1),8===i&&n.push(!1);for(let t=i;t>0;--t){const s=c<o.positions[0]?[`${i+1},${t}`]:[`${t},${i+1}`];n.push(`minmax${r},${e.join(",")},${s.join(",")}`)}}else{0===i&&n.push(!1);for(let t=i+1;t<9;++t){const s=c<o.positions[0]?[`${i+1}`,`${t+1}`]:[`${t+1}`,`${i+1}`];n.push(`minmax${r},${e.join(",")},${s.join(",")}`)}}}}return n.map((t=>t?`optional:${t}`:t))},sandwichsum:({items:t})=>(e,s,i)=>{const n=9*e+s,r=[];return t.forEach((({positions:t,sum:e},s)=>{if(null==e)return;const o=t.indexOf(n);if(-1!==o){const n=gn[e].filter((t=>!t.match(/[19]/))).sort(((t,e)=>t-e));if(0===n.length)return void r.push(!1);const a=n[0].length,l=n[n.length-1].length,c=Math.ceil(t.length-a+2);if(o>c&&o<t.length-1-c&&(0===i||8===i))return void r.push(!1);if(0===i||8===i){const t=0===i?"9":"1";for(let c=0;c<9;++c)if(c<a||c>l)o-(c+1)>=0&&r.push(`sammy${s},${o-(c+1)},${o},${t},${i+1}`),o+c+1<9&&r.push(`sammy${s},${o},${o+c+1},${i+1},${t}`);else if(1===c){const t=[..."2345678".replace(e,"")];if(o-(c+1)>=0)for(const e of t)r.push(`sammy${s},${o-(c+1)},${o},${e}:multiple(2)`);if(o+c+1<9)for(const e of t)r.push(`sammy${s},${o},${o+c+1},${e}:multiple(2)`)}else{const t=n.filter((t=>t.length===c)),e=[..."2345678"].filter((e=>!t.some((t=>t.includes(e)))));for(const t of e)o-(c+1)>=0&&r.push(`sammy${s},${o-(c+1)},${o},${t}:multiple(2)`),o+c+1<9&&r.push(`sammy${s},${o},${o+c+1},${t}:multiple(2)`);mn(t).forEach((t=>{o-(c+1)>=0&&r.push(`sammy${s},${o-(c+1)},${o},${t.join("")}:multiple(${t.length+1})`),o+c+1<9&&r.push(`sammy${s},${o},${o+c+1},${t.join("")}:multiple(${t.length+1})`)}))}}else for(let t=a;t<=l;++t)if(1===t){const t=[..."2345678".replace(e,"")];if(t.includes(`${i+1}`)&&o-1>=0&&o+1<9)for(const e of t)r.push(`sammy${s},${o-1},${o+1},${e}:multiple(2)`)}else{const e=n.filter((e=>e.length===t));if(e.some((t=>t.includes(`${i+1}`))))mn(e).forEach((e=>{if(e.includes(`${i+1}`))for(let i=Math.max(0,o-(t+1)),n=i+t+1;n<9;++i,++n)o>i&&o<n&&r.push(`sammy${s},${i},${n},${e.join("")}:multiple(${e.length+1})`)}));else for(let e=Math.max(0,o-(t+1)),n=e+t+1;n<9;++e,++n)o>e&&o<n&&r.push(`sammy${s},${e},${n},${i+1}:multiple(2)`)}}})),r.map((t=>!1!==t&&`optional:${t}`))},quadruple:({items:t})=>(e,s,i)=>{const n=[],r=9*e+s;for(const[o,a]of t.entries()){const t=[..."123456789"].filter((t=>!a.values.includes(~~t))),l=new Set,c=new Set,u=new Set;for(const t of a.positions){const[e,s,i]=wn(t);l.add(e),c.add(s),u.add(i)}if(a.positions.includes(r))if(a.values.includes(i+1)){if(a.values.length<4)for(const e of t)n.push(`quad${o},${i+1},${e}:multiple(${5-a.values.length})`)}else{if(4===a.values.length){n.push(!1);break}for(const t of a.values)n.push(`quad${o},${t},${i+1}:multiple(${5-a.values.length})`);n.push(`quad${o},${t.join("")}:multiple(${4-a.values.length})`)}else if(a.values.includes(i+1)){const t=3*~~(e/3)+~~(s/3);l.has(e)&&n.push(`quad${o},row,${i+1}:multiple(${l.size-1})`),c.has(s)&&n.push(`quad${o},col,${i+1}:multiple(${c.size-1})`),u.has(t)&&n.push(`quad${o},box,${i+1}:multiple(${u.size-1})`)}}return n.map((t=>!1!==t&&`optional:${t}`))},littlekiller:({items:t},e)=>(t,e,s)=>[],littlekillerChecker:vn,magicsquare:({items:t})=>{const e=["_32","23_","2_8","8_2","_12","21_","47_","_74","_78","87_","69_","_69","4_6","6_4","_36","63_","89_","_98","_14","41_"];return(s,i,n)=>[...t.flatMap(((t,e)=>{const r=9*s+i;return t.positions.includes(r)?[`magic${e},${n+1}`]:[]})),...t.flatMap(((t,r)=>{const o=[],a=9*s+i,l=[[0,1,2],[6,7,8],[0,3,6],[2,5,8]];if(t.positions.includes(a)){const s=t.positions.slice().sort(((t,e)=>t-e)).indexOf(a);if(4===s&&4===n)return[];if(4===s||4!==s&&4===n)return!1;const i=8-s;if([0,2,6,8].includes(s)&&!(n%2)||[1,3,5,7].includes(s)&&n%2)return!1;for(let t=0;t<9;++t)4!==t&&n!==t&&n+t!==8&&(s<i?o.push(`magic${r},${s},${n+1},${i},${t+1}`):o.push(`magic${r},${i},${t+1},${s},${n+1}`));for(let t of l.filter((t=>t.includes(s)))){const i=t.indexOf(s);for(const s of e)n+1===~~s[i]&&o.push(`magic${r},${t.join("")},${s}`)}}return o})).map((t=>!1!==t&&`optional:${t}`))]},renban:({items:t})=>(e,s,i)=>{const n=[];for(const[r,o]of t.entries()){const t=9*e+s;if(o.positions.includes(t)){n.push(`optional:renban${r},${i+1}`);const e=o.positions.indexOf(t),s=o.positions.length,a=Math.min(8,i+s-1),l=Math.max(0,i-s+1);for(let t=0;t<s;++t)if(t!==e){for(let s=0;s<l;++s)e<t?n.push(`optional:renban${r},${e},${i+1},${t},${s+1}`):n.push(`optional:renban${r},${t},${s+1},${e},${i+1}`);for(let s=a+1;s<9;++s)e<t?n.push(`optional:renban${r},${e},${i+1},${t},${s+1}`):n.push(`optional:renban${r},${t},${s+1},${e},${i+1}`)}}}return n},whispers:({items:t})=>(e,s,i)=>{const n=[];for(const[r,o]of t.entries()){const t=9*e+s;if(o.positions.includes(t)){4===i&&n.push(!1);const e=o.positions.indexOf(t),s=o.positions.length,a=Math.min(8,i+4),l=Math.max(0,i-4);for(let t=0;t<s;++t)if(1===Math.abs(t-e))for(let s=0;s<9;++s)4!==s&&s<=a&&s>=l&&(e<t?n.push(`optional:whispers${r},${e},${i+1},${t},${s+1}`):n.push(`optional:whispers${r},${t},${s+1},${e},${i+1}`))}}return n}});const $n=0,xn=1,kn=2,En=3,On=4,An=5,Tn=6,Sn={STATUS:"status",COUNT:"count",DEADENDS:"deadends",DEPTH:"depth",MAXDEPTH:"maxDepth",REQUIREMENTS:"requirements",RESTRICTIONS:"restrictions",OPTIONS:"options"},zn=Object.values(Sn),Cn=Object.fromEntries(Object.values(Sn).map((t=>[t,zn.indexOf(t)]))),In=[..."ABCDEFGHJ"].reduce(((t,e,s)=>(t[e]=9*s,t)),{}),Rn=(t,e,s,i,n,r,o,a,l=(t=>!1))=>{zn.forEach(((t,e)=>Atomics.store(r,e,"status"===t?2:0))),n.fill(0),i.fill(0);try{const c=Object.entries(s).filter((([t])=>ji.has(t)&&t in yn)).map((([t,i])=>yn[t](i,e,s))),u=(t,e,s)=>`${"ABCDEFGHJ"[t]}${e+1}=${s+1}`;c.unshift(((t,e,s)=>[`pos${9*t+e}`]));let h=Object.fromEntries(Ye(9,(t=>Ye(9,(e=>Ye(9,(s=>[u(t,e,s),c.flatMap((i=>i(t,e,s)))])))).flat())).flat().filter((([,t])=>!t.includes(!1))));const d="littlekiller"in s?vn(s.littlekiller,e):void 0,f=t.reduce(((t,e,s)=>{if(0!==e){const i=~~(s/9),n=s%9;t.push(u(i,n,e-1))}return t}),[]),p=[...new Set(Object.values(h).flat())],m=p.length,g=p.filter((t=>t.match(/^optional:|:multiple\(\d+\)$/))).length,_=m-g,w=Object.values(h).length;let b={count:0,status:2},v=0;const y=function*(t,e,s={add:t=>!0,remove:t=>!0},i){let n=0;const r=Object.fromEntries(ts("ABCDEFGHJ",Ye(9,(t=>t+1))).map((t=>[t.join(""),0]))),o=[...new Set(Object.values(t).flat())],a=new ln("primaryColumns"),l=new ln("secondaryColumns"),[c,u]=o.reduce((([t,e],s)=>(s.startsWith("optional:")||s.match(/:multiple\(\d+\)$/)?e.push(s.replace(/^optional:/,"")):t.push(s),[t,e])),[[],[]]);if(i){const t=ss(i??Date.now());c.sort((e=>~~(10*t()-5)))}a.left=c.reduce(((t,e)=>t.right=new cn(e,t)),a),a.left.right=a,l.left=u.reduce(((t,e)=>t.right=new cn(e,t)),l),l.left.right=l;const h=new Map;a.eachPeerRight((t=>{h.set(t.value,t),t.header=a})),l.eachPeerRight((t=>{h.set(t.value,t),t.header=l})),a.columnCount=c.length,l.columnCount=u.length,a.rowCount=0,l.rowCount=0;const d=new Map;for(const[e,s]of Object.entries(t)){const t=new ln;t.left=s.reduce(((t,e)=>t.right=new ln(e.replace(/^optional:|:multiple\(\d+\)$/g,""),t)),t),t.left.right=t,t.eachPeerRight((t=>{const s=h.get(t.value);t.insertBelow(s.up),t.column=s,++s.rowCount,t.item=t.value,t.value=e;const i=[...e];t.step=[i[0],i[1],i[3]]}));const i=Qe(t.mapPeersRight((t=>1/t.column.matchCount**2)));t.eachPeerRight((t=>{t.weight=i,t.column.rowWeight+=t.weight})),d.set(e,t.right),t.removeHorizontally(),a.rowCount++,l.rowCount++}const f=(t,e)=>{let s=!1;return t.eachPeerDown((t=>s=s||t===e)),s},p=[];for(const t of e){const e=d.get(t);if(!(e&&f(e.column,e)&&s.add([e.value[0],e.value[1],e.value[3]])))return;un(e),e.eachPeerRight(un),p.push(e.step),d.delete(t)}let m=0;yield*function*t(i){m=Math.max(i,m);const o=(t=>{let e,s=0,i=1/0;for(let n=t.right;n!==t;n=n.right){if(0===n.rowCount)return n;if(n.rowCount<i||n.rowCount===i&&n.rowWeight>s){if(0===n.rowCount)return n;e=n,i=n.rowCount,s=n.rowWeight}}return e})(a);if(o){if(0!==o.rowCount){un(o);for(let e=o.down;e!==o;e=e.down){if(p.push(e.step),r[e.step[0]+e.step[1]]++,s.add(e.step)){for(let t=e.right;t!==e;t=t.right)un(t);yield*t(i+1);for(let t=e.left;t!==e;t=t.left)hn(t)}s.remove(p.pop())}if(hn(o),i===e.length){const t=c.length-a.columnCount,e=a.rowCount,s=u.length-l.columnCount,o={depth:i,maxDepth:m,deadends:n,requirements:t,restrictions:s,options:e};yield[void 0,r,o]}}else if(++n%2317==0){const t=c.length-a.columnCount,e=a.rowCount,s=u.length-l.columnCount,o={depth:i,maxDepth:m,deadends:n,requirements:t,restrictions:s,options:e};yield[void 0,r,o]}}else{const t=p.slice(),e=c.length-a.columnCount,s=a.rowCount,o=u.length-l.columnCount,h={depth:i,maxDepth:m,deadends:n,requirements:e,restrictions:o,options:s};yield[t,r,h]}}(e.length)}(h,f,d,a),$=Date.now(),x=Ye(81,(t=>0)),k=t=>{const e=Date.now();for(;Date.now()-e<500;){const t=y.next();if(t.done)return Atomics.store(r,Cn[Sn.STATUS],6),Atomics.store(r,Cn[Sn.DEADENDS],b.deadends),b.status=6,l(b),void clearInterval(k);{const[e,s,a]=t.value;b={...b,...a};const c=Date.now(),u=c-$,h=c-v;if(e&&(++b.count,e.forEach((t=>{x[In[t[0]]+(t[1]-1)]=~~t[2]})),i.set(x,(b.count-1)%25e3*81),Atomics.store(r,Cn[Sn.COUNT],b.count)),b.count>=o.solutionLimit||h>100){if(n.set(Object.values(s),0),zn.forEach(((t,e)=>{Atomics.store(r,e,b[t])})),v=c,b.status=b.count>=o.solutionLimit?5:u>o.timeLimitMs?3:2,2!==b.status)return Atomics.store(r,Cn[Sn.STATUS],b.count>=o.solutionLimit?5:3),l(b),clearTimeout(Rn.timeout),void delete Rn.timeout;l(b)}}}Rn.timeout=setTimeout(k)};return Rn.timeout=setTimeout(k),{startTime:$,optionCount:w,requirementCount:_,restrictionCount:g}}catch(t){return setTimeout(l,100,{status:6,count:0}),console.error(t),{}}};var jn=Object.defineProperty,Nn=(t,e,s)=>(((t,e,s)=>{e in t?jn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s})(t,"symbol"!=typeof e?e+"":e,s),s);const Dn="LOGICAL_WORKER",Un="BRUTE_FORCE_WORKER",Ln="INITIALIZE_BUFFERS",Pn="INITIALIZE_PUZZLE",Mn="SEARCH_INITIATION",Fn="FINDINGS",Zn="SOLVE",Bn="CANCEL_SOLVE",Hn="SOLVE_BRUTE_FORCE",Wn="CANCEL_BRUTE_FORCE",qn="SOLUTION_COUNT";let Gn=!1;const Kn="SharedArrayBuffer"in self;class Vn{constructor(){Nn(this,"puzzle",{}),Nn(this,"lastBruteForceCount"),Nn(this,"lastBruteForceIteration"),addEventListener("message",(t=>{switch(t.data.type){case"INITIALIZE_BUFFERS":"BRUTE_FORCE_WORKER"===t.data.workerType&&this.initializeBuffers(t.data);break;case"INITIALIZE_PUZZLE":this.initializePuzzle(t.data);break;case"SOLVE":"LOGICAL_WORKER"===t.data.workerType&&(Gn=!1,this.logicalSolve(t.data.values,t.data.candidates,this.peers,this.units,this.puzzle,t.data.gridIteration));break;case"CANCEL_SOLVE":"LOGICAL_WORKER"===t.data.workerType&&(Gn=!0,postMessage({type:"SOLUTION_CANCELLED"}));break;case"SOLVE_BRUTE_FORCE":"BRUTE_FORCE_WORKER"===t.data.workerType&&this.solveBruteForce(t.data);break;case"CANCEL_BRUTE_FORCE":"BRUTE_FORCE_WORKER"===t.data.workerType&&this.cancelBruteForce(t.data)}}))}initializeBuffers({buffer:t,bufferParams:{solutions:e,header:s}}){this.bufferParams={solutions:e,header:s},this.buffer=Kn?t:new ArrayBuffer(4*s+324+81*e),this.header=new Uint32Array(this.buffer,0,s),this.heatmap=new Uint32Array(this.buffer,4*s,81),this.solutions=new Uint8Array(this.buffer,4*s+324,81*e)}initializePuzzle({puzzle:t,units:e,peers:s}){this.puzzle=t,this.units=e,this.peers=s}logicalSolve(t,e,s,i,n,r){return nn(t,e,s,i,n,0,300,r,(t=>(postMessage(t),!Gn)))}solveBruteForce({values:t,peers:e,puzzle:s,gridIteration:i,settings:n}){this.cancelBruteForce(),this.lastBruteForceCount=0,this.lastBruteForceIteration=i,this.lastReport=Date.now(),this.reportInterval=100;const r=n.randomize?Date.now():0;let o=!1;const a=Rn(t,e,s.constraints,this.solutions,this.heatmap,this.header,n,r,(t=>{const e=Date.now();o=2!==t.status,(e-this.lastReport>this.reportInterval||o)&&this.postSolutionCount(t,o,i),this.lastBruteForceCount=t.count,this.lastBruteForceIteration=i}));o||postMessage({type:"SEARCH_INITIATION",data:{...a,gridIteration:i}})}postSolutionCount(t,e,s){let i=this.buffer;if(!Kn){const e=t.count-this.lastBruteForceCount;i=new ArrayBuffer(4*this.bufferParams.header+324+81*e);const s=new Int32Array(i,0,this.bufferParams.header),n=new Uint32Array(i,4*this.bufferParams.header,81),r=new Uint8Array(i,4*this.bufferParams.header+324,81*e);if(s.set(this.header),n.set(this.heatmap),this.lastBruteForceCount!==t.count){const t=this.lastBruteForceCount%this.bufferParams.solutions,s=(t+e)%this.bufferParams.solutions;r.set(this.solutions.slice(81*t,s<t?this.solutions.length-1:81*s),0),s<t&&r.set(this.solutions.slice(0,81*s),81*(this.bufferParams.solutions-t))}}Kn?postMessage({type:"SOLUTION_COUNT",gridIteration:s,data:{stats:t}}):postMessage({type:"SOLUTION_COUNT",gridIteration:s,data:{stats:t},buffer:i},[i])}cancelBruteForce(){Rn.timeout&&(clearTimeout(Rn.timeout),Atomics.store(this.header,Cn[Sn.STATUS],4),this.postSolutionCount({count:this.header[Cn[Sn.COUNT]],status:4},!0,this.lastBruteForceIteration))}}new Vn;export{Gs as $,ni as A,ri as B,ai as C,ci as D,Sn as E,$n as F,hi as G,kn as H,di as I,En as J,_i as K,yi as L,$i as M,On as N,ki as O,Ei as P,Oi as Q,Si as R,As as S,Ci as T,An as U,Tn as V,Ii as W,Ri as X,Yi as Y,Qi as Z,en as _,Ye as a,an as a0,Ds as a1,s as a2,t as a3,i as a4,e as a5,hs as a6,Ss as a7,xn as a8,Ks as a9,zn as aA,qn as aB,Cn as aC,Mn as aD,tn as aE,Pn as aF,Zn as aG,Bn as aH,Hn as aI,Wn as aJ,ei as aK,qs as aL,Zs as aM,Fn as aN,Vn as aO,Ms as aa,Ps as ab,js as ac,Ns as ad,Ws as ae,Js as af,Hs as ag,vs as ah,si as ai,Ni as aj,ji as ak,Fs as al,Qe as am,bs as an,Zi as ao,Fi as ap,qi as aq,Xi as ar,Ji as as,Bi as at,sn as au,Bs as av,Ys as aw,Dn as ax,Un as ay,Ln as az,oi as b,us as c,fs as d,Vs as e,Ts as f,Os as g,ss as h,vi as i,ns as j,Es as k,zi as l,gs as m,Ai as n,xi as o,ps as p,xs as q,ys as r,ls as s,Ti as t,_s as u,Ui as v,Di as w,Pi as x,Mi as y,Li as z};

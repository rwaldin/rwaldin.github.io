(function(){function e(e,t,n,r){return(Math.sqrt(Math.cos(e*r))*Math.cos(t*(e*r+n))+Math.sqrt(Math.abs(e*r))-.4)*Math.pow(4-e*e,.1)/r}function t(t,n,r){var i=[];for(var s=-2;s<2;s+=.2/t){var o=e(s,t,n,r);isNaN(o)||i.push([s,o])}return i}function n(e,t,n){v.innerHTML="",r(e,t,n)}function r(e,t,n){var r=v.innerHTML.replace(/<span.*/,""),i='<span class="blink">&#x258C</span>',s=0;(function(){r+=e.charAt(s++),v.innerHTML=r+i,e.length>=s?setTimeout(arguments.callee,Math.random()*130):n&&setTimeout(n,t)})()}function i(e,t){setTimeout(function(){n("They say the shortest path between two points is a straight line.",2e3,function(){n("But sometimes,",500,function(){r(" the shortest way",500,function(){r(" is not the best way.",2e3,function(){n("Sometimes",1500,function(){r(" it's better to take your time,",2500,function(){r(" wander a bit,",2500,function(){n("and enjoy your journey",2500,function(){r(" together",1e3,function(){r(".",1e3,function(){r(".",1e3,function(){r(".",9500,function(){n("Happy Valentines Day")})})})})})})})})})})})})},1200);var i=f.selectAll("circle").data([0,1]);i.enter().append("circle").style("fill",function(e){return["lightpink","lightblue"][e]}).style("stroke",function(e){return["red","blue"][e]}).style("stroke-width",.001).attr("r",0).attr("cx",function(e){return[-1.605,1.605][e]}).attr("cy",.86),i.transition().delay(1200).duration(250).attr("r",.07).transition().duration(250).attr("r",.02);var o=h[0],u=h[h.length-1],a=h[0][1],l=(o[0]+u[0])/2,c=[l,a],d=[l,a],v=1e3,m=+(new Date)+3500;setTimeout(function(){p.attr("points",[c,d]);if(c[0]>o[0]||d[0]<u[0]){var n=(l-o[0])*((+(new Date)-m)/v);c[0]=l-n,d[0]=l+n,setTimeout(arguments.callee,30)}else p.attr("points",[o,u]),setTimeout(t,e)},3500),i.transition().delay(32e3).transition().duration(5500).attr("r",0),p.style("opacity",1).transition().delay(8e3).duration(1500).style("opacity",0),setTimeout(function(){p.attr("points",[]).style("opacity",1),anim=setInterval(s,25)},9600)}function s(){if(h.length<=d){clearInterval(anim),p.attr("points",h.map(function(e){return e.join(",")}).join(" "));var e=p.transition(),t=250;for(d=0;d<4;++d)e=e.duration(t).style("stroke-width",.02).transition(),t=500,e=e.duration(500).style("stroke-width",.01).transition();setTimeout(function(){anim=setInterval(o,25,.005)},d*1e3-300)}else p.attr("points",h.slice(0,d).map(function(e){return e.join(",")}).join(" ")),d+=4}function o(e){c+=e,h=t(l,c,1),p.attr("points",h.map(function(e){return e.join(",")}).join(" "));if(c>=1||c<.04)clearInterval(anim),setTimeout(function(){c>.5?anim=setInterval(o,25,-e):(p.transition().duration(2500).style("stroke-width",.01),anim=setInterval(u,50))},250)}function u(){c=0,l*=1.01,h=t(l,c,1),p.attr("points",h.map(function(e){return e.join(",")}).join(" ")),l>500&&(clearInterval(anim),anim=setInterval(a,25))}function a(){if(g>1.04||g<.95)y=1/y;g*=y,h=t(l,c,g),p.attr("points",h.map(function(e){return e.join(",")}).join(" "))}(function(){var e=!0;setInterval(function(){var t=document.querySelectorAll(".blink");Array.prototype.forEach.call(t,function(t){t.style.visibility=e?"visible":"hidden",e=!e})},450)})();var f=d3.select("svg").append("g").attr("transform","scale(200,-200) translate(1.8,-1.7)"),l=80,c=.03875,h=t(l,c,1),p=f.append("polyline").style("stroke","red").style("fill","transparent").style("stroke-width",.01),d=0,v=document.querySelector("div"),m=h.slice(0),g=1,y=1.05;i()})();

(()=>{var h=class{constructor(e,t){this.value=e,this.left=t??this,this.right=this.up=this.down=this}insertBelow(e){this.up=e,this.down=e.down,e.down.up=e.down=this}removeVertically(){this.up.down=this.down,this.down.up=this.up,this.column.rowCount--}reinsertVertically(){this.up.down=this.down.up=this,this.column.rowCount++}removeHorizontally(){this.left.right=this.right,this.right.left=this.left}reinsertHorizontally(){this.left.right=this.right.left=this}eachPeerDown(e){for(let t=this.down;t!==this;t=t.down)e(t)}eachPeerRight(e){for(let t=this.right;t!==this;t=t.right)e(t)}},p=class extends h{constructor(e,t){super(e,t),this.rowCount=0,this.column=this}removeHorizontally(){super.removeHorizontally(),this.header.columnCount--}reinsertHorizontally(){super.reinsertHorizontally(),this.header.columnCount++}},a=i=>{let e=i.column??i;e.removeHorizontally();for(let t=e.down;t!==e;t=t.down){e.header.rowCount--;for(let r=t.right;r!==t;r=r.right)r.removeVertically()}},g=i=>{let e=i.column??i;for(let t=e.up;t!==e;t=t.up){for(let r=t.left;r!==t;r=r.left)r.reinsertVertically();e.header.rowCount++}e.reinsertHorizontally()},C=i=>{let e;for(let t=i.right;t!==i;t=t.right){if(t.rowCount===0)return t;(!e||t.rowCount<e.rowCount)&&(e=t)}return e};function*y(i,e=[]){let t=[...new Set(Object.values(i).flat())],r=new h("columns");r.left=t.reduce((s,n)=>s.right=new p(n,s),r),r.left.right=r;let d=new Map;r.eachPeerRight(s=>{d.set(s.value,s),s.header=r}),r.columnCount=t.length,r.rowCount=0;let w=new Map;for(let[s,n]of Object.entries(i)){let o=new h;o.left=n.reduce((l,u)=>l.right=new h(u,l),o),o.left.right=o,o.eachPeerRight(l=>{let u=d.get(l.value);l.insertBelow(u.up),l.column=u,++u.rowCount,l.option=s}),w.set(s,o.right),o.removeHorizontally(),++r.rowCount}let v=(s,n)=>{for(let o=s.down;o!==s;o=o.down)if(o===n)return o},c=[];for(let s of e){let n=w.get(s);if(n&&v(n.column,n))a(n),n.eachPeerRight(a),c.push(n.option),w.delete(s);else return}let f;function*m(s){let n=C(r);if(n){if(n.rowCount===0)return}else{yield[...c],f=Date.now();return}Date.now()-f>500&&(yield,f=Date.now()),a(n);for(let o=n.down;o!==n;o=o.down){c.push(o.option);for(let l=o.right;l!==o;l=l.right)a(l);yield*m(s+1);for(let l=o.left;l!==o;l=l.left)g(l);c.pop()}g(n)}yield*m(e.length)}addEventListener("message",i=>{switch(i.data.type){case"solve":{for(let e of y(i.data.options,i.data.givenOptions))e&&postMessage({type:"solution",solution:e});postMessage({type:"completed"})}}});})();
//# sourceMappingURL=worker-3go7lkoy.js.map
